# é˜Ÿåˆ—

**é˜Ÿåˆ—æ˜¯éµå¾ª FIFOï¼ˆFirst In First Outï¼Œå…ˆè¿›å…ˆå‡ºï¼‰åŸåˆ™çš„ä¸€ç»„æœ‰åºé›†åˆ**ã€‚ é˜Ÿåˆ—åœ¨å°¾éƒ¨æ·»åŠ æ–°å…ƒç´ ï¼Œå¹¶ä»é¡¶éƒ¨ç§»é™¤å…ƒç´ ã€‚æœ€æ–°æ·»åŠ çš„å…ƒç´ å¿…é¡»æ’åœ¨é˜Ÿåˆ—çš„æœ«å°¾ã€‚

é˜Ÿåˆ—è·Ÿæ ˆä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸€ç§æ“ä½œå—é™çš„çº¿æ€§è¡¨æ•°æ®ç»“æ„ã€‚é˜Ÿåˆ—æ”¯æŒçš„æ“ä½œä¹Ÿå¾ˆæœ‰é™ï¼Œæœ€åŸºæœ¬çš„æ“ä½œä¹Ÿæ˜¯ä¸¤ä¸ªï¼š**å…¥é˜Ÿ enqueue()**ï¼Œæ”¾ä¸€ä¸ªæ•°æ®åˆ°é˜Ÿåˆ—å°¾éƒ¨ï¼›**å‡ºé˜Ÿ dequeue()**ï¼Œä»é˜Ÿåˆ—å¤´éƒ¨å–ä¸€ä¸ªå…ƒç´ ã€‚

![2020-1-13-20-50-46.png](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-1-13-20-50-46.png)

## é¡ºåºé˜Ÿåˆ— & é“¾å¼é˜Ÿåˆ—

è·Ÿæ ˆä¸€æ ·ï¼Œé˜Ÿåˆ—å¯ä»¥ç”¨æ•°ç»„æ¥å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨é“¾è¡¨æ¥å®ç°ã€‚åŒæ ·ï¼Œç”¨æ•°ç»„å®ç°çš„é˜Ÿåˆ—å«ä½œ**é¡ºåºé˜Ÿåˆ—**ï¼Œç”¨é“¾è¡¨å®ç°çš„é˜Ÿåˆ—å«ä½œ**é“¾å¼é˜Ÿåˆ—**ã€‚

### é¡ºåºé˜Ÿåˆ—å®ç°

ä¸‹é¢æ˜¯åŸºäº**æ•°ç»„**çš„å®ç°æ–¹æ³•ï¼š

```java
// ç”¨æ•°ç»„å®ç°çš„é˜Ÿåˆ—
public class ArrayQueue {
  // æ•°ç»„ï¼šitems
  private String[] items;
  // æ•°ç»„å¤§å°ï¼šn
  private int n = 0;
  // headè¡¨ç¤ºé˜Ÿå¤´ä¸‹æ ‡ï¼Œtailè¡¨ç¤ºé˜Ÿå°¾ä¸‹æ ‡
  private int head = 0;
  private int tail = 0;

  // ç”³è¯·ä¸€ä¸ªå¤§å°ä¸º capacity çš„æ•°ç»„
  public ArrayQueue(int capacity) {
    this.items = new String[capacity];
    this.n = capacity;
  }

  // å…¥é˜Ÿ
  public boolean enqueue(String item) {
    // å¦‚æœtail == n è¡¨ç¤ºé˜Ÿåˆ—å·²ç»æ»¡äº†
    if (this.tail == n) return false;
    this.items[this.tail] = item;
    ++this.tail;
    return true;
  }

  // å‡ºé˜Ÿ
  public String dequeue() {
    // å¦‚æœhead == tail è¡¨ç¤ºé˜Ÿåˆ—ä¸ºç©º
    if (this.head == this.tail) return null;
    String ret = this.items[this.head];
    ++this.head;
    return ret;
  }
}
```

ğŸ‘† ä¸Šé¢ä»£ç ä¸­ï¼Œéšç€ä¸åœåœ°è¿›è¡Œå…¥é˜Ÿã€å‡ºé˜Ÿæ“ä½œï¼Œ`head` å’Œ `tail` éƒ½ä¼šæŒç»­å¾€åç§»åŠ¨ã€‚å½“ `tail` ç§»åŠ¨åˆ°æœ€å³è¾¹ï¼Œå³ä½¿æ•°ç»„ä¸­è¿˜æœ‰ç©ºé—²ç©ºé—´ï¼Œä¹Ÿæ— æ³•ç»§ç»­å¾€é˜Ÿåˆ—ä¸­æ·»åŠ æ•°æ®äº†ã€‚

![2020-1-13-20-57-43.png](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-1-13-20-57-43.png)
![2020-1-13-20-57-51.png](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-1-13-20-57-51.png)

æ”¹è¿›æ–¹æ³•æ˜¯ï¼šå¦‚æœæ²¡æœ‰ç©ºé—²ç©ºé—´äº†ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å…¥é˜Ÿæ—¶ï¼Œå†é›†ä¸­è§¦å‘ä¸€æ¬¡**æ•°æ®æ¬ç§»**æ“ä½œã€‚

```java
// å…¥é˜Ÿæ“ä½œï¼Œå°†itemæ”¾å…¥é˜Ÿå°¾
public boolean enqueue(String item) {
  // tail == nè¡¨ç¤ºé˜Ÿåˆ—æœ«å°¾æ²¡æœ‰ç©ºé—´äº†
  if (this.tail == n) {
    // this.tail ==n && head==0ï¼Œè¡¨ç¤ºæ•´ä¸ªé˜Ÿåˆ—éƒ½å æ»¡äº†
    if (this.head == 0) return false;
    // æ•°æ®æ¬ç§»
    for (int i = this.head; i < this.tail; ++i) {
      this.items[i-this.head] = this.items[i];
    }
    // æ¬ç§»å®Œä¹‹åé‡æ–°æ›´æ–° head å’Œ tail
    this.tail -= this.head;
    this.head = 0;
  }

  this.items[this.tail] = item;
  this.tail++;
  return true;
}
```

![2020-1-13-21-1-26.png](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-1-13-21-1-26.png)

### é“¾è¡¨é˜Ÿåˆ—å®ç°

åŸºäºé“¾è¡¨çš„å®ç°ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦ä¸¤ä¸ªæŒ‡é’ˆï¼š`head` æŒ‡é’ˆå’Œ `tail` æŒ‡é’ˆã€‚å®ƒä»¬åˆ†åˆ«æŒ‡å‘é“¾è¡¨çš„ç¬¬ä¸€ä¸ªç»“ç‚¹å’Œæœ€åä¸€ä¸ªç»“ç‚¹ã€‚

- å…¥é˜Ÿæ—¶ï¼Œ`tail->next = new_node`, `tail = tail->next`ï¼›
- å‡ºé˜Ÿæ—¶ï¼Œ`head = head->next`ï¼›

![2020-1-13-21-4-50.png](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-1-13-21-4-50.png)

## å¾ªç¯é˜Ÿåˆ—

å¾ªç¯é˜Ÿåˆ—ï¼Œé•¿å¾—åƒä¸€ä¸ªç¯ã€‚åŸæœ¬é˜Ÿåˆ—æ˜¯æœ‰å¤´æœ‰å°¾çš„ï¼Œæ˜¯ä¸€æ¡ç›´çº¿ã€‚ç°åœ¨æˆ‘ä»¬æŠŠé¦–å°¾ç›¸è¿ï¼Œæ‰³æˆäº†ä¸€ä¸ªç¯ã€‚

![2020-1-13-21-8-9.png](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-1-13-21-8-9.png)

å›¾ä¸­è¿™ä¸ªé˜Ÿåˆ—çš„å¤§å°ä¸º 8ï¼Œå½“å‰ head=4ï¼Œtail=7ã€‚å½“æœ‰ä¸€ä¸ªæ–°çš„å…ƒç´  a å…¥é˜Ÿæ—¶ï¼Œæˆ‘ä»¬æ”¾å…¥ä¸‹æ ‡ä¸º 7 çš„ä½ç½®ã€‚ä½†è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸æŠŠ tail æ›´æ–°ä¸º 8ï¼Œè€Œæ˜¯å°†å…¶åœ¨ç¯ä¸­åç§»ä¸€ä½ï¼Œåˆ°ä¸‹æ ‡ä¸º 0 çš„ä½ç½®ã€‚å½“å†æœ‰ä¸€ä¸ªå…ƒç´  b å…¥é˜Ÿæ—¶ï¼Œæˆ‘ä»¬å°† b æ”¾å…¥ä¸‹æ ‡ä¸º 0 çš„ä½ç½®ï¼Œç„¶å tail åŠ  1 æ›´æ–°ä¸º 1ã€‚æ‰€ä»¥ï¼Œåœ¨ aï¼Œb ä¾æ¬¡å…¥é˜Ÿä¹‹åï¼Œå¾ªç¯é˜Ÿåˆ—ä¸­çš„å…ƒç´ å°±å˜æˆäº†ä¸‹é¢çš„æ ·å­ï¼š

![2020-1-13-21-8-44.png](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-1-13-21-8-44.png)

åœ¨ä¹‹å‰â€œé¡ºåºé˜Ÿåˆ—â€ çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬ç”¨æ•°ç»„å®ç°äº†ä¸€ä¸ªé˜Ÿåˆ—ã€‚ä½†æ˜¯å…¥é˜Ÿæ“ä½œæ—¶ï¼Œå¯èƒ½ä¼šæ¶‰åŠä¸€ä¸ª**æ•°æ®æ¬ç§»**æ“ä½œã€‚é€šè¿‡ä½¿ç”¨ â€œå¾ªç¯é˜Ÿåˆ—â€ å°±é¿å…äº†è¿™ä¸ªé—®é¢˜ã€‚

ğŸ‘‡ ä¸‹é¢æ˜¯ä»£ç å®ç°ï¼š

```java

public class CircularQueue {
  // æ•°ç»„ï¼šitemsï¼Œæ•°ç»„å¤§å°ï¼šn
  private String[] items;
  private int n = 0;
  // headè¡¨ç¤ºé˜Ÿå¤´ä¸‹æ ‡ï¼Œtailè¡¨ç¤ºé˜Ÿå°¾ä¸‹æ ‡
  private int head = 0;
  private int tail = 0;

  // ç”³è¯·ä¸€ä¸ªå¤§å°ä¸ºcapacityçš„æ•°ç»„
  public CircularQueue(int capacity) {
    this.items = new String[capacity];
    this.n = capacity;
  }

  // å…¥é˜Ÿ
  public boolean enqueue(String item) {
    // å½“é˜Ÿæ»¡æ—¶ï¼Œ(tail + 1) % n = head
    if ((this.tail + 1) % this.n == this.head) return false;
    this.items[this.tail] = item;
    this.tail = (this.tail + 1) % n;
    return true;
  }

  // å‡ºé˜Ÿ
  public String dequeue() {
    // å¦‚æœthis.head == this.tail è¡¨ç¤ºé˜Ÿåˆ—ä¸ºç©º
    if (this.head == this.tail) return null;
    String ret = this.items[this.head];
    this.head = (this.head + 1) % n;
    return ret;
  }
}
```

## é˜»å¡é˜Ÿåˆ— & å¹¶å‘é˜Ÿåˆ—

ä¸‹é¢ä»‹ç»ä¸€äº›å…·æœ‰ç‰¹æ®Šç‰¹æ€§çš„é˜Ÿåˆ—ã€‚

ã€ **é˜»å¡é˜Ÿåˆ—** ã€å…¶å®å°±æ˜¯åœ¨é˜Ÿåˆ—åŸºç¡€ä¸Šå¢åŠ äº†é˜»å¡æ“ä½œã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åœ¨é˜Ÿåˆ—ä¸ºç©ºçš„æ—¶å€™ï¼Œä»é˜Ÿå¤´å–æ•°æ®ä¼šè¢«é˜»å¡ã€‚å› ä¸ºæ­¤æ—¶è¿˜æ²¡æœ‰æ•°æ®å¯å–ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰äº†æ•°æ®æ‰èƒ½è¿”å›ï¼›å¦‚æœé˜Ÿåˆ—å·²ç»æ»¡äº†ï¼Œé‚£ä¹ˆæ’å…¥æ•°æ®çš„æ“ä½œå°±ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰ç©ºé—²ä½ç½®åå†æ’å…¥æ•°æ®ï¼Œç„¶åå†è¿”å›ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨ â€œé˜»å¡é˜Ÿåˆ—â€ å»å®ç°ä¸€ä¸ª â€œç”Ÿäº§è€… - æ¶ˆè´¹è€…æ¨¡å‹â€ ã€‚è¿™ç§åŸºäºé˜»å¡é˜Ÿåˆ—å®ç°çš„ â€œç”Ÿäº§è€… - æ¶ˆè´¹è€…æ¨¡å‹â€ï¼Œå¯ä»¥æœ‰æ•ˆåœ°åè°ƒç”Ÿäº§å’Œæ¶ˆè´¹çš„é€Ÿåº¦ã€‚å½“â€œç”Ÿäº§è€…â€ç”Ÿäº§æ•°æ®çš„é€Ÿåº¦è¿‡å¿«ï¼Œâ€œæ¶ˆè´¹è€…â€æ¥ä¸åŠæ¶ˆè´¹æ—¶ï¼Œå­˜å‚¨æ•°æ®çš„é˜Ÿåˆ—å¾ˆå¿«å°±ä¼šæ»¡äº†ã€‚è¿™ä¸ªæ—¶å€™ï¼Œç”Ÿäº§è€…å°±é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°â€œæ¶ˆè´¹è€…â€æ¶ˆè´¹äº†æ•°æ®ï¼Œâ€œç”Ÿäº§è€…â€æ‰ä¼šè¢«å”¤é†’ç»§ç»­â€œç”Ÿäº§â€ã€‚

![2020-1-13-21-20-42.png](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-1-13-21-20-42.png)

åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œä¼šæœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œé˜Ÿåˆ—ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ã€ **å¹¶å‘é˜Ÿåˆ—** ã€å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚æœ€ç®€å•ç›´æ¥çš„å®ç°æ–¹å¼æ˜¯ç›´æ¥**åœ¨å…¥é˜Ÿã€å‡ºé˜Ÿæ–¹æ³•ä¸ŠåŠ é”ï¼ŒåŒä¸€æ—¶åˆ»ä»…å…è®¸ä¸€ä¸ªå­˜æˆ–è€…å–æ“ä½œ**ã€‚åŸºäºæ•°ç»„çš„å¾ªç¯é˜Ÿåˆ—ï¼Œåˆ©ç”¨ CAS åŸå­æ“ä½œï¼Œå¯ä»¥å®ç°éå¸¸é«˜æ•ˆçš„å¹¶å‘é˜Ÿåˆ—ã€‚è¿™ä¹Ÿæ˜¯å¾ªç¯é˜Ÿåˆ—æ¯”é“¾å¼é˜Ÿåˆ—åº”ç”¨æ›´åŠ å¹¿æ³›çš„åŸå› ã€‚
