<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java 基础知识 | Garrik 的笔记</title>
    <meta name="description" content="这里是 Garrik 的前端笔记本">
    
    
    <link rel="preload" href="/my-notebook/assets/css/0.styles.09dde1b2.css" as="style"><link rel="preload" href="/my-notebook/assets/js/app.7c72f570.js" as="script"><link rel="preload" href="/my-notebook/assets/js/2.a47e0c14.js" as="script"><link rel="preload" href="/my-notebook/assets/js/166.046085b9.js" as="script"><link rel="prefetch" href="/my-notebook/assets/js/10.a57ab502.js"><link rel="prefetch" href="/my-notebook/assets/js/100.0ad9d930.js"><link rel="prefetch" href="/my-notebook/assets/js/101.56b88c13.js"><link rel="prefetch" href="/my-notebook/assets/js/102.6806b549.js"><link rel="prefetch" href="/my-notebook/assets/js/103.d7247663.js"><link rel="prefetch" href="/my-notebook/assets/js/104.b30f8269.js"><link rel="prefetch" href="/my-notebook/assets/js/105.459ea1c3.js"><link rel="prefetch" href="/my-notebook/assets/js/106.9c175459.js"><link rel="prefetch" href="/my-notebook/assets/js/107.5089567e.js"><link rel="prefetch" href="/my-notebook/assets/js/108.b891d46c.js"><link rel="prefetch" href="/my-notebook/assets/js/109.47b3e455.js"><link rel="prefetch" href="/my-notebook/assets/js/11.00e5f220.js"><link rel="prefetch" href="/my-notebook/assets/js/110.000e95a8.js"><link rel="prefetch" href="/my-notebook/assets/js/111.3a1715aa.js"><link rel="prefetch" href="/my-notebook/assets/js/112.d800f061.js"><link rel="prefetch" href="/my-notebook/assets/js/113.6b569ad4.js"><link rel="prefetch" href="/my-notebook/assets/js/114.fc0031b9.js"><link rel="prefetch" href="/my-notebook/assets/js/115.23d420e7.js"><link rel="prefetch" href="/my-notebook/assets/js/116.0641f372.js"><link rel="prefetch" href="/my-notebook/assets/js/117.192f9dff.js"><link rel="prefetch" href="/my-notebook/assets/js/118.19ec7a12.js"><link rel="prefetch" href="/my-notebook/assets/js/119.da8a8272.js"><link rel="prefetch" href="/my-notebook/assets/js/12.42d43ec5.js"><link rel="prefetch" href="/my-notebook/assets/js/120.e5fd2108.js"><link rel="prefetch" href="/my-notebook/assets/js/121.18333724.js"><link rel="prefetch" href="/my-notebook/assets/js/122.7b579444.js"><link rel="prefetch" href="/my-notebook/assets/js/123.7b840df6.js"><link rel="prefetch" href="/my-notebook/assets/js/124.eb2e6a26.js"><link rel="prefetch" href="/my-notebook/assets/js/125.0b8537c5.js"><link rel="prefetch" href="/my-notebook/assets/js/126.77a014e3.js"><link rel="prefetch" href="/my-notebook/assets/js/127.29324719.js"><link rel="prefetch" href="/my-notebook/assets/js/128.6bf6dfdc.js"><link rel="prefetch" href="/my-notebook/assets/js/129.6f2a14fb.js"><link rel="prefetch" href="/my-notebook/assets/js/13.7cbb18ca.js"><link rel="prefetch" href="/my-notebook/assets/js/130.7b2bcf39.js"><link rel="prefetch" href="/my-notebook/assets/js/131.802201d3.js"><link rel="prefetch" href="/my-notebook/assets/js/132.85d58c17.js"><link rel="prefetch" href="/my-notebook/assets/js/133.77957d2e.js"><link rel="prefetch" href="/my-notebook/assets/js/134.fb09663e.js"><link rel="prefetch" href="/my-notebook/assets/js/135.79206c0f.js"><link rel="prefetch" href="/my-notebook/assets/js/136.d8cddc93.js"><link rel="prefetch" href="/my-notebook/assets/js/137.089fb120.js"><link rel="prefetch" href="/my-notebook/assets/js/138.793f9e16.js"><link rel="prefetch" href="/my-notebook/assets/js/139.8b9627b8.js"><link rel="prefetch" href="/my-notebook/assets/js/14.6c6eb7c1.js"><link rel="prefetch" href="/my-notebook/assets/js/140.40fd4015.js"><link rel="prefetch" href="/my-notebook/assets/js/141.20a6f0e7.js"><link rel="prefetch" href="/my-notebook/assets/js/142.86f6d054.js"><link rel="prefetch" href="/my-notebook/assets/js/143.286220f9.js"><link rel="prefetch" href="/my-notebook/assets/js/144.da1847a8.js"><link rel="prefetch" href="/my-notebook/assets/js/145.29c8ce2a.js"><link rel="prefetch" href="/my-notebook/assets/js/146.17c8ca93.js"><link rel="prefetch" href="/my-notebook/assets/js/147.9d45e8c4.js"><link rel="prefetch" href="/my-notebook/assets/js/148.df7b84f9.js"><link rel="prefetch" href="/my-notebook/assets/js/149.95c33813.js"><link rel="prefetch" href="/my-notebook/assets/js/15.01f6456c.js"><link rel="prefetch" href="/my-notebook/assets/js/150.ffa0a47e.js"><link rel="prefetch" href="/my-notebook/assets/js/151.3901686e.js"><link rel="prefetch" href="/my-notebook/assets/js/152.cbd51c65.js"><link rel="prefetch" href="/my-notebook/assets/js/153.de070f14.js"><link rel="prefetch" href="/my-notebook/assets/js/154.c59b339a.js"><link rel="prefetch" href="/my-notebook/assets/js/155.731a9e08.js"><link rel="prefetch" href="/my-notebook/assets/js/156.6933cd28.js"><link rel="prefetch" href="/my-notebook/assets/js/157.d29c1ec0.js"><link rel="prefetch" href="/my-notebook/assets/js/158.3dd3ece0.js"><link rel="prefetch" href="/my-notebook/assets/js/159.57f40e01.js"><link rel="prefetch" href="/my-notebook/assets/js/16.6508c8b1.js"><link rel="prefetch" href="/my-notebook/assets/js/160.8bf4d59c.js"><link rel="prefetch" href="/my-notebook/assets/js/161.9121808a.js"><link rel="prefetch" href="/my-notebook/assets/js/162.0dfec3bf.js"><link rel="prefetch" href="/my-notebook/assets/js/163.382e4624.js"><link rel="prefetch" href="/my-notebook/assets/js/164.4d59cbc5.js"><link rel="prefetch" href="/my-notebook/assets/js/165.8f0cf332.js"><link rel="prefetch" href="/my-notebook/assets/js/167.20187896.js"><link rel="prefetch" href="/my-notebook/assets/js/168.8e31a397.js"><link rel="prefetch" href="/my-notebook/assets/js/169.9cef4bae.js"><link rel="prefetch" href="/my-notebook/assets/js/17.49736a87.js"><link rel="prefetch" href="/my-notebook/assets/js/170.bd5c3dcd.js"><link rel="prefetch" href="/my-notebook/assets/js/171.733c699e.js"><link rel="prefetch" href="/my-notebook/assets/js/172.105aa2b6.js"><link rel="prefetch" href="/my-notebook/assets/js/173.2839a40f.js"><link rel="prefetch" href="/my-notebook/assets/js/174.44888c3d.js"><link rel="prefetch" href="/my-notebook/assets/js/175.800a02d6.js"><link rel="prefetch" href="/my-notebook/assets/js/176.22abcb52.js"><link rel="prefetch" href="/my-notebook/assets/js/177.f43d54c5.js"><link rel="prefetch" href="/my-notebook/assets/js/178.c24aa050.js"><link rel="prefetch" href="/my-notebook/assets/js/179.e373dbcd.js"><link rel="prefetch" href="/my-notebook/assets/js/18.0a10a7ac.js"><link rel="prefetch" href="/my-notebook/assets/js/180.18d230ec.js"><link rel="prefetch" href="/my-notebook/assets/js/181.7d19cd8e.js"><link rel="prefetch" href="/my-notebook/assets/js/182.544a9fc1.js"><link rel="prefetch" href="/my-notebook/assets/js/183.a8d1a7bd.js"><link rel="prefetch" href="/my-notebook/assets/js/184.42a8e200.js"><link rel="prefetch" href="/my-notebook/assets/js/185.f48e47ed.js"><link rel="prefetch" href="/my-notebook/assets/js/186.ef0bacc1.js"><link rel="prefetch" href="/my-notebook/assets/js/187.018d83cb.js"><link rel="prefetch" href="/my-notebook/assets/js/188.bcb891d9.js"><link rel="prefetch" href="/my-notebook/assets/js/189.d381baf9.js"><link rel="prefetch" href="/my-notebook/assets/js/19.c5f54941.js"><link rel="prefetch" href="/my-notebook/assets/js/190.65edf4d6.js"><link rel="prefetch" href="/my-notebook/assets/js/191.02eb3f38.js"><link rel="prefetch" href="/my-notebook/assets/js/192.51ecb322.js"><link rel="prefetch" href="/my-notebook/assets/js/193.c46036b3.js"><link rel="prefetch" href="/my-notebook/assets/js/194.5331ca7c.js"><link rel="prefetch" href="/my-notebook/assets/js/195.ee6a8d9d.js"><link rel="prefetch" href="/my-notebook/assets/js/196.400da36a.js"><link rel="prefetch" href="/my-notebook/assets/js/197.9593f3a7.js"><link rel="prefetch" href="/my-notebook/assets/js/198.b6b7d10a.js"><link rel="prefetch" href="/my-notebook/assets/js/199.e2773f87.js"><link rel="prefetch" href="/my-notebook/assets/js/20.69d32193.js"><link rel="prefetch" href="/my-notebook/assets/js/200.e3efc5f8.js"><link rel="prefetch" href="/my-notebook/assets/js/201.6071e7eb.js"><link rel="prefetch" href="/my-notebook/assets/js/202.5bb1a83c.js"><link rel="prefetch" href="/my-notebook/assets/js/203.bdb3e635.js"><link rel="prefetch" href="/my-notebook/assets/js/204.79ef4876.js"><link rel="prefetch" href="/my-notebook/assets/js/205.310c916c.js"><link rel="prefetch" href="/my-notebook/assets/js/206.695f5736.js"><link rel="prefetch" href="/my-notebook/assets/js/207.3f9d8ff4.js"><link rel="prefetch" href="/my-notebook/assets/js/208.16ff2835.js"><link rel="prefetch" href="/my-notebook/assets/js/209.dd732317.js"><link rel="prefetch" href="/my-notebook/assets/js/21.c9ebe41b.js"><link rel="prefetch" href="/my-notebook/assets/js/210.40e9cf1e.js"><link rel="prefetch" href="/my-notebook/assets/js/211.49bac76d.js"><link rel="prefetch" href="/my-notebook/assets/js/212.fd1246c2.js"><link rel="prefetch" href="/my-notebook/assets/js/213.6c49ac57.js"><link rel="prefetch" href="/my-notebook/assets/js/214.5de12bce.js"><link rel="prefetch" href="/my-notebook/assets/js/215.a588b61c.js"><link rel="prefetch" href="/my-notebook/assets/js/216.9c1e29f2.js"><link rel="prefetch" href="/my-notebook/assets/js/217.b7ec426c.js"><link rel="prefetch" href="/my-notebook/assets/js/218.7d5a17cd.js"><link rel="prefetch" href="/my-notebook/assets/js/219.c9caf193.js"><link rel="prefetch" href="/my-notebook/assets/js/22.28c3859f.js"><link rel="prefetch" href="/my-notebook/assets/js/220.77a10008.js"><link rel="prefetch" href="/my-notebook/assets/js/221.2d81ebb1.js"><link rel="prefetch" href="/my-notebook/assets/js/222.8ba43f0d.js"><link rel="prefetch" href="/my-notebook/assets/js/223.f4f620e5.js"><link rel="prefetch" href="/my-notebook/assets/js/224.23badaa5.js"><link rel="prefetch" href="/my-notebook/assets/js/225.fa969579.js"><link rel="prefetch" href="/my-notebook/assets/js/226.98103d5e.js"><link rel="prefetch" href="/my-notebook/assets/js/227.0c67db4e.js"><link rel="prefetch" href="/my-notebook/assets/js/228.e971b5f0.js"><link rel="prefetch" href="/my-notebook/assets/js/229.3d841c7e.js"><link rel="prefetch" href="/my-notebook/assets/js/23.0412f6d0.js"><link rel="prefetch" href="/my-notebook/assets/js/230.8762cb6e.js"><link rel="prefetch" href="/my-notebook/assets/js/231.d8c3f284.js"><link rel="prefetch" href="/my-notebook/assets/js/232.71a19c64.js"><link rel="prefetch" href="/my-notebook/assets/js/233.88a01362.js"><link rel="prefetch" href="/my-notebook/assets/js/234.88d165aa.js"><link rel="prefetch" href="/my-notebook/assets/js/235.909ee06e.js"><link rel="prefetch" href="/my-notebook/assets/js/236.23137346.js"><link rel="prefetch" href="/my-notebook/assets/js/237.513d6ca0.js"><link rel="prefetch" href="/my-notebook/assets/js/238.64148829.js"><link rel="prefetch" href="/my-notebook/assets/js/239.9b4b587b.js"><link rel="prefetch" href="/my-notebook/assets/js/24.a58791be.js"><link rel="prefetch" href="/my-notebook/assets/js/240.267c71bc.js"><link rel="prefetch" href="/my-notebook/assets/js/241.39e4a200.js"><link rel="prefetch" href="/my-notebook/assets/js/242.377ff2c2.js"><link rel="prefetch" href="/my-notebook/assets/js/243.46a5ad62.js"><link rel="prefetch" href="/my-notebook/assets/js/244.139e3f3d.js"><link rel="prefetch" href="/my-notebook/assets/js/245.474d2369.js"><link rel="prefetch" href="/my-notebook/assets/js/246.4212f3db.js"><link rel="prefetch" href="/my-notebook/assets/js/247.17e0fc5a.js"><link rel="prefetch" href="/my-notebook/assets/js/248.3877018f.js"><link rel="prefetch" href="/my-notebook/assets/js/249.589b6d82.js"><link rel="prefetch" href="/my-notebook/assets/js/25.de7e8332.js"><link rel="prefetch" href="/my-notebook/assets/js/250.4aa444c6.js"><link rel="prefetch" href="/my-notebook/assets/js/251.b54f41ef.js"><link rel="prefetch" href="/my-notebook/assets/js/252.e2ab51cf.js"><link rel="prefetch" href="/my-notebook/assets/js/253.ec6722fd.js"><link rel="prefetch" href="/my-notebook/assets/js/254.ffc51d38.js"><link rel="prefetch" href="/my-notebook/assets/js/255.79232c72.js"><link rel="prefetch" href="/my-notebook/assets/js/256.73f6133e.js"><link rel="prefetch" href="/my-notebook/assets/js/257.70ac32c7.js"><link rel="prefetch" href="/my-notebook/assets/js/258.1d9d48ed.js"><link rel="prefetch" href="/my-notebook/assets/js/259.2eb1c2ca.js"><link rel="prefetch" href="/my-notebook/assets/js/26.745f46bd.js"><link rel="prefetch" href="/my-notebook/assets/js/260.b45c8594.js"><link rel="prefetch" href="/my-notebook/assets/js/261.49d486e2.js"><link rel="prefetch" href="/my-notebook/assets/js/262.38cd3778.js"><link rel="prefetch" href="/my-notebook/assets/js/263.84a7874f.js"><link rel="prefetch" href="/my-notebook/assets/js/264.e9dc92d5.js"><link rel="prefetch" href="/my-notebook/assets/js/265.e4d83908.js"><link rel="prefetch" href="/my-notebook/assets/js/266.e33a8d14.js"><link rel="prefetch" href="/my-notebook/assets/js/267.1e18bad3.js"><link rel="prefetch" href="/my-notebook/assets/js/268.82faf10f.js"><link rel="prefetch" href="/my-notebook/assets/js/269.d2ebff15.js"><link rel="prefetch" href="/my-notebook/assets/js/27.6ab7d431.js"><link rel="prefetch" href="/my-notebook/assets/js/28.f7314103.js"><link rel="prefetch" href="/my-notebook/assets/js/29.ed1861b3.js"><link rel="prefetch" href="/my-notebook/assets/js/3.db75fba4.js"><link rel="prefetch" href="/my-notebook/assets/js/30.58c1324b.js"><link rel="prefetch" href="/my-notebook/assets/js/31.22f2f99e.js"><link rel="prefetch" href="/my-notebook/assets/js/32.e7a334ab.js"><link rel="prefetch" href="/my-notebook/assets/js/33.2d710e68.js"><link rel="prefetch" href="/my-notebook/assets/js/34.c062662c.js"><link rel="prefetch" href="/my-notebook/assets/js/35.4c4e5aed.js"><link rel="prefetch" href="/my-notebook/assets/js/36.2b0f2e40.js"><link rel="prefetch" href="/my-notebook/assets/js/37.8fc8e706.js"><link rel="prefetch" href="/my-notebook/assets/js/38.d3b0791f.js"><link rel="prefetch" href="/my-notebook/assets/js/39.81906012.js"><link rel="prefetch" href="/my-notebook/assets/js/4.bb9c0373.js"><link rel="prefetch" href="/my-notebook/assets/js/40.773d1a2a.js"><link rel="prefetch" href="/my-notebook/assets/js/41.64aabb4b.js"><link rel="prefetch" href="/my-notebook/assets/js/42.0b00e2d6.js"><link rel="prefetch" href="/my-notebook/assets/js/43.4bead523.js"><link rel="prefetch" href="/my-notebook/assets/js/44.45c8e74a.js"><link rel="prefetch" href="/my-notebook/assets/js/45.2f876e98.js"><link rel="prefetch" href="/my-notebook/assets/js/46.75e1233f.js"><link rel="prefetch" href="/my-notebook/assets/js/47.0775d8a0.js"><link rel="prefetch" href="/my-notebook/assets/js/48.5def65b8.js"><link rel="prefetch" href="/my-notebook/assets/js/49.ffa7073c.js"><link rel="prefetch" href="/my-notebook/assets/js/5.977f0fd9.js"><link rel="prefetch" href="/my-notebook/assets/js/50.1f6c7934.js"><link rel="prefetch" href="/my-notebook/assets/js/51.74d3d2d5.js"><link rel="prefetch" href="/my-notebook/assets/js/52.acb052db.js"><link rel="prefetch" href="/my-notebook/assets/js/53.395fc064.js"><link rel="prefetch" href="/my-notebook/assets/js/54.cd3bc3d3.js"><link rel="prefetch" href="/my-notebook/assets/js/55.5efc9048.js"><link rel="prefetch" href="/my-notebook/assets/js/56.8387348f.js"><link rel="prefetch" href="/my-notebook/assets/js/57.9fb1a3c7.js"><link rel="prefetch" href="/my-notebook/assets/js/58.4467c0e9.js"><link rel="prefetch" href="/my-notebook/assets/js/59.7a6a8da4.js"><link rel="prefetch" href="/my-notebook/assets/js/6.cc2f3f18.js"><link rel="prefetch" href="/my-notebook/assets/js/60.f58416b9.js"><link rel="prefetch" href="/my-notebook/assets/js/61.6b7fd227.js"><link rel="prefetch" href="/my-notebook/assets/js/62.45bd6082.js"><link rel="prefetch" href="/my-notebook/assets/js/63.a8fb7c52.js"><link rel="prefetch" href="/my-notebook/assets/js/64.1e5dbc14.js"><link rel="prefetch" href="/my-notebook/assets/js/65.af839bf4.js"><link rel="prefetch" href="/my-notebook/assets/js/66.352eb581.js"><link rel="prefetch" href="/my-notebook/assets/js/67.ef40e3e4.js"><link rel="prefetch" href="/my-notebook/assets/js/68.ac49ca0f.js"><link rel="prefetch" href="/my-notebook/assets/js/69.29d7616c.js"><link rel="prefetch" href="/my-notebook/assets/js/7.4e593486.js"><link rel="prefetch" href="/my-notebook/assets/js/70.4d966aa9.js"><link rel="prefetch" href="/my-notebook/assets/js/71.52dc5927.js"><link rel="prefetch" href="/my-notebook/assets/js/72.5c7ff943.js"><link rel="prefetch" href="/my-notebook/assets/js/73.ec80ff2b.js"><link rel="prefetch" href="/my-notebook/assets/js/74.bf460777.js"><link rel="prefetch" href="/my-notebook/assets/js/75.7d415a52.js"><link rel="prefetch" href="/my-notebook/assets/js/76.e27d7490.js"><link rel="prefetch" href="/my-notebook/assets/js/77.7b1287c1.js"><link rel="prefetch" href="/my-notebook/assets/js/78.25a3d8ca.js"><link rel="prefetch" href="/my-notebook/assets/js/79.f6319763.js"><link rel="prefetch" href="/my-notebook/assets/js/8.41bcf5b0.js"><link rel="prefetch" href="/my-notebook/assets/js/80.2405e8db.js"><link rel="prefetch" href="/my-notebook/assets/js/81.ff5006ac.js"><link rel="prefetch" href="/my-notebook/assets/js/82.b78ac620.js"><link rel="prefetch" href="/my-notebook/assets/js/83.400cde0a.js"><link rel="prefetch" href="/my-notebook/assets/js/84.373d910f.js"><link rel="prefetch" href="/my-notebook/assets/js/85.5be80cf2.js"><link rel="prefetch" href="/my-notebook/assets/js/86.a7dca088.js"><link rel="prefetch" href="/my-notebook/assets/js/87.6ebef3d8.js"><link rel="prefetch" href="/my-notebook/assets/js/88.ddb7d378.js"><link rel="prefetch" href="/my-notebook/assets/js/89.7f9db42a.js"><link rel="prefetch" href="/my-notebook/assets/js/9.9a267fb7.js"><link rel="prefetch" href="/my-notebook/assets/js/90.a36d7d6c.js"><link rel="prefetch" href="/my-notebook/assets/js/91.89ea9773.js"><link rel="prefetch" href="/my-notebook/assets/js/92.63b8e075.js"><link rel="prefetch" href="/my-notebook/assets/js/93.9ef26ee4.js"><link rel="prefetch" href="/my-notebook/assets/js/94.9c06ff29.js"><link rel="prefetch" href="/my-notebook/assets/js/95.2773a3a8.js"><link rel="prefetch" href="/my-notebook/assets/js/96.3e6f7f2f.js"><link rel="prefetch" href="/my-notebook/assets/js/97.545ade6a.js"><link rel="prefetch" href="/my-notebook/assets/js/98.22e25866.js"><link rel="prefetch" href="/my-notebook/assets/js/99.a7f792f6.js">
    <link rel="stylesheet" href="/my-notebook/assets/css/0.styles.09dde1b2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-notebook/" class="home-link router-link-active"><!----> <span class="site-name">Garrik 的笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-notebook/" class="nav-link">主页</a></div><div class="nav-item"><a href="https://github.com/Garrik-Liu/my-notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-notebook/" class="nav-link">主页</a></div><div class="nav-item"><a href="https://github.com/Garrik-Liu/my-notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Java 基础知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#基础知识" class="sidebar-link">基础知识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#注释" class="sidebar-link">注释</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#基本数据类型-变量" class="sidebar-link">基本数据类型 &amp; 变量</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#类型转换" class="sidebar-link">类型转换</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#字符串" class="sidebar-link">字符串</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#命令行输入输出" class="sidebar-link">命令行输入输出</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#number-类-math-类" class="sidebar-link">Number 类 &amp; Math 类</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#大数值" class="sidebar-link">大数值</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#数组" class="sidebar-link">数组</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#面向对象" class="sidebar-link">面向对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#类-对象" class="sidebar-link">类 &amp; 对象</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#用户自定义类" class="sidebar-link">用户自定义类</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#修饰符" class="sidebar-link">修饰符</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#方法参数" class="sidebar-link">方法参数</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#对象构造" class="sidebar-link">对象构造</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#包" class="sidebar-link">包</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#文档注释" class="sidebar-link">文档注释</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#继承" class="sidebar-link">继承</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#继承基础" class="sidebar-link">继承基础</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#object-类" class="sidebar-link">Object 类</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#枚举" class="sidebar-link">枚举</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#声明枚举" class="sidebar-link">声明枚举</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#枚举类的实现原理" class="sidebar-link">枚举类的实现原理</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#自定义枚举类的构造函数" class="sidebar-link">自定义枚举类的构造函数</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#枚举类常用方法" class="sidebar-link">枚举类常用方法</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#接口" class="sidebar-link">接口</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#什么是接口" class="sidebar-link">什么是接口</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#接口使用案例" class="sidebar-link">接口使用案例</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#内部类" class="sidebar-link">内部类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#声明内部类" class="sidebar-link">声明内部类</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#局部内部类" class="sidebar-link">局部内部类</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#匿名内部类" class="sidebar-link">匿名内部类</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#静态内部类" class="sidebar-link">静态内部类</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#lambda-表达式" class="sidebar-link">lambda 表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#什么是-lambda-表达式" class="sidebar-link">什么是 lambda 表达式</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#方法引用" class="sidebar-link">方法引用</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#变量作用域" class="sidebar-link">变量作用域</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#反射" class="sidebar-link">反射</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#class-类" class="sidebar-link">Class 类</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#利用反射分析类的能力" class="sidebar-link">利用反射分析类的能力</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#在运行时使用反射操纵对象" class="sidebar-link">在运行时使用反射操纵对象</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#代理-proxy" class="sidebar-link">代理 Proxy</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#什么是代理" class="sidebar-link">什么是代理</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#静态代理" class="sidebar-link">静态代理</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#动态代理" class="sidebar-link">动态代理</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#异常" class="sidebar-link">异常</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#处理错误" class="sidebar-link">处理错误</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#捕获异常" class="sidebar-link">捕获异常</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#泛型" class="sidebar-link">泛型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#什么是泛型" class="sidebar-link">什么是泛型</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#泛型的上限-下限" class="sidebar-link">泛型的上限 &amp; 下限</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#类型擦除" class="sidebar-link">类型擦除</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#类型擦除带来的约束-局限性" class="sidebar-link">类型擦除带来的约束 &amp; 局限性</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#通配符类型" class="sidebar-link">通配符类型</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#集合" class="sidebar-link">集合</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#collection-接口" class="sidebar-link">Collection 接口</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#list-接口" class="sidebar-link">List 接口</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#set-接口" class="sidebar-link">Set 接口</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#queue-接口" class="sidebar-link">Queue 接口</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#map-接口" class="sidebar-link">Map 接口</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#并发" class="sidebar-link">并发</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#多线程基础" class="sidebar-link">多线程基础</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#线程同步" class="sidebar-link">线程同步</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#线程池" class="sidebar-link">线程池</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java/Java%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html#相关参考" class="sidebar-link">相关参考</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="java-基础知识"><a href="#java-基础知识" class="header-anchor">#</a> Java 基础知识</h1> <h2 id="基础知识"><a href="#基础知识" class="header-anchor">#</a> 基础知识</h2> <h3 id="注释"><a href="#注释" class="header-anchor">#</a> 注释</h3> <p>在 Java 中有三种加注释的方法：</p> <ul><li>在文字前面加 <code>//</code>；</li> <li>使用 <code>/* */</code> 将一段文字包裹起来；</li> <li>使用 <code>/**</code> 开始，以 <code>*/</code> 结束。这种注释可以被 javadoc 工具自动解析成文档。可以避免代码与文档分开写，而导致二者更新不同步的情况。具体使用方法后面讲；</li></ul> <h3 id="基本数据类型-变量"><a href="#基本数据类型-变量" class="header-anchor">#</a> 基本数据类型 &amp; 变量</h3> <ul><li>Java 是一个强类型语言，每个变量必须有一个类型；</li> <li>在 Java 中一共有 <strong>8 种基本类型</strong>；
<ul><li>4 种整型 <strong>int, short, long, byte</strong>；</li> <li>2 种浮点类型 <strong>float, double</strong>；</li> <li>1 种字符类型 <strong>char</strong>；</li> <li>1 种真值类型 <strong>boolean</strong>；</li></ul></li></ul> <p><strong>int, short, long, byte</strong>；</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-11-23-59-16.png" alt="2020-04-11-23-59-16"></p> <p><strong>float, double</strong>；</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-00-01-45.png" alt="2020-04-12-00-01-45"></p> <ul><li>double 表示的数值精度是 fLoat 的二倍，所以也叫双精度数值；</li> <li>基本上实际开发时都使用 double 类型去表示浮点数值；</li> <li>默认情况下，一个浮点数值被认为是 double 类型，例如 <code>3.14</code>。如果要表示其为 float 类型，需要在数值后面加 <code>f</code> 或者 <code>F</code> 作为后缀，如 <code>3.14F</code>；</li></ul> <p><strong>char</strong>；</p> <ul><li>char 类型是一个单一的 16 位 Unicode 字符；</li> <li>最小值是 <code>\u0000</code>（即为 0）；</li> <li>最大值是 <code>\uffff</code>（即为 65,535）；</li> <li><code>\u</code> 为转义符，后面加上 16 进制数值，表示转换成 Unicode 字符；</li> <li>char 类型的字面量值要用单引号括起来，例如 <code>'A'</code>；</li></ul> <p><strong>boolean</strong>；</p> <ul><li>有两个值 <code>true</code> 和 <code>false</code>；</li> <li>默认值是 false；</li></ul> <h4 id="变量"><a href="#变量" class="header-anchor">#</a> 变量</h4> <ul><li>在声明变量时，变量的类型位于变量名之前；</li> <li>变量名大小写敏感；</li> <li>变量名必须以字母开头，可以由数字，字母，下划线，美元符号组成；</li> <li>可以在程序的任何地方进行变量的声明，但尽量靠近变量第一次使用的地方；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">double</span> salary<span class="token punctuation">;</span>
<span class="token keyword">int</span> days<span class="token punctuation">;</span>
<span class="token keyword">boolean</span> isValid<span class="token punctuation">;</span>
</code></pre></div><ul><li>声明完一个变量后，应该立刻进行显示的初始化，这样可以避免 BUG；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> days <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="常量"><a href="#常量" class="header-anchor">#</a> 常量</h4> <ul><li>利用关键字 <code>final</code> 指示常量；</li> <li>常量一旦被赋值就不能更改；</li> <li>常量名习惯用大写；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token keyword">int</span> DAY_OF_WEEK <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="类型转换"><a href="#类型转换" class="header-anchor">#</a> 类型转换</h3> <h4 id="算术运算时的类型转换"><a href="#算术运算时的类型转换" class="header-anchor">#</a> 算术运算时的类型转换</h4> <p>在使用操作符（+，-，*，/，%）对两个操作数进行算术运算的时候，如果两个操作数类型不同，会默认进行类型转换：</p> <ul><li>如果其中一个是 double 类型，另一个转换成 double 类型；</li> <li>否则，如果其中一个是 float 类型，另一个转换成 float 类型；</li> <li>否则，如果其中一个是 long 类型，另一个转换成 long 类型；</li> <li>否则，两个操作数都转换成 int 类型；</li></ul> <p>下图表示了数值类型之间的合法转换：</p> <ul><li>实心箭头表示没有信息丢失的转换；</li> <li>虚箭头表示有精度损失的转换；
<ul><li>例如：<code>123456789</code> 是一个 int 类型，其包含的位数比 float 类型所能表达的位数多，这时如果将其转换成 float 类型，就会造成精度的损失；</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-10-19-00.png" alt="2020-04-12-10-19-00"></p> <h4 id="强制类型转换"><a href="#强制类型转换" class="header-anchor">#</a> 强制类型转换</h4> <ul><li>如果想将 double 转换成 int 类型，我们需要进行<strong>强制类型转换</strong>（cast） 操作。</li> <li>语法格式是在圆括号中给出想要转换到的目标类型，后面紧跟待转换的变量名；</li> <li>不要将 boolean 类型变量强制转换成任何类型，这样可以防止错误发生；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">12.221</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> x<span class="token punctuation">;</span> <span class="token comment">// y = 12</span>
</code></pre></div><h3 id="字符串"><a href="#字符串" class="header-anchor">#</a> 字符串</h3> <ul><li>Java 没有内置的字符串类型；</li> <li>Java 字符串就是 Unicode 字符序列；</li> <li>而标准 Java 类库中提供了一个 String 类，任何用双括号包裹的字符串都被认作是 String 实例；</li> <li>String 实例被称作<strong>不可变字符串</strong>，因为你不可以更改实例中的任何一个字符。如果想改变字符串变量的值，只能让其指向一个新的 String 实例；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> hello <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span>；
</code></pre></div><h4 id="子串"><a href="#子串" class="header-anchor">#</a> 子串</h4> <p>使用 <strong><code>substring</code></strong> 方法可以从一个较大的字符串中<strong>提取一个子串</strong>：</p> <ul><li>接收两个参数，第一个是子串在原字符串中开始的下标；第二个参数是结束位置后一位的下标；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> hello <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span>；
<span class="token class-name">String</span> s <span class="token operator">=</span> hello<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hel</span>
</code></pre></div><h4 id="拼接"><a href="#拼接" class="header-anchor">#</a> 拼接</h4> <p>使用 <strong><code>+</code></strong> 号可以进行<strong>字符串的拼接</strong>：</p> <ul><li>将一个字符串与一个非字符串进行拼接时，后者会被转换成字符串；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> x <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> y <span class="token operator">=</span> <span class="token string">&quot;xyz&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> z <span class="token operator">=</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token comment">// 123xyz</span>

<span class="token comment">// ----</span>

<span class="token class-name">String</span> x <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> y <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> z <span class="token operator">=</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token comment">// 123123</span>
</code></pre></div><p>使用 String 类型的 <code>join</code> 静态方法，可以将多个字符串进行拼接时，用一个指定的定界符分隔；</p> <ul><li>定界符作为第一个参数；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> x <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hello/World</span>

</code></pre></div><h4 id="字符串相等判断"><a href="#字符串相等判断" class="header-anchor">#</a> 字符串相等判断</h4> <ul><li>因为变量保存的是字符串实例的引用，不能用 <code>==</code> 判断两个字符串内容是否相等；</li> <li>要用 String 实例的 <code>equals</code> 方法去检测；</li> <li>方法返回一个 boolean 类型的值，作为判断结果；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> x <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> y <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">boolean</span> z <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><ul><li>如果想忽略大小写可以用 <code>equalsIgnoreCase</code> 方法；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> x <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> y <span class="token operator">=</span> <span class="token string">&quot;ABC&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">boolean</span> z <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h4 id="常用-string-方法"><a href="#常用-string-方法" class="header-anchor">#</a> 常用 String 方法</h4> <p>下面汇总了 String 类常用的方法：</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-10-53-40.png" alt="2020-04-12-10-53-40"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-10-54-02.png" alt="2020-04-12-10-54-02"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-10-54-14.png" alt="2020-04-12-10-54-14"></p> <h3 id="命令行输入输出"><a href="#命令行输入输出" class="header-anchor">#</a> 命令行输入输出</h3> <h4 id="格式化输出"><a href="#格式化输出" class="header-anchor">#</a> 格式化输出</h4> <ul><li><code>System.out.print()</code> 可以将字符串输出打印到控制台上；</li> <li><code>System.out.println()</code> 会在结尾添加一个换行符 <code>/n</code>；</li> <li><code>System.out.printf</code> 可以用来进行格式化输出；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> x <span class="token operator">=</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> y <span class="token operator">=</span> <span class="token string">&quot;Garrik&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, %s, %s.&quot;</span><span class="token punctuation">,</span> x，y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>每一个以 % 字符开始的格式说明符都会被对应的参数所替换；</li> <li>% 后面的字母被称作转换符，指示被格式化的数值类型；</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-11-36-54.png" alt="2020-04-12-11-36-54"></p> <ul><li>% 和转换符之间还可以添加用于控制格式化输出的各种 “标志”；</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-11-40-01.png" alt="2020-04-12-11-40-01"></p> <ul><li><p><code>System.out.printf(&quot;%8.2f&quot;, x)</code> 将以 8 个字符的宽度，和保留小数点后两个字符的精度打印 x。例如：<code>12345.67</code>；</p></li> <li><p>使用 <code>String.format</code> 方法可以创建一个格式化的字符串，而不打印输出；</p></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> world <span class="token operator">=</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> x <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, %s&quot;</span><span class="token punctuation">,</span> world<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="读取输入"><a href="#读取输入" class="header-anchor">#</a> 读取输入</h4> <ul><li>想要通过控制台获取一个输入，先要创建一个 <code>Scanner</code> 实例。并与标准输入流 <code>System.in</code> 进行关联；</li> <li>之后就可以使用 Scanner 类的各种方法实现输入操作了；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Scanner</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-11-51-06.png" alt="2020-04-12-11-51-06"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-11-52-02.png" alt="2020-04-12-11-52-02"></p> <h3 id="number-类-math-类"><a href="#number-类-math-类" class="header-anchor">#</a> Number 类 &amp; Math 类</h3> <ul><li>Java 为每一个基本数据类型都提供了对应的包装类；</li> <li><strong>Integer, Long, Byte, Double, Float, Short</strong>；</li> <li>它们都是 Number 类的子类；</li> <li>当编译器把一个基本数据类型数值转换成对应的包装类实例时，被称为 “<strong>装箱</strong>”，反之称之为 “<strong>拆箱</strong>”；</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-12-16-07.png" alt="2020-04-12-12-16-07"></p> <ul><li><code>parseInt()</code> 方法用于将字符串参数作为有符号的十进制整数进行解析。可以通过第二个参数指定基数；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> x <span class="token operator">=</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">&quot;9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">double</span> c <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span><span class="token string">&quot;5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">&quot;444&quot;</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 9</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5.0</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1092</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <ul><li>Java 的 Math 包含了用于执行基本数学运算的属性和方法；</li> <li>Math 的方法都被定义为 <code>static</code> 形式，可以直接调用；</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-12-19-42.png" alt="2020-04-12-12-19-42"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-12-19-56.png" alt="2020-04-12-12-19-56"></p> <h3 id="大数值"><a href="#大数值" class="header-anchor">#</a> 大数值</h3> <p><a href="http://itmyhome.com/java-api/java/math/class-use/BigInteger.html" target="_blank" rel="noopener noreferrer">BigInteger 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>通过 <code>BigInteger</code> 和 <code>BigDecimal</code> 类可以处理包含任意长度数字序列的数值；</li> <li>使用两个类中的静态方法 <code>valueOf</code> 可以将普通的数值转换成大数值；</li> <li>但是加减乘除不能使用（<code>+，-，*，/</code>）需要使用实例方法：
<ul><li><code>+</code>：<code>add</code>；</li> <li><code>-</code>：<code>subtract</code>；</li> <li><code>*</code>：<code>multiply</code>；</li> <li><code>/</code>：<code>divide</code>；</li> <li><code>%</code>：<code>mod</code>；</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-12-29-57.png" alt="2020-04-12-12-29-57"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-12-29-13.png" alt="2020-04-12-12-29-13"></p> <h3 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h3> <ul><li>可以通过以下两种形式声明数组：
<ul><li><code>int[] a = new int[100];</code></li> <li><code>int a[] = new int[100];</code></li></ul></li> <li>可以用于以下两种方式进行初始化：
<ul><li><code>int a[] = new int[] {1, 2, 3, 4, 5, 6};</code></li> <li><code>int a[] = {1, 2, 3, 4, 5, 6};</code></li> <li>数组的大小就是初始值的个数；</li></ul></li> <li>通过 <code>Arrays.copyOf</code> 可以进行数组的拷贝，将一个数组的值拷贝到另一个数组中；
<ul><li>第一个参数是被拷贝的数组；</li> <li>第二个参数是新数组的长度；</li> <li>如果长度小于原始数组就只拷贝最前面的数据；</li></ul></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> b<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> a<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 数组扩容;</span>
</code></pre></div><p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-12-42-52.png" alt="2020-04-12-12-42-52"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-12-42-33.png" alt="2020-04-12-12-42-33"></p> <ul><li>声明多维数组：</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="面向对象"><a href="#面向对象" class="header-anchor">#</a> 面向对象</h2> <p>面向对象编程具有三大特性：</p> <ul><li><strong>封装</strong>：把数据和行为隐藏起来，只对外暴露出一些接口，来让外部能够对其进行使用，而内部的具体实现，外部并不知道；</li> <li><strong>继承</strong>：扩展一个已有的类，扩展出来的新类具有被扩展类的所有属性和方法，同时新类还可以加上自己的新属性和方法；</li> <li><strong>多态</strong>：指同一个行为具有多个不同表现形式或形态的能力。
<ul><li>在程序中，会出现变量所指向的具体实例对象，和通过这个变量来对实例对象调用的方法，在编译时不确定，需要在运行时确定的需求；</li> <li>在支持多态的语言中，可以不更改源代码，让不同类型的实例自动赋值到变量上，从而导致通过此变量调用实例方法，随着实例类型的不同，而表现不同的运行状态；</li></ul></li></ul> <h3 id="类-对象"><a href="#类-对象" class="header-anchor">#</a> 类 &amp; 对象</h3> <ul><li><strong>类</strong>（class）是构造对象的模板；</li> <li>通过类创建对象的过程叫做创建类的<strong>实例</strong>（instance）；</li> <li>对象的数据叫做<strong>实例域</strong>（instance field），对象内操纵数据的过程叫做<strong>方法</strong>（method）；</li> <li>每个实例对象都有自己单独的实例域值，这些值的集合叫做这个对象的当前<strong>状态</strong>（state）；</li> <li>方法定义了对象所支持的行为（behavior），对象的状态必须通过调用方法来改变，如果被外部行为所改变，说明类的封装性遭到破坏；</li></ul> <h4 id="什么东西应该作为一个类"><a href="#什么东西应该作为一个类" class="header-anchor">#</a> 什么东西应该作为一个类</h4> <ul><li>简单的规则就是在分析问题的过程中寻找<strong>名词</strong>，而方法对应着<strong>动词</strong>；</li> <li>🌰 例如，在订单处理系统中，会看见如下一些名词：
<ul><li>商品 Item，订单 Order，账户 Account，付款 Payment，等；</li></ul></li> <li>这些名词都可能会被作为一个类 Class；</li> <li>这些名词可能涉及到的操作有：商品被添加到购物车；订单被取消/添加；用户支付订单；用户登录/登出；</li> <li>其中动词有：添加，取消，支付，登录，登出；</li> <li>这些动词就会称为对应类所支持的方法；</li> <li>当然这条规则也只作为参考，具体实现还是根据你的情况而定；</li></ul> <h4 id="类与类之间的关系"><a href="#类与类之间的关系" class="header-anchor">#</a> 类与类之间的关系</h4> <ul><li>在类之间，常见的关系有：
<ul><li><strong>依赖</strong> uses-a；</li> <li><strong>聚合</strong> has-a；</li> <li><strong>继承</strong> is-a；</li></ul></li> <li><strong>依赖</strong>（dependence），即 uses-a 关系，是最常见的一种关系。<strong>如果一个类的方法操作了另一个类的对象，那么就说这个类依赖于另一个类</strong>；
<ul><li>🌰 例如：订单 Order 对象需要依赖商品 Product 对象，因为订单里需要知道都买了什么商品；</li> <li>类与类之间的相互依赖应当尽可能的减少，这样一个类的改变，可以尽可能地不会影响到其他的类。这被称作<strong>降低类之间的耦合性</strong>；</li> <li>在 Java 中，依赖关系表现为<strong>局域变量</strong>、<strong>方法的形参</strong>，或者<strong>静态方法的调用</strong>；</li></ul></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;汽车在奔跑&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Driver</span> <span class="token punctuation">{</span>
	<span class="token comment">//使用形参方式发生依赖关系</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">drive1</span><span class="token punctuation">(</span><span class="token class-name">Car</span> car<span class="token punctuation">)</span><span class="token punctuation">{</span>
		car<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//使用局部变量发生依赖关系</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">drive2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">Car</span> car <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		car<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//使用静态变量发生依赖关系</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">drive3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>聚合</strong>（aggregation），即 has-a 关系。<strong>如果一个类包含另一个类的对象，那么它们就具有聚合关系</strong>；
<ul><li>同样，应当尽可能减少类之间的聚合，来保证低耦合；</li> <li>Java 中一般使用<strong>成员变量</strong>形式实现；</li></ul></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Driver</span> <span class="token punctuation">{</span>
	<span class="token comment">//使用成员变量形式实现聚合关系</span>
	<span class="token class-name">Car</span> mycar<span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">drive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		mycar<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>继承</strong>（inheritance），即 is-a 关系。<strong>如果一个类扩展自另一个类，那么它们就具有继承关系</strong>。扩展类拥有被扩展类的所有属性和方法，同时还加上自己的新属性和新功能；</li></ul> <hr> <p><a href="https://www.w3cschool.cn/uml_tutorial/" target="_blank" rel="noopener noreferrer">UML 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>在开发中，大多使用 UML 图来表示类与类之间的关系；</li> <li><strong>UML 统一建模语言</strong>（Unified Modeling Language）；</li> <li>UML 为开发团队提供标准通用的设计语言来开发和构建计算机应用；</li> <li>UML 支持面向对象的技术，能够准确的方便地表达面向对像的概念；</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-22-27-26.png" alt="2020-04-12-22-27-26"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-12-22-28-27.png" alt="2020-04-12-22-28-27"></p> <h3 id="用户自定义类"><a href="#用户自定义类" class="header-anchor">#</a> 用户自定义类</h3> <p>用户自己编写的类的格式如下：</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-13-10-28-48.png" alt="2020-04-13-10-28-48"></p> <p>🌰 下面是一个 Class 的例子：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> salary<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">LocalDate</span> hireDay<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">,</span> <span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>
    hireDay <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> salary<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">LocalDate</span> <span class="token function">getHireDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hireDay<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">raiseSalary</span><span class="token punctuation">(</span><span class="token keyword">double</span> byPercent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> raise <span class="token operator">=</span> salary <span class="token operator">*</span> byPercent <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>
    salary <span class="token operator">+=</span> raise<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="构造器"><a href="#构造器" class="header-anchor">#</a> 构造器</h4> <p>在上面的类里，这段函数被称作类的<strong>构造器</strong>。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">,</span> <span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>
    hireDay <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>构造器与类必须同名；</li> <li>构造器用来在创建类实例时，初始化实例域（属性）；</li> <li>每个类可以有一个以上的构造器，通过参数的不同来进行区别，这被称作重载；</li> <li>构造器没有返回值；</li> <li>构造器函数需要伴随着 <code>new</code> 操作符一起使用；</li></ul> <h4 id="隐式参数-显式参数"><a href="#隐式参数-显式参数" class="header-anchor">#</a> 隐式参数 &amp; 显式参数</h4> <p>下面 👇 这个方法可以将调用这个方法的对象的 salary 实例域（属性）设置为新值；</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">raiseSalary</span><span class="token punctuation">(</span><span class="token keyword">double</span> byPercent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> raise <span class="token operator">=</span> salary <span class="token operator">*</span> byPercent <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>
  salary <span class="token operator">+=</span> raise<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>下面的调用将 <code>e</code> 的 <code>salary</code> 属性的值增加了 5%。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Employee</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">&quot;Garrik&quot;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">1997</span><span class="token punctuation">,</span> <span class="token number">06</span><span class="token punctuation">,</span> <span class="token number">04</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

e<span class="token punctuation">.</span><span class="token function">raiseSalary</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>raiseSalary</code> 方法有两个参数：</p> <ul><li>第一个参数为 “<strong>隐式参数 implicit</strong>”，是出现在方法名前面的 Employee 类实例。也有人称为方法的调用者；</li> <li>第二个参数为，“<strong>显式参数 explicit</strong>”，是传入方法名后面括号里的值；</li></ul> <p>在方法体中，关键字 <strong><code>this</code></strong> 表示隐式参数：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">raiseSalary</span><span class="token punctuation">(</span><span class="token keyword">double</span> byPercent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> raise <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">*</span> byPercent <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">+=</span> raise<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面 👆 的函数也可以这样写，直接把 <code>this</code> 写在函数体中；
很多人喜欢这种风格，因为可以将实例域与局部变量很明显地区分开来；</p> <p>当显式参数与实例域同名时，就必须要用 <code>this</code> 来指示实例域：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">,</span> <span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>
  hireDay <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="修饰符"><a href="#修饰符" class="header-anchor">#</a> 修饰符</h3> <p><strong>修饰符</strong>用来定义类、方法或者变量的特性；</p> <p>Java 语言提供了很多修饰符，主要分为以下两类：</p> <ul><li><strong>访问修饰符</strong>；</li> <li><strong>非访问修饰符</strong>；</li></ul> <h4 id="访问修饰符"><a href="#访问修饰符" class="header-anchor">#</a> 访问修饰符</h4> <p>访问修饰符用来定义类、方法或其他成员的可访问性。Java 支持 4 种不同的访问修饰符：</p> <p><strong><code>default</code></strong>:</p> <ul><li>使用默认访问修饰符声明的变量和方法，对同一个包内的类是可见的；</li></ul> <p><strong><code>private</code></strong>:</p> <ul><li>被声明为 private 的方法、变量和构造方法只能被所属类访问；</li> <li>类和接口不能声明为 private，内部类除外；</li> <li>private 变量只能通过类中 public 的 getter 方法被外部访问；</li></ul> <p><strong><code>public</code></strong>:</p> <ul><li>被声明为 public 的类、方法、构造方法和接口能够被任何其他类访问；</li> <li>类所有的公有方法和变量都能被其子类继承；</li></ul> <p><strong><code>protected</code></strong>:</p> <ul><li>protected 可以修饰数据成员，构造方法，方法成员，不能修饰类（内部类除外）；</li> <li>如果子类与基类在同一包中，被声明为 protected 的变量、方法和构造器能被同一个包中的任何其他类访问；</li> <li>如果子类与基类不在同一包中，那么在子类中，子类实例可以访问其从基类继承而来的 protected 方法，而不能访问基类实例的 protected 方法。这样就能保护不相关的类使用这些方法和变量；</li> <li>父类中声明为 protected 的方法在子类中要么声明为 protected，要么声明为 public，不能声明为 private；</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-13-20-23-49.png" alt="2020-04-13-20-23-49"></p> <p>🌰 例子，下面代码中，父类使用了 <code>protected</code> 访问修饰符，子类重写了父类的方法：</p> <ul><li>如果把该方法声明为 <code>private</code>，那么除了 AudioPlayer 之外的类将不能访问该方法。</li> <li>如果把该方法声明为 <code>public</code>，那么所有的类都能够访问该方法。</li> <li>如果我们只想让该方法对其所在类的子类可见，则将该方法声明为 <code>protected</code>；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token keyword">class</span> <span class="token class-name">AudioPlayer</span> <span class="token punctuation">{</span>
   <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">openSpeaker</span><span class="token punctuation">(</span><span class="token class-name">Speaker</span> sp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 实现细节</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">StreamingAudioPlayer</span> <span class="token keyword">extends</span> <span class="token class-name">AudioPlayer</span> <span class="token punctuation">{</span>
   <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">openSpeaker</span><span class="token punctuation">(</span><span class="token class-name">Speaker</span> sp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 实现细节</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="非访问修饰符"><a href="#非访问修饰符" class="header-anchor">#</a> 非访问修饰符</h4> <p>Java 也提供了许多非访问修饰符：</p> <p><strong><code>static</code></strong>:</p> <ul><li>用来修饰属于类的方法和变量. 所有类的实例都共享着同一份静态变量和方法. 静态变量和方法也被称为 &quot;类变量&quot; 和 &quot;类方法&quot;;</li> <li>静态方法不能使用类的非静态变量;</li></ul> <p><strong><code>final</code></strong>:</p> <ul><li>用来声明常量, 变量一旦赋值后, 不能被重新赋值;</li> <li>被 final 修饰的实例变量必须显式指定初始值;</li> <li>父类中的 final 方法被子类继承后不能被重写;</li></ul> <p><strong><code>abstract</code></strong>:</p> <ul><li>抽象类不能用来实例化对象;</li> <li>声明抽象类的唯一目的是为了将来对该类进行扩充;</li> <li>如果一个类包含抽象方法，那么该类一定要声明为抽象类;</li> <li>抽象类可以包含抽象方法和非抽象方法;</li> <li>抽象方法是一种没有任何实现的方法，该方法的的具体实现由子类提供;</li> <li>抽象方法不能被声明成 final 和 static;</li> <li>任何继承抽象类的子类必须实现父类的所有抽象方法，除非该子类也是抽象类;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">SuperClass</span><span class="token punctuation">{</span>
  <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//抽象方法</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SubClass</span> <span class="token keyword">extends</span> <span class="token class-name">SuperClass</span><span class="token punctuation">{</span>
  <span class="token comment">//实现抽象方法</span>
  <span class="token keyword">void</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong><code>synchronized</code></strong> &amp; <strong><code>volatile</code></strong>:主要用于线程的编程，这里先不讲;</li></ul> <h4 id="getter-setter"><a href="#getter-setter" class="header-anchor">#</a> Getter &amp; Setter</h4> <p>为了保证实例域 (实例的属性) 不会被外界随意修改, 保证封装性;</p> <p>在类中通常把属性实例域设置为 <code>private</code> 私有;</p> <p>同时提供 <code>public</code> 公共的 &quot;Getter 访问器方法&quot;, 和 &quot;Setter 更改器方法&quot;, 用以让外界来对实例域进行获取和修改;</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>好处</strong>:</p> <ul><li>即使类的内部实现改变, 只要 Getter 和 Setter 的名字不改, 不会影响到外部对该类的使用;</li> <li>在 Setter 方法中, 可以对传入的属性进行错误检查, 以防错误数据传入;</li> <li>防止外部对实例内部的属性进行随意更改;</li></ul> <p>不要编写返回引用类型对象的 Getter 方法;</p> <ul><li>在上面 👆 的 Employee 类 <code>getHireDay</code> 方法就返回了一个 Date 类实例, 这样破坏了封装性;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">private</span> <span class="token class-name">LocalDate</span> hireDay<span class="token punctuation">;</span>

  <span class="token comment">// ...</span>

  <span class="token keyword">public</span> <span class="token class-name">LocalDate</span> <span class="token function">getHireDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hireDay<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>返回引用类型,会导致允许外部对实例内部属性进行修改;</li> <li>假如我们有一个实例 harry, 然后 <code>Date d = harry.getHireDay();</code> <code>d</code> 和 <code>harry.hireDay</code> 都指向同一个 Date 实例, 通过 <code>d</code> 就可以更改实例内部的属性;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-13-22-38-13.png" alt="2020-04-13-22-38-13"></p> <ul><li>如果需要返回一个对象实例, 那么应该对它进行克隆 clone, 然后返回对象的克隆副本;</li> <li>上面代码可以修改如下:</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-13-22-43-32.png" alt="2020-04-13-22-43-32"></p> <h4 id="基于类的访问权限"><a href="#基于类的访问权限" class="header-anchor">#</a> 基于类的访问权限</h4> <p><strong>类的方法可以访问同一个类的任何一个实例的私有域</strong> (私有属性);</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-13-22-45-49.png" alt="2020-04-13-22-45-49"></p> <p>上面 👆 代码中, 在类方法中, 可以访问传入进来的同类实例的私有属性;</p> <h3 id="方法参数"><a href="#方法参数" class="header-anchor">#</a> 方法参数</h3> <p>在程序设计语言中, 将参数传递给方法有两种方式:</p> <ul><li><strong>按值传递</strong> (call by value): 表示方法接收的是调用者提供的值;</li> <li><strong>按引用传递</strong> (call by reference): 表示方法接收的是调用者提供的内存地址;</li></ul> <p><strong>在 Java 中, 函数接收的参数总是按值传递的</strong>. 函数接收的是参数值的拷贝.</p> <p>但参数会有两种类型:</p> <ul><li>基本数据类型: 变量保存的是数据的值;</li> <li>引用类型: 变量保存的是对象的地址;</li></ul> <p>对于基本数据类型, 函数内部将传入参数的值拷贝了一份给参数变量, 函数内部对参数变量的修改, 不会影响外部.</p> <p>但是对于引用类型, 函数内部保存的是对象在内存中的地址, 通过地址可以直接访问到外部的对象实例, 并且能够对其进行操作.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>⚠️ 很多人以为对引用类型参数, 采用的是按引用传递. 但其实依旧是按值传递.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> x<span class="token punctuation">,</span> <span class="token class-name">Employee</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Employee</span> temp <span class="token operator">=</span> x<span class="token punctuation">;</span>
  x <span class="token operator">=</span> y<span class="token punctuation">;</span>
  y <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果是按引用传递, 那么内部对 x 和 y 的值的交换, 就会影响到外部作为参数传入的两个变量的值.</p> <p><strong>按值传递</strong>的意思是, <strong>函数接收的是作为参数传入的变量上保存的值的拷贝</strong>. 变量上保存的是对象的地址.</p> <p><strong>按引用传递</strong>的意思是, <strong>函数接收的是作为参数传入的变量的地址的拷贝</strong>. 通过这个地址引用, 可以在函数内部修改外部变量上保存的值.</p></div> <h4 id="传递可变数量的参数"><a href="#传递可变数量的参数" class="header-anchor">#</a> 传递可变数量的参数</h4> <p>如果想让一个方法接收不确定数量的参数, 可以使用 <code>...</code> 来表示:</p> <p>🌰 例如, 下面 👇 方法用来计算若干个数值中的最大值:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> largest <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">double</span> v <span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>v <span class="token operator">&gt;</span> largest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      largest <span class="token operator">=</span> v<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> largest<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在方法内, 用一个数组来储存所传进来的不确定数量的参数.</p> <h3 id="对象构造"><a href="#对象构造" class="header-anchor">#</a> 对象构造</h3> <p>Java 提供了多种编写构造器的机制:</p> <h4 id="重载"><a href="#重载" class="header-anchor">#</a> 重载</h4> <p>Java 中允许多个方法具有同一个名字, 但是有不同的参数, 这被称为<strong>重载</strong>.</p> <p>注意, 重载方法的返回值类型必须相同.</p> <p>在代码编译时, 编译器会通过调用方法时传入的参数类型和数量, 来寻找匹配的方法. 如果找不到就报错, 这个过程称为<strong>重载解析</strong> overloading resolution.</p> <p>Java 允许重载任何方法, 构造器方法也可以进行重载.</p> <h4 id="默认构造器"><a href="#默认构造器" class="header-anchor">#</a> 默认构造器</h4> <p><strong>如果编写类时, 没有提供构造器. Java 会提供给你一个默认无参数的构造器</strong>.</p> <p>在构造器中, 所有的实例域都设置为默认值:</p> <ul><li>数值类型设置为 0;</li> <li>布尔类型设置为 false;</li> <li>对象类型设置为 null;</li></ul> <p>但如果类中提供了一个有参数的构造器, 没有提供无参数的构造器. 那么 Java 不会提供给你无参数的构造器.<br>
如果你创建实例时没有提供任何参数, 就会报错.</p> <h4 id="调用另一个构造器"><a href="#调用另一个构造器" class="header-anchor">#</a> 调用另一个构造器</h4> <p>在构造器中, 如果第一行语句形如 <strong><code>this(...)</code></strong>, 那么它可以调用同一个类的另一个构造器.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> nextId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">long</span> id<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> salary<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token keyword">long</span> id<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token keyword">double</span> salary<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">(</span>nextId<span class="token punctuation">,</span> salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
    nextId<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="初始化块"><a href="#初始化块" class="header-anchor">#</a> 初始化块</h4> <p>在一个类的声明中, 可以包含多个代码块, 当要创建类的实例时, 这些块就会被执行.</p> <p>代码块的位置无所谓, 写在类的最后面也会在实例化时, 先执行.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-14-10-35-57.png" alt="2020-04-14-10-35-57"></p> <p>在代码块前可以加 <code>static</code> 关键字, 来表示一个静态初始化块.</p> <p>静态初始化块会在类第一次加载的时候被执行. 一般用来对静态域进行初始化.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-14-10-37-54.png" alt="2020-04-14-10-37-54"></p> <h4 id="调用构造器时执行顺序"><a href="#调用构造器时执行顺序" class="header-anchor">#</a> 调用构造器时执行顺序</h4> <ol><li>所有的数据域初始化为默认值;</li> <li>按照在类中声明的顺序, 一次执行所有的初始化块;</li> <li>如果被执行构造器的第一行调用了另一个构造器, 那么先执行另一个构造器;</li> <li>然后再执行构造器主体;</li></ol> <h3 id="包"><a href="#包" class="header-anchor">#</a> 包</h3> <p>Java 允许使用包 package 将类组织起来;</p> <p>通过使用包可以确保类名的唯一性;</p> <p>Sun 公司简易将公司的网站域名以逆序的形式作为包名, 并且对不同的项目使用不同的子包;</p> <ul><li>🌰 例如, 我的网站叫 <code>garrikliu.com</code> 那么我的项目包名就叫 <code>com.garrikliu</code>. 我网站下有一个购物商场, 那么这个项目的包名就是 <code>com.garrikliu.mystore</code>;</li></ul> <p><strong>一个类可以使用所属包内的所有类, 以及其他包中的公共类</strong> (public class).</p> <p>通过两种方式可以访问另一个包中的公共类:</p> <p>第一种, 在每一个类名前添加完整的包名:</p> <div class="language-java extra-class"><pre class="language-java"><code>java<span class="token punctuation">.</span>time<span class="token punctuation">.</span><span class="token class-name">LocalDate</span> today <span class="token operator">=</span> java<span class="token punctuation">.</span>time<span class="token punctuation">.</span><span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>第二种, 使用 <code>import</code> 语句引入一个特定的类或者整个包. <code>import</code> 语句应该位于源文件的顶部.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 引入 util 下面的所有类</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token comment">// 引入 LocalDate 类</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time</span><span class="token punctuation">.</span><span class="token class-name">LocalDate</span><span class="token punctuation">;</span>
</code></pre></div><p>⚠️ 只能使用 <code>*</code> 匹配一个包下面的所有类, 而不能引入多个包. 例如:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> java<span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>*<span class="token punctuation">.</span>*<span class="token punctuation">;</span>
</code></pre></div><p>上面 👆 的两种写法都是不对 ❌ 的.</p> <hr> <p>如果一个包中需要使用两个同名的类, 那么只能在使用时, 在类名前加上完整的包名了.</p> <div class="language-java extra-class"><pre class="language-java"><code>java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">Date</span> deadLine <span class="token operator">=</span> <span class="token keyword">new</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span><span class="token class-name">Date</span> today <span class="token operator">=</span> <span class="token keyword">new</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="静态导入"><a href="#静态导入" class="header-anchor">#</a> 静态导入</h4> <p><code>import</code> 语句还可以导入类中的静态方法和静态域.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">java<span class="token punctuation">.</span>lang</span><span class="token punctuation">.</span><span class="token class-name">System</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>
</code></pre></div><p>上面 👆 这条语句可以导入 System 类中的所有静态方法和静态类, 使用时不用添加类名前缀.</p> <div class="language-java extra-class"><pre class="language-java"><code>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// System.out.println</span>
</code></pre></div><h4 id="把类放入包中"><a href="#把类放入包中" class="header-anchor">#</a> 把类放入包中</h4> <p>想要把一个类放入包中, 就要在类的源文件的开头, 写上包的名字, 格式如下:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>garrik<span class="token punctuation">.</span>mystore</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>不写的话, 源文件内的类就不会被放入包中, 而是放入一个默认包 default package.</p> <h3 id="文档注释"><a href="#文档注释" class="header-anchor">#</a> 文档注释</h3> <p>JDK 包含一个工具叫做 javadoc, 它可以通过源文件中的代码注释, 生成一个 HTML 文件;</p> <p>因为文档是直接通过源代码的注释生成的, 可以保证文档与代码的一致性. 分开管理的话, 很容易出现版本对不上的问题.</p> <hr> <p>默认情况下, javadoc 工具从以下几个部分提取信息:</p> <ul><li>包;</li> <li>公共类和接口;</li> <li>公共 public 和受保护 protected 的构造器和方法;</li> <li>公共 public 和受保护 protected 的域 (属性);</li></ul> <p>应该为以上 👆 几个部分编写注释.</p> <p>注释以 <code>/**</code> 开始, 以 <code>*/</code> 结束.</p> <p><code>/** ... */</code> 中间内容为<strong>自由格式文本</strong> free-form text:</p> <ul><li>自由格式文本中, 可以使用 HTML 元素;</li> <li>例如 <code>&lt;em&gt;...&lt;/em&gt;</code>, <code>&lt;strong&gt;...&lt;/strong&gt;</code>, <code>&lt;img ... /&gt;</code> 等;</li> <li>但是有些元素, 例如 <code>&lt;h1&gt;</code> 或者 <code>&lt;hr&gt;</code> 它们会与文档的格式产生冲突, 具体规则可以单独去查阅;</li></ul> <h4 id="类注释"><a href="#类注释" class="header-anchor">#</a> 类注释</h4> <p>在类的定义之前, 写入类注释.</p> <p>📒 注释结构参考:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* 类 &lt;code&gt;{类名称}&lt;/code&gt; {此类功能描述}
*
* @author {作者}
* @version {版本}
*/</span>
</code></pre></div><p>🌰 示例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* Class &lt;code&gt;Object&lt;/code&gt; is the root of the class hierarchy.
* Every class has &lt;code&gt;Object&lt;/code&gt; as a superclass. All objects,
* including arrays, implement the methods of this class.
*
* @author xxxxxxxxx
* @version 1.61
*/</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Object</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>⚠️ 没必要在每一行前面都写 <code>*</code> 星号, 上面的注释也可以写成:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
  Class &lt;code&gt;Object&lt;/code&gt; is the root of the class hierarchy.
  Every class has &lt;code&gt;Object&lt;/code&gt; as a superclass. All objects,
  including arrays, implement the methods of this class.

  @author xxxxxxxxx
  @version 1.61
*/</span>
</code></pre></div><p>只不过现在大多 IDE 都会自动加星号, 开发时不用管太多.</p> <h4 id="方法注释"><a href="#方法注释" class="header-anchor">#</a> 方法注释</h4> <p>在每个方法之上都要写方法的注释.<br>
可以使用如下标记来帮助描述方法相关信息:</p> <ul><li><code>@param</code> 变量描述, 用以说明一个方法的参数;</li> <li><code>@return</code> 返回值描述, 说明一个方法的返回值;</li> <li><code>@throws</code> 异常描述, 用于表示这个方法有可能抛出异常;</li></ul> <p>📒 注释结构参考:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* {方法的功能描述}
*
* @param {参数名} {参数说明}
* @return {返回参数说明}
* @exception {说明在某情况下,将发生什么异常}
*/</span>
</code></pre></div><p>🌰 示例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* Returns a new string that is a substring of this string. The
* substring begins with the character at the specified index and
* extends to the end of this string.
*
* Examples:
* &lt;blockquote&gt;&lt;pre&gt;
* &quot;unhappy&quot;.substring(2) returns &quot;happy&quot;
* &quot;Harbison&quot;.substring(3) returns &quot;bison&quot;
* &quot;emptiness&quot;.substring(9) returns &quot;&quot; (an empty string)
* &lt;/pre&gt;&lt;/blockquote&gt;
*
* @param beginIndex the beginning index, inclusive.
* @return the specified substring.
* @exception IndexOutOfBoundsException if
* &lt;code&gt;beginIndex&lt;/code&gt; is negative or larger than the
* length of this &lt;code&gt;String&lt;/code&gt; object.
*/</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">substring</span><span class="token punctuation">(</span><span class="token keyword">int</span> beginIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">substring</span><span class="token punctuation">(</span>beginIndex<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="域注释"><a href="#域注释" class="header-anchor">#</a> 域注释</h4> <p>只需要对公共域 (公共属性) 编写注释.</p> <p>通常类中的公共域, 同时也是静态常量, 一般来说类中的属性都是私有的, 很少见公有的.</p> <p>📒 注释结构参考:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* {此值是用来存储/记录什么的}
*/</span>

<span class="token keyword">private</span> <span class="token class-name">String</span> str<span class="token punctuation">;</span>
</code></pre></div><p>🌰 示例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* The value is used for character storage.
*/</span>
<span class="token keyword">private</span> <span class="token keyword">char</span> value<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="通用标记"><a href="#通用标记" class="header-anchor">#</a> 通用标记</h4> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-14-21-07-37.png" alt="2020-04-14-21-07-37"></p> <h4 id="注释规范"><a href="#注释规范" class="header-anchor">#</a> 注释规范</h4> <blockquote><p>下列规范参考自 &lt;阿里巴巴 Java 开发手册 v1.5.0&gt;</p></blockquote> <ul><li>类、类属性、类方法必须使用 Javadoc 规范注释;</li> <li>所有的抽象方法（包括接口中的方法）必须要用 Javadoc 注释、除了返回值、参数、异常说明外，还必须指出该方法做什么事情，实现什么功能;</li> <li>所有的类都必须添加创建者 <code>@author</code>;</li> <li>方法内部单行注释，在被注释语句上方另起一行，使用 <code>//</code> 注释。方法内部多行注释 使用 <code>/* */</code> 注释，注意与代码对齐;</li> <li>所有的枚举类型字段必须要有注释，说明每个数据项的用途;</li> <li>代码修改的同时，注释也要进行相应的修改;</li> <li>注释掉代码时, 需要在上方给出详细说明，而不是简单地注释掉。如果代码无用，则删除;
<ul><li>代码被注释掉有两种可能性：1. 后续会恢复此段代码逻辑。2. 永久不用。前者如果没有备注信息，难以知晓注释动机。后者建议直接删掉;</li></ul></li> <li>对于注释的要求：
<ul><li>能够准确反映设计思想和代码逻辑；</li> <li>能够描述业务含义，使别的程序员能够迅速了解到代码背后的信息;</li></ul></li> <li>好的命名、代码结构是自解释的，注释力求精简准确、表达到位;</li> <li>语义清晰的代码不需要额外的注释;</li></ul> <h2 id="继承"><a href="#继承" class="header-anchor">#</a> 继承</h2> <h3 id="继承基础"><a href="#继承基础" class="header-anchor">#</a> 继承基础</h3> <p>在 Java 中通过关键字 <code>extends</code> 来让一个类继承自另一个类.</p> <p>继承表现了类与类之间的 &quot;is-a&quot; 关系.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Manager</span> <span class="token keyword">extends</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>被继承的类, 称为 &quot;<strong>超类</strong> superclass&quot;, &quot;<strong>基类</strong> base class&quot;, 或 &quot;<strong>父类</strong> parent class.</p> <p>新创建的类叫做 &quot;<strong>子类</strong> subclass&quot;, &quot;<strong>派生类</strong> derived class&quot;, 或 &quot;<strong>孩子类</strong> child class&quot;</p> <p><strong>子类会继承父类所有的非 private 的属性和方法</strong>.</p> <p>在子类中可以添加新的域名, 方法, 或者覆盖超类的方法, 但是不能够删除从超类继承来的方法或者域.</p> <p>在 Java 中, 并不支持多继承, 也就是一个类派生自多个类, 这是不可以的.</p> <h4 id="重写"><a href="#重写" class="header-anchor">#</a> 重写</h4> <p>通过重写子类可以根据自己的需要, 重新编写从父类继承来的方法.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;动物可以移动&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;狗可以跑和走&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>方法的重写规则:</p> <ul><li>参数列表必须完全与被重写方法的相同;</li> <li>返回类型与被重写方法的返回类型可以不相同，但是必须是父类被重写方法原返回值的派生类;</li> <li>访问权限不能比父类中被重写的方法的访问权限更低。例如：如果父类的一个方法被声明为 public，那么在子类中重写该方法就不能声明为 protected;</li> <li>声明为 final 的方法不能被重写;</li> <li>声明为 static 的方法不能被重写，但是能够被再次声明;</li> <li>子类和父类在同一个包中，那么子类可以重写父类所有方法，除了声明为 private 和 final 的方法;</li> <li>子类和父类不在同一个包中，那么子类只能够重写父类的声明为 public 和 protected 的非 final 方法;</li> <li>重写的方法能够抛出任何非强制异常，无论被重写的方法是否抛出异常, 重写后的方法不能抛出新的强制性异常，或者比被重写方法声明的更广泛的强制性异常，反之则可以;</li> <li>构造方法不能被重写;</li></ul> <h4 id="super"><a href="#super" class="header-anchor">#</a> super</h4> <p>在子类中, 通过关键字 super:</p> <ul><li>可以用来访问直接父类的实例域;</li> <li>可以用来调用父类的方法;</li> <li>使用 <code>super()</code> 可以调用父类的构造函数;</li></ul> <p>🌰 使用示例:</p> <p>为了简化子类的构造函数, 在子类中可以直接调用父类的构造函数.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Emp</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">float</span> salary<span class="token punctuation">;</span>

    <span class="token class-name">Emp</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">float</span> salary<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// reusing parent constructor</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>id <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">TestSuper5</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Emp</span> e1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Emp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;ankit&quot;</span><span class="token punctuation">,</span> <span class="token number">45000f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e1<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>⚠️ 注意, super 和 this 不是相同的概念. super 不是一个对象的引用, 不能将 super 赋给另一个对象变量, 它只是一个指示编译器访问超类成员的关键字.</p> <h4 id="继承层次"><a href="#继承层次" class="header-anchor">#</a> 继承层次</h4> <p>由一个公共超类派生出来的所有类的集合被称为<strong>继承层次</strong>（inheritance hierarchy).</p> <p>在继承层次中从某个特定的类到其祖先的路径被称为该类的<strong>继承链</strong> (inheritance chain).</p> <p>通常，一个祖先类可以拥有多个子孙继承链.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-14-23-25-17.png" alt="2020-04-14-23-25-17"></p> <h4 id="强制类型转换-2"><a href="#强制类型转换-2" class="header-anchor">#</a> 强制类型转换</h4> <p>在 Java 中 每个对象变量都属于一个类型 类型描述了这个变量能够引用的对象类型.</p> <p>可以将一个子类实例的引用赋值给一个超类变量, 但如果想将超类实例的引用赋值给子类变量, 必须要先进行<strong>类型转换</strong>.</p> <p>在保存对象引用的变量名前, 加一个圆括号 <strong><code>( )</code></strong> 将目标类名括起来, 可以将这个对象实例类型转换成目标类型.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Manager</span> boss <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token class-name">Manager</span> <span class="token punctuation">)</span> staff<span class="token punctuation">;</span>
</code></pre></div><p>只能对继承链上的类, 进行从上到下的类型转换.</p> <p>如果类型转换失败, 会产生一个 ClassCastException 异常, 为了防止异常的发生, 在类型转换之前, 需要先查看是否能够转换成功.</p> <p>通过 <code>instanceof</code> 操作符可以验证它左边的对象实例是否是它右边的类 (可以是超类) 的实例，返回 true / false.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">if</span><span class="token punctuation">(</span>staff <span class="token keyword">instanceof</span> <span class="token class-name">Manager</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  boss <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Manager</span><span class="token punctuation">)</span> staff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="阻止继承-final"><a href="#阻止继承-final" class="header-anchor">#</a> 阻止继承 final</h4> <p>通过 <code>final</code> 修饰符可以防止类被继承.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Executive</span> <span class="token keyword">extends</span> <span class="token class-name">Manager</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面 👆 的 Executive 类就不可以被其他类继承了.</p> <p>类中特定的方法可以使用 <code>final</code> 修饰符, 阻止这个方法被子类重写覆盖.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="抽象类-abstract"><a href="#抽象类-abstract" class="header-anchor">#</a> 抽象类 abstract</h4> <p>如果你想设计这样一个类，该类包含一个特别的成员方法，该方法的具体实现由它的子类确定，那么你可以在父类中声明该方法为<strong>抽象方法</strong>:</p> <ul><li>通过 <code>abstract</code> 关键字来声明抽象方法;</li> <li>抽象方法只包含一个方法名，而没有方法体;</li></ul> <p>如果一个类包含抽象方法，那么该类必须是<strong>抽象类</strong>:</p> <ul><li>通过 <code>abstract</code> 关键字来声明抽象类;</li> <li>抽象类并不能够被实例化, 要想使用它, 必须要被其他类继承;</li> <li>任何子类必须重写父类的抽象方法，或者声明自身为抽象类;</li> <li>反正, 最后所有的抽象方法都必须有子类实现;</li> <li>抽象类中不一定包含抽象方法，但是有抽象方法的类必定是抽象类;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span>
<span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> address<span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token keyword">int</span> number<span class="token punctuation">;</span>

   <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">double</span> <span class="token function">computePay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Salary</span> <span class="token keyword">extends</span> <span class="token class-name">Employee</span>
<span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token keyword">double</span> salary<span class="token punctuation">;</span> <span class="token comment">// Annual salary</span>

   <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">computePay</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Computing salary pay for &quot;</span> <span class="token operator">+</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> salary<span class="token operator">/</span><span class="token number">52</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="受保护访问-protected"><a href="#受保护访问-protected" class="header-anchor">#</a> 受保护访问 protected</h4> <p>父类中声明为 <code>private</code> 的成员即使是子类也获取不到.
有时候希望有些内容允许被子类访问, 那么需要将这些成员成名为 <code>protected</code>.</p> <div class="language-java extra-class"><pre class="language-java"><code>`<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>

    <span class="token keyword">protected</span> <span class="token class-name">String</span> protect <span class="token operator">=</span> <span class="token string">&quot;protect field&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;i am parent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Java 中的受保护部分对所有子类及同一个包中的所有其他类都可见.</p> <p>若子类与基类不在同一包中，那么在子类中，子类实例可以访问其从基类继承而来的 <code>protected</code> 方法，而不能访问基类实例的 <code>protected</code> 方法。</p> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token keyword">package</span> a<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">X</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">CloneNotSupportedException</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> b<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Y</span> <span class="token keyword">extends</span> <span class="token class-name">X</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token class-name">X</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       x<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Compile Error</span>

       <span class="token class-name">Y</span> y <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       y<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Complie OK</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>在上面 👆 的代码中, X 继承自 Y, 但是他们处于不同的 paackage;</li> <li>在 Y 的 <code>main</code> 方法中, 获取不到 X 类型实例的 <code>clone</code> 方法, 所以 <code>x.clone()</code> 失败;</li> <li>但是 Y 类型继承来的 <code>clone</code> 方法可以访问到, 所以 <code>y.clone()</code> 调用成功;</li></ul> <h3 id="object-类"><a href="#object-类" class="header-anchor">#</a> Object 类</h3> <p>Object 类是 Java 中所有类的始祖, 在 Java 中每个类都是由它扩展来的.</p> <p>如果没有明确指出一个类的超类, 那么默认 Object 就是这个类的超类.</p> <p>Object 类自身有很多方法, 下面 👇 介绍一些:</p> <h4 id="equals"><a href="#equals" class="header-anchor">#</a> equals</h4> <p>Object 类中的 <code>equals</code> 方法默认判断两个实例的地址是否相同.</p> <p>在扩展出的类中可以重写 <code>equals</code> 方法, 来满足各自的需求.</p> <p>🌰 例如 String 类中的 <code>equals</code> 方法不但可以判断地址是否相同, 还可以判断两个字符串内容是否相同:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token class-name">Str1</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;runoob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token class-name">Str2</span> <span class="token operator">=</span> <span class="token class-name">Str1</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token class-name">Str3</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;runoob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> retVal<span class="token punctuation">;</span>

    retVal <span class="token operator">=</span> <span class="token class-name">Str1</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span> <span class="token class-name">Str2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
    retVal <span class="token operator">=</span> <span class="token class-name">Str1</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span> <span class="token class-name">Str3</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="hashcode"><a href="#hashcode" class="header-anchor">#</a> hashCode</h4> <p><code>hashCode</code> 方法返回对象的哈希值, 主要使用在哈希表中.</p> <p>计算出哈希码的通用约定如下:</p> <ul><li>在 java 程序执行过程中，在一个对象没有被改变的前提下，无论这个对象被调用多少次，hashCode 方法都会返回相同的整数值;</li> <li>如果 2 个对象使用 equals 方法进行比较并且相同的话，那么这 2 个对象的 hashCode 方法的值也必须相等;</li> <li>如果根据 equals 方法，得到两个对象不相等，但这 2 个对象的 hashCode 值允许相同, 但不推荐;</li></ul> <p>可以根据自身需求重写 <code>hashCode</code> 方法:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> author<span class="token punctuation">;</span>


  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token number">37</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> code <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// Use title</span>
    code <span class="token operator">=</span> <span class="token punctuation">(</span>title <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> title<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hash <span class="token operator">=</span> hash <span class="token operator">*</span> <span class="token number">59</span> <span class="token operator">+</span> code<span class="token punctuation">;</span>

    <span class="token comment">// Use author</span>
    code <span class="token operator">=</span> <span class="token punctuation">(</span>author <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> author<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hash <span class="token operator">=</span> hash <span class="token operator">*</span> <span class="token number">59</span> <span class="token operator">+</span> code<span class="token punctuation">;</span>

    <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="getclass"><a href="#getclass" class="header-anchor">#</a> getClass</h4> <p><code>getClass</code> 方法是一个 <code>final</code> 方法，不允许子类重写.</p> <p>函数返回隐式参数对象实例所属类型的 Class 对象.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">;</span>
s<span class="token punctuation">.</span>getClass <span class="token operator">==</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token comment">// true</span>
</code></pre></div><h4 id="tostring"><a href="#tostring" class="header-anchor">#</a> toString</h4> <p><code>toString</code> 方法返冋描述该对象值的字符串.</p> <p>Object 对象的默认实现，即输出类的名字@实例的哈希码的 16 进制.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;@&quot;</span> <span class="token operator">+</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">toHexString</span><span class="token punctuation">(</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>一般来讲, 建议所有的 Object 子类都重写 <code>toString</code> 方法.</p> <p>🌰 例如:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> gender<span class="token punctuation">;</span>

  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;ID: &quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot; | Name: &quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot; | Gender: &quot;</span> <span class="token operator">+</span> gender<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>只要对象与一个字符串通过操作符 <code>+</code> 连接起来, Java 编译就会自动地调用 <code>toString</code> 方法 以便获得这个对象的字符串描述.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Point</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token string">&quot;The current position is &quot;</span> <span class="token operator">+</span> p<span class="token punctuation">;</span>
</code></pre></div><p>当将一个对象实例传入 <code>System.out.print()</code> 方法时, 也会调用这个实例的 <code>toString</code> 方法.</p> <h2 id="枚举"><a href="#枚举" class="header-anchor">#</a> 枚举</h2> <p>在现实生活中，经常会有一个变量只有固定几种取值的情况. 例如季节，它只有春夏秋冬 4 个可能的值, 或者一周七天的名称.</p> <p>在 Java 中可以通过声明<strong>枚举类</strong>, 来表现这种<strong>取值是由一组有限且固定的常量组成的属性</strong>.</p> <h3 id="声明枚举"><a href="#声明枚举" class="header-anchor">#</a> 声明枚举</h3> <ul><li>用 <code>enum</code> 关键字声明枚举类型. 枚举类型都是 Enum 类的子类;</li> <li>在枚举类的第一行, 写下所有的枚举常量;</li> <li>枚举类中的所有的枚举常量都是 <code>public static final</code> 的;</li> <li>枚举常量推荐全部用大写字母命名, 彼此之间用逗号分隔;</li> <li>非抽象的枚举类不能再派生子类;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 定义一个星期的枚举类</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">WeekEnum</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在第一行显式地列出7个枚举实例(枚举值)，系统会自动添加 public static final 修饰</span>
    SUNDAY<span class="token punctuation">,</span> MONDAY<span class="token punctuation">,</span> TUESDAY<span class="token punctuation">,</span> WEDNESDAY<span class="token punctuation">,</span> THURSDAY<span class="token punctuation">,</span> FRIDAY<span class="token punctuation">,</span> SATURDAY<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用时, 不用 <code>new</code> 创建实例, 直接使用定义的枚举类型就可以.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">WeekEnum</span> day <span class="token operator">=</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">.</span>SUNDAY<span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>day <span class="token operator">==</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">.</span>SUNDAY<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token comment">// 因为 day 保存的引用就是 WeekEnum.SUNDAY, 所以可以用 ==</span>
</code></pre></div><p>上面 👆 的代码等效于下面的代码:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WeekEnum</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MONDAY <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> TUESDAY<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> WEDNESDAY<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> THURSDAY<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> FRIDAY<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> SATURDAY<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> SUNDAY<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样写首先很不简洁, 而且容易出错. 假如把其中几个属性的值写成一样的, 编译器也不会提出任何警告，但是会造成使用时出现 BUG.</p> <h3 id="枚举类的实现原理"><a href="#枚举类的实现原理" class="header-anchor">#</a> 枚举类的实现原理</h3> <p>在使用关键字 <code>enum</code> 创建枚举类型并编译后，编译器会为我们生成一个相关的类，这个类继承了 Java API 中的 <code>java.lang.Enum</code> 类.</p> <p>上面 👆 的枚举类型代码, 经过反编译后会变成:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">WeekEnum</span> <span class="token keyword">extends</span> <span class="token class-name">Enum</span>
<span class="token punctuation">{</span>
  <span class="token comment">// 编译器为我们添加的静态的 values() 方法</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">WeekEnum</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>$VALUES<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 编译器为我们添加的静态的 valueOf() 方法，注意间接调用了 Enum 类的 valueOf 方法</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">WeekEnum</span> <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">WeekEnum</span><span class="token punctuation">)</span><span class="token class-name">Enum</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>com<span class="token operator">/</span>zejian<span class="token operator">/</span>enumdemo<span class="token operator">/</span><span class="token class-name">WeekEnum</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 私有构造函数</span>
  <span class="token keyword">private</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 前面定义的 7 种枚举实例</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">WeekEnum</span> MONDAY<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">WeekEnum</span> TUESDAY<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">WeekEnum</span> WEDNESDAY<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">WeekEnum</span> THURSDAY<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">WeekEnum</span> FRIDAY<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">WeekEnum</span> SATURDAY<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">WeekEnum</span> SUNDAY<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">WeekEnum</span> $VALUES<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// 实例化枚举实例</span>
    MONDAY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">(</span><span class="token string">&quot;MONDAY&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    TUESDAY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">(</span><span class="token string">&quot;TUESDAY&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    WEDNESDAY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">(</span><span class="token string">&quot;WEDNESDAY&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    THURSDAY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">(</span><span class="token string">&quot;THURSDAY&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    FRIDAY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">(</span><span class="token string">&quot;FRIDAY&quot;</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    SATURDAY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">(</span><span class="token string">&quot;SATURDAY&quot;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    SUNDAY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">(</span><span class="token string">&quot;SUNDAY&quot;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    $VALUES <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WeekEnum</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
      MONDAY<span class="token punctuation">,</span> TUESDAY<span class="token punctuation">,</span> WEDNESDAY<span class="token punctuation">,</span> THURSDAY<span class="token punctuation">,</span> FRIDAY<span class="token punctuation">,</span> SATURDAY<span class="token punctuation">,</span> SUNDAY
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>可以看到, 编译器还帮助我们生成了 7 个 WeekEnum 类型的实例对象. 分别对应枚举中定义的 7 个日期常量;</li> <li>也就是说, 在枚举类中定义的枚举常量, 最后会被创建成枚举类型的实例对象;</li> <li>在使用枚举常量时, <code>WeekEnum.SUNDAY</code> 访问的是 WeekEnum 类型的 <code>public static final WeekEnum SUNDAY</code> 静态常量;</li></ul> <h3 id="自定义枚举类的构造函数"><a href="#自定义枚举类的构造函数" class="header-anchor">#</a> 自定义枚举类的构造函数</h3> <ul><li>我们可以自定义枚举类的构造函数;</li> <li>但是构造函数必须是 <code>private</code> 的;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Level</span> <span class="token punctuation">{</span>
  <span class="token function">LOW</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">MEDIUM</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">HIGH</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">URGENT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Declare an instance variable</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> levelValue<span class="token punctuation">;</span>

  <span class="token comment">// Declare a private constructor</span>
  <span class="token keyword">private</span> <span class="token class-name">Level</span><span class="token punctuation">(</span><span class="token keyword">int</span> levelValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>levelValue <span class="token operator">=</span> levelValue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getLevelValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> levelValue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>上面代码声明了一个实例域 <code>levelValue</code>, 还定义了一个私有构造函数，它接受一个 int 参数;</li> <li>在声明枚举常量时, 把常量想要的参数值传入进去, 如 <code>LOW(30)</code>;</li> <li>在实例化枚举常量时, 自定义的私有构造函数会被调用, 传入的参数值会存储在 <code>levelValue</code> 实例属性中;</li> <li>里面还定义了一个公共方法 <code>getLevelValue()</code>, 通过它可以获取到枚举常量实例的 <code>levelValue</code> 属性值;</li></ul> <h3 id="枚举类常用方法"><a href="#枚举类常用方法" class="header-anchor">#</a> 枚举类常用方法</h3> <p>因为枚举类继承自 Enum 类, 所以它也继承来了很多方法, 下面 👇 是一些常用的:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-15-19-43-05.png" alt="2020-04-15-19-43-05"></p> <ul><li><code>ordinal()</code> 方法，该方法获取的是枚举变量在枚举类中声明的顺序, 下标从 0 开始;</li> <li><code>compareTo(E o)</code> 方法则是比较枚举的大小，注意其内部实现是根据每个枚举的 ordinal 值大小进行比较的;</li> <li><code>name()</code> 方法与 <code>toString()</code> 几乎是等同的，都是输出变量的字符串形式;</li></ul> <hr> <p>上面讲解枚举原理时, 可以看到枚举类被编译时, 编译器给它生成了 <code>values()</code> 和 <code>valueOf(String name)</code> 这两个静态方法.</p> <ul><li><code>values()</code> 以数组形式返回枚举类型的所有成员;</li> <li><code>valueOf()</code> 通过字符串获取同名的枚举实例;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">enum</span> <span class="token class-name">Signal</span> <span class="token punctuation">{</span>
    GREEN<span class="token punctuation">,</span> YELLOW<span class="token punctuation">,</span> RED<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">Signal</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 打印所有的枚举常量</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Signal</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestEnum</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">enum</span> GENDER <span class="token punctuation">{</span>
      MALE<span class="token punctuation">,</span> FEMALE<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>GENDER<span class="token punctuation">.</span>MALE <span class="token operator">==</span> GENDER<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token string">&quot;MALE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="接口"><a href="#接口" class="header-anchor">#</a> 接口</h2> <h3 id="什么是接口"><a href="#什么是接口" class="header-anchor">#</a> 什么是接口</h3> <p>在 Java 程序设计中，接口不是类而是对类的一组需求描述，这些类要遵从接口描述的统一格式进行定义。</p> <h4 id="声明接口"><a href="#声明接口" class="header-anchor">#</a> 声明接口</h4> <ul><li>使用 <code>interface</code> 关键字定义接口;</li> <li>接口中所有的方法都属于 <code>public</code>, 因此声明方法时不需要再提供关键字 <code>public</code>;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Moveable</span> <span class="token punctuation">{</span>
  <span class="token keyword">void</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="接口实现类"><a href="#接口实现类" class="header-anchor">#</a> 接口实现类</h4> <ul><li>要将类声明为实现了某个接口, 需要使用 <code>implements</code> 关键字;</li> <li>实现类必须对接口中的所有方法给进行定义;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token keyword">implements</span> <span class="token class-name">Moveable</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> positionX<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> positionY<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    positionX <span class="token operator">=</span> x<span class="token punctuation">;</span>
    positionY <span class="token operator">=</span> y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="常量属性"><a href="#常量属性" class="header-anchor">#</a> 常量属性</h4> <ul><li>接口中可以包含常量属性;</li> <li>接口中所有的属性都被自动设置为 <code>public static final</code> 所以定义时也不需要写这些关键字;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Moveable</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> DISTANCE_LIMIT <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="接口扩展"><a href="#接口扩展" class="header-anchor">#</a> 接口扩展</h4> <ul><li>接口也可以通过 <code>extends</code> 进行扩展;</li> <li>可以从具有较高通用性的接口, 扩展出较高专用性的接口;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Powered</span> <span class="token keyword">extends</span> <span class="token class-name">Moveable</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> <span class="token function">milesPerGallon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="接口类型变量"><a href="#接口类型变量" class="header-anchor">#</a> 接口类型变量</h4> <ul><li>接口并不可以被实例化, 但是可以声明接口类型的变量;</li> <li>接口类型变量必须引用一个接口实现类的实例对象;</li> <li>可以使用 <code>instanceof</code> 检查一个实例对象是否属于接口实现类;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Moveable</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>m <span class="token keyword">instanceof</span> <span class="token class-name">Moveable</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="接口-vs-抽象类"><a href="#接口-vs-抽象类" class="header-anchor">#</a> 接口 vs 抽象类</h4> <p>为什么不使用抽象类, 而非要使用接口?</p> <p>前面说过, Java 不支持多继承, 一个类只能扩展自另一个类, 不可以是多个类.</p> <p>但是一个类可以同时实现多个接口, 接口之间用逗号隔开:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">BlackBear</span> <span class="token keyword">implements</span> <span class="token class-name">OnEarth</span><span class="token punctuation">,</span> <span class="token class-name">NearAttack</span><span class="token punctuation">,</span> <span class="token class-name">FarAttack</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="静态方法"><a href="#静态方法" class="header-anchor">#</a> 静态方法</h4> <ul><li>在 Java SE 8 版本之中, 允许在接口中添加静态方法.</li> <li>这么做可以把接口作为一个单例对象来使用, 而不必非要创建一个实现类, 然后再创建类实例.</li> <li>但是在接口中添加方法也背离了将接口作为抽象规范的初衷.</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-15-21-12-24.png" alt="2020-04-15-21-12-24"></p> <h4 id="默认方法"><a href="#默认方法" class="header-anchor">#</a> 默认方法</h4> <ul><li>可以用 <code>default</code> 修饰符来给接口中的方法提供默认实现.</li> <li>在现实类中如果没有给方法提供新的实现, 那么就使用默认实现;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MouseListener</span> <span class="token punctuation">{</span>
  <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">mouseClicked</span><span class="token punctuation">(</span><span class="token class-name">MouseEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;没有实现点击事件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="接口使用案例"><a href="#接口使用案例" class="header-anchor">#</a> 接口使用案例</h3> <h4 id="comparator-接口"><a href="#comparator-接口" class="header-anchor">#</a> Comparator 接口</h4> <h4 id="cloneable-接口"><a href="#cloneable-接口" class="header-anchor">#</a> Cloneable 接口</h4> <h2 id="内部类"><a href="#内部类" class="header-anchor">#</a> 内部类</h2> <p><strong>内部类</strong> inner class 是定义在另外一个类中的类.</p> <h3 id="声明内部类"><a href="#声明内部类" class="header-anchor">#</a> 声明内部类</h3> <ul><li>通过在一个类的内部定义另一个来声明内部类;</li> <li>内部类方法可以访问该类定义所在的作用域中的数据，包括私有的数据;</li> <li>内部类所在的类, 被称为 &quot;外部类&quot; outer class;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TalkingClock</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> interval<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">boolean</span> beep<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">TalkingClock</span><span class="token punctuation">(</span><span class="token keyword">int</span> interval<span class="token punctuation">,</span> <span class="token keyword">boolean</span> beep<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ActionListener</span> listener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TimePrinter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Timer</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span>interval<span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 内部类</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TimePrinter</span> <span class="token keyword">implements</span> <span class="token class-name">ActionListener</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">actionPerformed</span><span class="token punctuation">(</span><span class="token class-name">ActionEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;At the tone, the time is &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>beep<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Toolkit</span><span class="token punctuation">.</span><span class="token function">getDefaultToolkit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">beep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="局部内部类"><a href="#局部内部类" class="header-anchor">#</a> 局部内部类</h3> <p>上面 👆 的内部类使用示例中, 只在 <code>start()</code> 方法中使用了 TimePrinter 这个类.</p> <p>这种情况下, 我们可以把内部类定义在准备使用它的方法中. 这被称为<strong>局部内部类</strong>.</p> <ul><li>局部类不使用 public 和 private 这些修饰符, 因为除了局部类所在方法, 外部不能够访问到它;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">class</span> <span class="token class-name">TimePrinter</span> <span class="token keyword">implements</span> <span class="token class-name">ActionListener</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">actionPerformed</span><span class="token punctuation">(</span><span class="token class-name">ActionEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;At the tone, the time is &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>beep<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Toolkit</span><span class="token punctuation">.</span><span class="token function">getDefaultToolkit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">beep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">ActionListener</span> listener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TimePrinter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">Timer</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span>interval<span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
  t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="匿名内部类"><a href="#匿名内部类" class="header-anchor">#</a> 匿名内部类</h3> <p>如果只需要创建一个内部使用的类实例, 没有必要从头命名一个内部类, 然后再创建实例, 可以直接使用<strong>匿名内部类</strong> anonymous inner class.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token keyword">int</span> interval<span class="token punctuation">,</span> boolena beep<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">ActionListener</span> listener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActionListener</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">actionPerformed</span><span class="token punctuation">(</span><span class="token class-name">ActionEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;At the tone, the time is &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>beep<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Toolkit</span><span class="token punctuation">.</span><span class="token function">getDefaultToolkit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">beep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">Timer</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timer</span><span class="token punctuation">(</span>interval<span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
  t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面 👆 代码的意思是, 创建一个实现了 ActionListener 接口的类的实例对象;</p> <p>创建匿名内部的类的格式通常如下:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-16-15-57-12.png" alt="2020-04-16-15-57-12"></p> <ul><li><code>new</code> 运算符后面的不是新创建的类名, 而是 SuperType 的名字;</li> <li>SuperType 既可以是接口, 也可以是类;</li> <li>如果使用接口名称，则匿名类实现接口。如果使用类名，则匿名类继承自其它类;</li> <li>因为构造器的名字必须与类名相同, 匿名类没有名字, 所以不能给它写构造函数;</li> <li>只有 <code>new</code> 运算符后面是现有的类名时, 才可能需要传入参数, 参数会传递到现有类的构造函数之中;</li></ul> <p>🌰 下面 👇 使用匿名类来创建迭代器:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">Iterator</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> titleList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addTitle</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    titleList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeTitle</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    titleList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">titleIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// An anonymous class</span>
    <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

      <span class="token annotation punctuation">@Override</span>
      <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> titleList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token annotation punctuation">@Override</span>
      <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> titleList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>count<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// Anonymous inner class ends here</span>

    <span class="token keyword">return</span> iterator<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="静态内部类"><a href="#静态内部类" class="header-anchor">#</a> 静态内部类</h3> <p>有的时候, 你可能并不需要在内部类中引用外部类对象, 那么你可以把内部类声明为静态的.</p> <p>静态成员类可以声明为 public，protected，package-level 或 private，以限制其在所在类之外的可访问性;</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
  <span class="token comment">// Static member class</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token punctuation">{</span>
    <span class="token comment">// Body for class B goes here</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用静态类:</p> <ul><li>静态成员类内部可以访问, 其所在的类的静态成员, 包括私有静态成员;</li> <li>静态类所在的外部类也可以作为一个, 在所在包 package 之内的额外的命名空间;</li></ul> <p>🌰 下面 👇 代码展示了静态类使用示例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token class-name">Tire</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token class-name">Tire</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token class-name">Tire</span> m2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token class-name">Tire</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token class-name">Keyboard</span> k <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token class-name">Keyboard</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token class-name">Keyboard</span> k1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token class-name">Keyboard</span><span class="token punctuation">(</span><span class="token number">142</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>k1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
  <span class="token comment">// Static member class - Monitor</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Tire</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Tire</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>size <span class="token operator">=</span> size<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">&quot;Monitor   - Size:&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>size <span class="token operator">+</span> <span class="token string">&quot;  inch&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Static member class - Keyboard</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Keyboard</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> keys<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Keyboard</span><span class="token punctuation">(</span><span class="token keyword">int</span> keys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>keys <span class="token operator">=</span> keys<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">&quot;Keyboard  - Keys:&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keys<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Monitor   - Size:17  inch</span>
<span class="token comment">// Monitor   - Size:19  inch</span>
<span class="token comment">// Keyboard  - Keys:122</span>
<span class="token comment">// Keyboard  - Keys:142</span>
</code></pre></div><h2 id="lambda-表达式"><a href="#lambda-表达式" class="header-anchor">#</a> lambda 表达式</h2> <h3 id="什么是-lambda-表达式"><a href="#什么是-lambda-表达式" class="header-anchor">#</a> 什么是 lambda 表达式</h3> <ul><li>在 Java 8 中引入了新特性 Lambda 表达式;</li> <li>Lambda 表达式的主要作用就是<strong>简化部分匿名内部类的写法</strong>;</li> <li>在使用匿名内部类时, 我们创建了一个实现某个接口的没有名字的类的实例对象, 对象可以被传递给它人, 并在某个时间点被调用;</li> <li>但是匿名内部类的写法并不简洁, 对于<strong>只有一个抽象方法的接口</strong>, 创建这种接口的匿名内部类对象时, 可以用 Lambda 表达式代替;</li> <li>只有一个抽象方法的接口叫做<strong>函数式接口</strong>;</li> <li><mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="2.262ex" viewBox="0 -750 600 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="TeXAtom"><g data-mml-node="mo"><text data-variant="normal" transform="matrix(1 0 0 -1 0 0)" font-size="884px" font-family="serif">λ</text></g></g></g></g></svg></mjx-container> 表达式在数学中的意思是, 带有参数变量的表达式;</li> <li>可以把 Lambda 表达式看作一个函数, 而不是一个对象;</li></ul> <p>Lambda 表达式就是一个可以传递的代码块, 格式如下 👇:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> expression

<span class="token punctuation">(</span>parameters<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
  statements<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>不需要声明参数类型，编译器可以统一识别参数值;</li> <li>只有一个参数时可以省略圆括号;</li> <li>如果主体包含了一个语句，就不需要使用大括号;</li> <li>如果主体只有一个表达式返回值则编译器会自动返回值，大括号需要指定明表达式返回了一个数值;</li></ul> <p>下面 👇 是一些 🌰 例子:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 1. 不需要参数,返回值为 5</span>
<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token number">5</span>

<span class="token comment">// 2. 接收一个参数 (数字类型), 返回其 2 倍的值</span>
x <span class="token operator">-&gt;</span> <span class="token number">2</span> <span class="token operator">*</span> x

<span class="token comment">// 3. 接受 2 个参数 (数字), 并返回他们的差值</span>
<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x – y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 4. 接收 2 个 int 型整数, 返回他们的和</span>
<span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> x <span class="token operator">+</span> y

<span class="token comment">// 5. 接受一个 string 对象, 并在控制台打印</span>
<span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
</code></pre></div><p>下面 👇 是用 Lambda 表达式替换匿名内部类的例子:</p> <ul><li>假如有一个只有一个方法的函数式接口 Runnable:</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>使用匿名内部类去实现这个接口的类实例, 代码如下:</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Jimmy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>使用 Lambda 表达式, 代码如下:</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Jimmy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-17-17-37-22.png" alt="2020-04-17-17-37-22"></p> <h3 id="方法引用"><a href="#方法引用" class="header-anchor">#</a> 方法引用</h3> <p>有时候, 可能已经有现成的方法实现了你想要在 Lambda 表达式里写的操作. 那么你可以直接引用这个现成的方法.</p> <p>格式如下, 使用 <code>::</code> 操作符分割方法名, 和其所属的对象或类;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-17-17-48-04.png" alt="2020-04-17-17-48-04"></p> <h4 id="静态方法-对象的方法"><a href="#静态方法-对象的方法" class="header-anchor">#</a> 静态方法, 对象的方法</h4> <p>对于引用对象的方法, 或类的静态方法, 上面的表达式与 Lambda 表达式的转换关系如下 👇:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span><span class="token function">println</span>

<span class="token comment">// 等价于</span>

<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="类的方法"><a href="#类的方法" class="header-anchor">#</a> 类的方法</h4> <p>对于这种情况, Lambda 表达式的第一个参数会变成调用方法的实例对象, 也就是方法的隐式参数:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">compareToIgnoreCase</span>

<span class="token comment">// 等价于</span>

<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> x<span class="token punctuation">.</span><span class="token function">compareToIgnoreCase</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="构造函数"><a href="#构造函数" class="header-anchor">#</a> 构造函数</h4> <p>引用构造函数时, <code>::</code> 右边的方法名为 <code>new</code>:</p> <div class="language-java extra-class"><pre class="language-java"><code>n <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>

<span class="token comment">//等价于</span>

<span class="token class-name">ArrayList</span><span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span>
</code></pre></div><hr> <p>可以看出来在使用引用时, 我们连传入方法的参数都可以省略. 这虽然让代码更加简洁, 但对于不熟悉整体代码的人, 可读性却减低了;</p> <h3 id="变量作用域"><a href="#变量作用域" class="header-anchor">#</a> 变量作用域</h3> <p>通常, 你可能希望能够在 lambda 表达式的代码块中访问外围的方法或变量, 例如:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">repeatMessage</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">,</span> <span class="token keyword">int</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">ActionListener</span> listener <span class="token operator">=</span> event <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Toolkit</span><span class="token punctuation">.</span><span class="token function">getDefaultToolkit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">beep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">new</span> <span class="token class-name">Time</span><span class="token punctuation">(</span>delay<span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面 👆 代码中, Lambda 表达式代码块中的 <code>text</code> 是 <code>repeatMessage</code> 方法的一个参数变量;</p> <p>这种既不是 Lambda 表达式参数, 也没有在代码块中定义的变量, 叫做 &quot;<strong>自由变量</strong>&quot;;</p> <p>Lambda 表达式会把自由变量的值保存起来, 这被称为<strong>捕获</strong> captured. 这也顺便实现类<strong>闭包</strong> closure.</p> <p>Lambda 表达式中捕获的变量必须是一个实际上的<strong>最终变量</strong> effectively final. 也就是变量初始化之后, 它的值就不会被改变.</p> <p>下面 👇 的两种写法都是错误 ❌ 的:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-17-18-16-52.png" alt="2020-04-17-18-16-52"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-17-18-17-06.png" alt="2020-04-17-18-17-06"></p> <p>之所以有这个限制, 是因为 Lambda 表达式被传递给了别人, 它被调用的时机并不是顺序的, 如果能够更改外部的引用的值, 会造成并发的错误.</p> <hr> <p>Lambda 表达式的代码块与嵌套它的外部方法有相同的作用域, 所以 Lambda 表达式中, 不可以声明一个与它所在方法的局部变量, 同名的参数或局部变量;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-17-18-22-49.png" alt="2020-04-17-18-22-49"></p> <p>Lambda 表达式中的 <code>this</code> 同样也就是它所在的方法的 <code>this</code>.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-17-18-23-52.png" alt="2020-04-17-18-23-52"></p> <p>上面 👆 的 <code>this</code> 指向 Application 实例对象, 而不是 ActionListener 实例;</p> <h2 id="反射"><a href="#反射" class="header-anchor">#</a> 反射</h2> <ul><li>Java 反射机制是在运行状态中, 能够知道任意一个类所包含的属性和方法;</li> <li>并且能够访问和调用任意一个对象实例的属性和方法;</li> <li>这种动态获取信息和动态调用的能力, 叫做 &quot;反射&quot;;</li></ul> <h3 id="class-类"><a href="#class-类" class="header-anchor">#</a> Class 类</h3> <ul><li>Java 程序在运行时，Java 运行时系统会对所有的对象进行运行时类型标识;</li> <li>运行时类型信息记录了每个对象实例所属的类;</li> <li>用来保存这些类型信息的类是 Class 类;</li> <li>Class 类的实例对象内容是你创建的类的类型信息，比如你创建一个 shapes 类，那么，Java 会生成一个内容是 shapes 的 Class 类的对象;</li> <li>Class 实例对象的作用是, 在程序运行时提供, 或用来获得某个对象的类型信息;</li> <li>我们在程序中创建的对象实例, 都会有一个字段保存着它对应 Class 对象的引用;</li> <li>Class 类的对象不能像普通类一样，以 <code>new Class()</code> 的方式创建，它的对象只能由 JVM 创建，因为这个类没有 你可以访问的 public 构造函数;</li> <li>当 Java ��� 拟机装载类时，Class 类型对象实例自动被 JVM 创建;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-16-17-15-29.png" alt="2020-04-16-17-15-29"></p> <ul><li>通过类的 <strong><code>class</code></strong> 常量属性就可以获取到 Class 实例;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Class</span> employeeClass <span class="token operator">=</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>通过 Object 类中的 <strong><code>getClass()</code></strong> 方法可以获取到对象的 Class 类型实例;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Employee</span> employee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Class</span> employeeClass <span class="token operator">=</span> employee<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>通过 Class 类的 <strong><code>forName(className)</code></strong> 静态方法也可以获得对应的类型的 Class 实例;</li> <li><code>forName</code> 方法需要传入, 内容为目标类或接口名称的字符串;</li> <li>如果传入的字符串, 匹配不到对应的类或接口, 则抛出异常;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> className <span class="token operator">=</span> <span class="token string">&quot;Employee&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Class</span> employeeClass <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>因为同种类型的实例对象都引用同一个 Class 实例;</li> <li>所以可以通过 <code>==</code> 判断 Class 实例的方式, 判断对象类型;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Employee</span> employee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;这是一个雇员&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>使用 Class 实例的 <strong><code>newInstance()</code></strong> 方法可以动态地创建一个类的实例;</li> <li>创建出的实例类型为 Object, 需要向下转型, 才能转换成对应类的实例;</li> <li>但是 <code>newInstance</code> 只会调用类的默认的构造函数, 不能向里传递参数;</li> <li>如果类没有默认的构造函数会抛出异常;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> className <span class="token operator">=</span> <span class="token string">&quot;Employee&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Class</span> employeeClass <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Employee</span> employee <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> employeeClass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>如果想使用自定义的构造函数, 要使用 Constructor 类型实例的 <code>newInstance()</code> 方法;</li> <li>Constructor 类代表某个类的构造函数;</li> <li>通过 Class 实例的 <code>getDeclaredConstructor()</code> 方法获取到想要的构造函数对应的 Constructor 实例;</li> <li><code>getDeclaredConstructor()</code> 方法传入的参数为, 构造函数需要接收的参数的 Class 实例;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> className <span class="token operator">=</span> <span class="token string">&quot;Employee&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Class</span> employeeClass <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Constructor</span> ec <span class="token operator">=</span> employeeClass<span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Employee</span> garrik <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> ec<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token string">&quot;Garrik&quot;</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="利用反射分析类的能力"><a href="#利用反射分析类的能力" class="header-anchor">#</a> 利用反射分析类的能力</h3> <p><code>java.lang.relfect</code> 包内用三个类 Field, Method, Constructor, 分别对应描述类的属性, 方法, 和构造器;</p> <p><code>java.lang.relfect</code> 包内的 Modifier 类对应修饰符;</p> <p>下面 👇 是和它们相关常用方法:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-16-17-48-14.png" alt="2020-04-16-17-48-14"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-16-17-48-25.png" alt="2020-04-16-17-48-25"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-16-17-48-38.png" alt="2020-04-16-17-48-38"></p> <p>下面 👇 的代码, 可以打印出一个类的全部信息. 用户输入一个类名, 然后程序输出这个类的所有的方法和构造器的签名, 以及全部的属性名;</p> <details class="custom-block details"><summary>点击展开：</summary> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect</span><span class="token punctuation">.</span><span class="token class-name">Constructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect</span><span class="token punctuation">.</span><span class="token class-name">Field</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect</span><span class="token punctuation">.</span><span class="token class-name">Method</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect</span><span class="token punctuation">.</span><span class="token class-name">Modifier</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">Scanner</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReflectionTest</span>
<span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token comment">// read class name from command line args or user input</span>
      <span class="token class-name">String</span> name<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> name <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">else</span>
      <span class="token punctuation">{</span>
         <span class="token class-name">Scanner</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Enter class name (e.g. java.util.Date): &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         name <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">try</span>
      <span class="token punctuation">{</span>
         <span class="token comment">// print class name and superclass name (if != Object)</span>
         <span class="token class-name">Class</span> cl <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">Class</span> supercl <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//获取cl的访问权限修饰符（public，private等）</span>
         <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>cl<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;class &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>supercl <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> supercl <span class="token operator">!=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot; extends &quot;</span>
               <span class="token operator">+</span> supercl<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;\n{\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">//打印构造方法</span>
         <span class="token function">printConstructors</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">//打印成员方法</span>
         <span class="token function">printMethods</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">//打印域（成员变量）</span>
         <span class="token function">printFields</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
         e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token comment">/**
    * Prints all constructors of a class
    * @param cl a class
    */</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printConstructors</span><span class="token punctuation">(</span><span class="token class-name">Class</span> cl<span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token class-name">Constructor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> constructors <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Constructor</span> c <span class="token operator">:</span> constructors<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
         <span class="token class-name">String</span> name <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;   &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">&quot;(&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// print parameter types</span>
         <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramTypes <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> paramTypes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>paramTypes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;);&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token comment">/**
    * Prints all methods of a class
    * @param cl a class
    */</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printMethods</span><span class="token punctuation">(</span><span class="token class-name">Class</span> cl<span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token class-name">Method</span><span class="token punctuation">[</span><span class="token punctuation">]</span> methods <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> m <span class="token operator">:</span> methods<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
         <span class="token class-name">Class</span> retType <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">getReturnType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">String</span> name <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;   &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">// print modifiers, return type and method name</span>
         <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>retType<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;(&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// print parameter types</span>
         <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramTypes <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> paramTypes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>paramTypes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;);&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token comment">/**
    * Prints all fields of a class
    * @param cl a class
    */</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printFields</span><span class="token punctuation">(</span><span class="token class-name">Class</span> cl<span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fields <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Field</span> f <span class="token operator">:</span> fields<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
         <span class="token class-name">Class</span> type <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">String</span> name <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;   &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="在运行时使用反射操纵对象"><a href="#在运行时使用反射操纵对象" class="header-anchor">#</a> 在运行时使用反射操纵对象</h3> <ul><li>通过 <code>Field</code> 类的 <strong><code>get(obj)</code></strong> 方法可以获取实例对象的指定属性的值;</li> <li><code>get(obj)</code> 方法传入的参数为想要访问的对象实例;</li> <li>如果想要获取的属性是 private, 那么会抛出 IllegalAccessException 异常;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Employee</span> garrik <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">&quot;Garrik&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Class</span> employeeClass <span class="token operator">=</span> garrik<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Field</span> employeeName <span class="token operator">=</span> employeeClass<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 把 garrik 实例传入 get 方法</span>
<span class="token class-name">String</span> garrikName <span class="token operator">=</span> employeeName<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>garrik<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>通过 Field 类的 <strong><code>set(obj, value)</code></strong> 方法可以设置对应实例对象的属性值;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Employee</span> garrik <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">&quot;Garrik&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Class</span> employeeClass <span class="token operator">=</span> garrik<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Field</span> employeeName <span class="token operator">=</span> employeeClass<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
employeeName<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>garrik<span class="token punctuation">,</span> <span class="token string">&quot;Xiang&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>如果属性是私有的, 受限于 Java 的访问控制, <code>set</code> 和 <code>get</code> 都会抛出异常;</li> <li>如果一个 Java 程序没有受到安全控制器的控制, 可以使用 <code>setAccessible(true)</code> 方法来解除限制;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Employee</span> garrik <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">&quot;Garrik&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Class</span> employeeClass <span class="token operator">=</span> garrik<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Field</span> employeeName <span class="token operator">=</span> employeeClass<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

employeeName<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">String</span> garrikName <span class="token operator">=</span> employeeName<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>garrik<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-16-18-17-24.png" alt="2020-04-16-18-17-24"></p> <ul><li>通过 Method 类的 <strong><code>invoke(obj, ...args)</code></strong> 方法可以调用包装在当前 Method 对象中的方法;
<ul><li>第一个参数是调用这个方法的实例对象, 也就是隐式参数;</li> <li>第二个参数就是传入方法的显式参数;</li></ul></li> <li>如果调用的是一个静态方法, 第一个参数为 <code>null</code>;</li> <li>Method 实例对象通过 Class 实例的 <code>getMethod(name, ...parameterTypes)</code> 获取;
<ul><li>第一个参数是方法的名字;</li> <li>因为重载的原因, 可能有多个方法公用一个名字, 想要准确的获得目标方法, 可以在之后提供目标方法的参数类型;</li></ul></li> <li>也可以通过 Class 实例的 <code>getDeclareMethods</code> 方法获得包含所有方法的数组, 然后在里面进行查找;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Employee</span> garrik <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Method</span> m <span class="token operator">=</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;raiseSalary&quot;</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

m<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>garrik<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-16-18-25-58.png" alt="2020-04-16-18-25-58"></p> <h2 id="代理-proxy"><a href="#代理-proxy" class="header-anchor">#</a> 代理 Proxy</h2> <h3 id="什么是代理"><a href="#什么是代理" class="header-anchor">#</a> 什么是代理</h3> <ul><li>在设计模式中, <strong>代理模式</strong>是给某一个对象提供一个代理对象，并由代理对象来控制对真实对象的访问;</li> <li>创建代理对象类叫做 &quot;<strong>代理类</strong>&quot;, 被代理的对象所属的类叫 &quot;<strong>委托类</strong>&quot;;</li> <li>通过代理, 可以实现客户与委托类之间的解耦, 在不修改委托类代码的情况下, 通过代理类可以进行功能的扩展;</li> <li>🌰 例如: 为委托类预处理数据、事后数据处理、性能检测, 打印日志, 等;</li> <li>因为客户不接触委托类对象, 所以也顺便隐藏了委托类的实现;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-16-22-29-47.png" alt="2020-04-16-22-29-47"></p> <p>按照代理类的字节码文件的创建来分类, 可以分成:</p> <ul><li><strong>静态代理</strong>: 所谓静态也就是在程序运行前就已经存在代理类的字节码文件, 代理类和委托类的关系在运行前就确定了;</li> <li><strong>动态代理</strong>: 动态代理的源码是在程序运行期间由 JVM 根据反射等机制动态的生成，所以在运行前并不存在代理类的字节码文件;</li></ul> <h3 id="静态代理"><a href="#静态代理" class="header-anchor">#</a> 静态代理</h3> <ul><li>代理类和委托类都实现了相同的接口;</li> <li>委托类实现接口中的方法, 提供真正的业务逻辑;</li> <li>代理类中通过一个委托类型的属性, 来保存对委托对象的引用;</li> <li>代理类中对接口方法的实现里, 通过委托对象来调用对应的方法. 在方法调用的前后, 可以插入扩展出的操作;</li></ul> <p>🌰 示例:</p> <p>下面 👇Vendor 是委托类, BusinessAgent 是代理类, 他们都实现了 Sell 接口;</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * 委托类和代理类都实现了Sell接口
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Sell</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">sell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">ad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * 生产厂家
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Vendor</span> <span class="token keyword">implements</span> <span class="token class-name">Sell</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sell</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;In sell method&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">,</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ad method&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * 代理类
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BusinessAgent</span> <span class="token keyword">implements</span> <span class="token class-name">Sell</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Sell</span> vendor<span class="token punctuation">;</span> <span class="token comment">// 对委托对象的引用</span>

    <span class="token keyword">public</span> <span class="token class-name">BusinessAgent</span><span class="token punctuation">(</span><span class="token class-name">Sell</span> vendor<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>vendor <span class="token operator">=</span> vendor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sell</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vendor<span class="token punctuation">.</span><span class="token function">sell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vendor<span class="token punctuation">.</span><span class="token function">ad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>因为在代码运行之前, 就写好了代理类, 所以成为之 &quot;静态代理&quot;;</p> <h3 id="动态代理"><a href="#动态代理" class="header-anchor">#</a> 动态代理</h3> <p>代理类在程序运行时被创建的代理方式, 被称之为 &quot;动态代理&quot;.</p> <p>静态代理的缺点:</p> <ul><li>如果代理类实现的接口中有很多的方法, 而你只想扩展其中一个方法在委托类中的实现, 但你却需要在代理类中给接口的每个方法都提供代理实现, 这很麻烦;</li> <li>假如接口新增/删减了方法, 代理类和委托类也要同时修改, 不易维护;</li></ul> <p>在动态代理中, 这些问题都不存在了.</p> <p>动态代理主要涉及到 JDK 提供的 <code>java.lang.reflect.InvocationHandler</code> 接口, 和 <code>java.lang.reflect.Proxy</code> 类.</p> <ul><li><p>首先委托类需要实现至少一个接口;</p></li> <li><p>接口并不能够实例化创建对象;</p></li> <li><p>通过 Proxy 类中的 <strong><code>newProxyInstance</code></strong> 静态方法, 可以创建一个实现了指定接口的代理类的新实例;</p> <ul><li>方法签名是 <code>static Object newProxyInstance(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h)</code></li> <li>第一个参数: 类加载器 class loader, 可以通过委托类 Class 对象的 <code>getClassLoader()</code> 获取;</li> <li>第二个参数: 需要实现的接口的 Class 对象组成的数组;</li> <li>第三个参数: 调用处理器, 代理对象通过它来实现对委托对象的调用;</li></ul></li> <li><p>可以看出, 在动态代中, 代理对象和委托对象之间隔着一个 InvocationHandler 对象;</p></li> <li><p>由 <code>newProxyInstance</code> 方法生成的代理类实现了传入的接口内所有的方法;</p></li> <li><p>不同于静态代理中, 代理对象内部直接保存着对委托对象的引用, 呈现出一种一对一的关系;</p></li> <li><p>动态代理中的代理类适用于所有实现了相同接口的类实例;</p></li> <li><p>但客户对代理对象的调用, 最终要传递到一个具体的委托对象上;</p></li> <li><p>InvocationHandler 对象就作为代理对象和委托对象之间的中介, 来进行搭桥;</p></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-16-23-48-32.png" alt="2020-04-16-23-48-32"></p> <ul><li>invocationHandler 对象被称作 &quot;<strong>调用处理器</strong>&quot;;</li> <li>调用处理器是实现了 InvocationHandler 接口的类的对象;</li> <li>接口中只有一个方法 <code>Object invoke(Object proxy, Method method, Object[] args)</code>;</li> <li>当客户调用代理对象方法时, 内部的调用处理器的 <code>invoke</code> 方法就会被调用, 它会去调用委托对象对应的方法;</li> <li>代理对象向其传入被调用方法的 Method 对象, 和调用参数;</li></ul> <p>🌰 示例:</p> <p>下面 👇 给出一个动态代理的示例.</p> <p>编写一个调用逻辑处理器 LogHandler 类，提供日志增强功能，并实现 InvocationHandler 接口；在 LogHandler 中维护一个目标对象，这个对象是被代理的对象;</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogHandler</span> <span class="token keyword">implements</span> <span class="token class-name">InvocationHandler</span> <span class="token punctuation">{</span>
  <span class="token class-name">Object</span> target<span class="token punctuation">;</span>  <span class="token comment">// 被代理的对象，实际的方法执行者</span>

  <span class="token keyword">public</span> <span class="token class-name">LogHandler</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> target<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
    <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Object</span> result <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 调用 target 的 method 方法</span>
    <span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>  <span class="token comment">// 返回方法的执行结果</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 调用invoke方法之前执行</span>
  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;log start time [%s] &quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 调用invoke方法之后执行</span>
  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;log end time [%s] &quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过 Proxy 类的 <code>newProxyInstance</code> 方法生成代理对象, 之后客户通过代理对象来访问委托对象;</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalAccessException</span><span class="token punctuation">,</span> <span class="token class-name">InstantiationException</span> <span class="token punctuation">{</span>

    <span class="token comment">// 1. 创建被代理的对象，UserService接口的实现类</span>
    <span class="token class-name">UserServiceImpl</span> userServiceImpl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2. 获取对应的 ClassLoader</span>
    <span class="token class-name">ClassLoader</span> classLoader <span class="token operator">=</span> userServiceImpl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3. 获取所有接口的 Class 数组，这里的 UserServiceImpl 只实现了一个接口 UserService，</span>
    <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> interfaces <span class="token operator">=</span> userServiceImpl<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 4. 创建一个将传给代理类的调用请求处理器，处理所有的代理对象上的方法调用</span>
    <span class="token class-name">InvocationHandler</span> logHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LogHandler</span><span class="token punctuation">(</span>userServiceImpl<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 5. 创建代理对象</span>
    <span class="token class-name">UserService</span> proxy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">,</span> interfaces<span class="token punctuation">,</span> logHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 6. 客户调用代理的方法</span>
    proxy<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    proxy<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="异常"><a href="#异常" class="header-anchor">#</a> 异常</h2> <p>程序在运行时无可避免的会发生错误, 我们应该妥善的处理这些异常, 至少应该能做到以下几点:</p> <ul><li>向用户通告错误;</li> <li>保存所有的工作结果;</li> <li>允许用户以妥善的方式退出程序, 或者退回到一种安全状态;</li></ul> <p>Java 使用一种称为 &quot;<strong>异常处理</strong>&quot; Exception Handing 的错误捕获机制去处理运行时发生的异常;</p> <h3 id="处理错误"><a href="#处理错误" class="header-anchor">#</a> 处理错误</h3> <p><strong>异常处理</strong>的任务就是将程序的控制权从错误发生的地方, 转移到能够处理这种错误的处理器.</p> <p>一般来说, 程序中的错误大致可以分为:</p> <ul><li><strong>用户输入错误</strong>:
<ul><li>本应该输入数字, 但是输入了单词;</li></ul></li> <li><strong>设备错误</strong>:
<ul><li>打印机关机了;</li> <li>打印机没纸了;</li> <li>网断了;</li></ul></li> <li><strong>物理限制</strong>:
<ul><li>磁盘满了, 储存空间用完了;</li></ul></li> <li><strong>代码错误</strong>:
<ul><li>想要访问的数组下标不对;</li> <li>在散列表中查找不存的记录;</li> <li>错误的调用了方法;</li></ul></li></ul> <p>在 Java 中, 如果遇到了异常, 可以<strong>抛出</strong> throw 一个封装了错误信息的实例对象, 同时将程序的控制权交给对应的异常处理器.</p> <h4 id="异常分类"><a href="#异常分类" class="header-anchor">#</a> 异常分类</h4> <p>在 Java 中, 异常对象都是派生于 <strong>Throwable 类</strong>的一个实例;</p> <p>Java 的异常层次结构如下 👇:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-17-22-29-50.png" alt="2020-04-17-22-29-50"></p> <ul><li><strong>Error 类</strong>:
<ul><li>描述了 Java 运行时系统的内部错误, 我们编写的应用程序不应该抛出这种类型的错误;</li> <li>如果出现了这种错误, 应该尽可能地使程序安全退出, 除此之外, 也没什么办法了;</li></ul></li> <li><strong>Exception 类</strong>:
<ul><li>对于我们编写程序来说, 需要关注 Exception 类的异常;</li> <li>它又派生出两个分支 RuntimeException, IOException;</li></ul></li> <li><strong>RuntimeException 类</strong>:
<ul><li>有程序错误导致的异常属于 RuntimeException;</li> <li>也就是开发者写的代码有问题;</li> <li>🌰 例如:
<ul><li>错误的类型转换;</li> <li>数组访问越界;</li> <li>访问 <code>null</code> 指针;</li></ul></li></ul></li> <li><strong>IOException 类</strong>:
<ul><li>程序本身没问题, 由于 I/O 错误导致的问题属于 IOException;</li> <li>🌰 例如:
<ul><li>试图在文件尾部后面读取数据;</li> <li>试图打开一个不存在的文件;</li> <li>试图根据字符串查找 Class 实例对象, 但是这个类并不存在;</li></ul></li></ul></li></ul> <hr> <ul><li>所有派生于 Error 类或 RuntimeException 类的异常称为 &quot;<strong>非受查异常</strong>&quot; unchecked;</li> <li>所有的 IOException 类异常称为 &quot;<strong>受查异常</strong>&quot; checked;</li> <li>编译器会检查你是否为所有的受查异常都提供了异常处理器;</li> <li>因为受查异常的发生, 并不取决于你的代码正确与否, 而是取决于外部环境;
<ul><li>🌰 例如, 如果一件文件根本不存在, 你就打不开它, 即使你的读取文件代码正确;</li> <li>如果断网了, 即使你访问网络资源的代码正确, 你也访问不到任何东西;</li></ul></li></ul> <h4 id="声明异常"><a href="#声明异常" class="header-anchor">#</a> 声明异常</h4> <p>方法应该在其首部声明所有可能抛出的异常;</p> <p>🌰 例如:</p> <p>下面 👇 这个方法可能根据给定的 String 参数产生一个 FileinputStream 实例对象, 也可能抛出一个 FileNotFoundException 异常对象;</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">FileInputStream</span> <span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">FileNotFoundException</span>
</code></pre></div><p>在编写代码时, 不必将所有可能抛出的异常都进行声明;</p> <p>代码在遇到如下 4 种情况时应该抛出异常:</p> <ul><li>调用一个抛出受查异常的方法;</li> <li>程序运行过程中发生错误，并且利用 <code>throw</code> 语句抛出一个受查异常;</li> <li>程序出现错误, 抛出非受查异常;</li> <li>Java 虚拟机和运行时库出现的内部错误;</li></ul> <p><strong>对于前两种错误, 必须在编写方法时声明异常</strong>. 因为任何一个抛出异常的方法, 都会让当前执行的线程结束, 我们必须要用异常处理器, 对其进行捕获并处理.</p> <p>但 Java 的内部错误任何代码都有可能抛出, 我们对其无能为力;</p> <p>非受查异常的发生说明代码写的有问题, 我们应该修改程序, 而不是把它交给异常处理器;</p> <h4 id="抛出异常"><a href="#抛出异常" class="header-anchor">#</a> 抛出异常</h4> <p>在代码运行时, 如果出现了不正常的情况, 我们可以用 <code>throw</code> 关键字抛出一个异常.</p> <p>具体步骤如下:</p> <ul><li>先找到一个合适的异常类;</li> <li>然后创建异常实例;</li> <li>用 <code>throw</code> 抛出;</li></ul> <p>🌰 例如:</p> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token class-name">String</span> <span class="token function">readDate</span><span class="token punctuation">(</span><span class="token class-name">Scanner</span> in<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">EOFEception</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>in<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// EOF encountered</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">EOFEception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 抛出异常实例</span>
      <span class="token punctuation">}</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

</code></pre></div><p>下面 👇 罗列出了一些常用的 Java 自带的异常类:</p> <p><strong>非受查异常</strong>:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-17-23-13-07.png" alt="2020-04-17-23-13-07"></p> <p><strong>受查异常</strong>:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-17-23-13-15.png" alt="2020-04-17-23-13-15"></p> <h4 id="自定义异常类"><a href="#自定义异常类" class="header-anchor">#</a> 自定义异常类</h4> <p>如果任何标准的异常类都不能满足你的需求, 你可以自己创建异常类.</p> <p><strong>自定义异常类是派生自 Exception 类, 或其子类的类</strong>;</p> <p>🌰 示例:</p> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token comment">// 文件名 InsufficientFundsException.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token comment">//自定义异常类，继承Exception类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InsufficientFundsException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span>
<span class="token punctuation">{</span>
  <span class="token comment">//此处的 amount 用来储存当出现异常（取出钱多于余额时）所缺乏的钱</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> amount<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">InsufficientFundsException</span><span class="token punctuation">(</span><span class="token keyword">double</span> amount<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>amount <span class="token operator">=</span> amount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">return</span> amount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>下面 👇 是对这个异常的使用:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token keyword">double</span> amount<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InsufficientFundsException</span>
<span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>amount <span class="token operator">&lt;=</span> balance<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    balance <span class="token operator">-=</span> amount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">double</span> needs <span class="token operator">=</span> amount <span class="token operator">-</span> balance<span class="token punctuation">;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InsufficientFundsException</span><span class="token punctuation">(</span>needs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>自定义异常类里可以定义一个接收字符串参数的构造函数, 字符串会作为异常的描述信息;</p> <p>超类 Throwable 的 <code>toString</code> 方法可以打印这个信息, 这在调试时非常有用;</p> <p>🌰 例如:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">FileFormatException</span> <span class="token keyword">extends</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">FileFormatException</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token class-name">FileFormatException</span><span class="token punctuation">(</span><span class="token class-name">String</span> errMsg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>下面 👇 是 Throwable 类的常用方法:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-17-23-19-44.png" alt="2020-04-17-23-19-44"></p> <h3 id="捕获异常"><a href="#捕获异常" class="header-anchor">#</a> 捕获异常</h3> <ul><li>如果异常发生时没有地方对其进行捕获, 程序就会终止, 并在控制台打印异常信息;</li> <li>想要捕获一个异常, 需要使用 <code>try/catch</code> 语句块;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-10-23-08.png" alt="2020-04-18-10-23-08"></p> <ul><li>在 <code>catch</code> 子句中需要声明异常类型;</li> <li>如果 <code>try</code> 代码块中抛出一个类型匹配的异常对象, <code>catch</code> 就会捕获这个异常, 并且执行它下面代码块中的代码;</li> <li>如果 <code>try</code> 代码块抛出的异常与 <code>catch</code> 子句中的异常类型不匹配, 则直接退出程序, 并在控制台打印异常信息;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-10-07-58.png" alt="2020-04-18-10-07-58"></p> <ul><li>在上面 👆 的 <code>read</code> 方法中, 可能会抛出 IOExpection 异常, 但是如何处理异常应该是方法调用者的事情, 我们不应该管, 更好的做法是只用 <code>throws</code>声明 <code>read</code> 方法可能会抛出异常, 把异常传递给调用者;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-10-09-04.png" alt="2020-04-18-10-09-04"></p> <ul><li>对于我们知道如何处理的异常, 应该使用 <code>try/catch</code> 进行捕获, 并处理;</li> <li>对于不知道如何处理的异常, 应该把异常抛出传递给上一级;</li> <li>⚠️ 注意, Java 不允许在子类方法的 <code>throws</code> 说明符中出现超过超类方法所声明的异常范围;
<ul><li>如果在子类中, 编写一个覆盖超类的方法, 但是方法又可能抛出超出父类方法声明的异常范围时, 我们就必须在方法中使用 <code>try/catch</code> 对异常进行捕获并处理;</li></ul></li></ul> <h4 id="捕获多个异常"><a href="#捕获多个异常" class="header-anchor">#</a> 捕获多个异常</h4> <ul><li>在一个 <code>try</code> 语句块后面可以写多个 <code>catch</code> 去捕获多个异常;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-10-36-07.png" alt="2020-04-18-10-36-07"></p> <ul><li>同一个 <code>catch</code> 子句中也可以捕获多个异常类型;</li> <li>使用 <code>|</code> 操作符来匹配多个异常类型;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-10-37-10.png" alt="2020-04-18-10-37-10"></p> <ul><li>捕获多个异常时, 异常变量隐含为 <code>final</code> 变量, 不可以更改异常变量的值;</li></ul> <h4 id="再次抛出异常"><a href="#再次抛出异常" class="header-anchor">#</a> 再次抛出异常</h4> <ul><li>在 <code>catch</code> 代码块中, 可以再抛出一个异常;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-10-38-30.png" alt="2020-04-18-10-38-30"></p> <h4 id="finally"><a href="#finally" class="header-anchor">#</a> finally</h4> <ul><li>当代码遇到异常, 就会终止程序, 所以剩余的代码也就不会被执行;</li> <li>如果程序在异常出现之前获取了一些资源, 并且资源需要在程序结束前被回收. 如果出现异常, 程序中途停止, 资源就不会被回收.</li> <li><code>finally</code> 代码块中的代码, 无论 <code>try</code> 中是否出现异常, 它都会执行;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">InputStream</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
  in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>上面代码中, 无论 <code>try</code> 语句块内是否发生异常, <code>finally</code> 代码块中的 <code>in.close()</code> 都会执行;</li> <li>⚠️ 注意, 假如 <code>try</code> 代码块中包含 <code>return</code> 语句. 而方法返回之前, <code>finally</code> 代码块会被执行, 如果 <code>finally</code> 里面也有 <code>return</code> 语句, 那么这个返回值就会覆盖 <code>try</code> 里面的返回值;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-10-46-48.png" alt="2020-04-18-10-46-48"></p> <ul><li><code>finally</code> 代码块中也是有可能发生异常, 可以通过如下 👇 的写法来同时捕获 <code>try</code> 和 <code>finally</code> 里面的异常;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-10-48-29.png" alt="2020-04-18-10-48-29"></p> <h4 id="带资源的-try-语句"><a href="#带资源的-try-语句" class="header-anchor">#</a> 带资源的 try 语句</h4> <p>上面 👆 同时捕获 <code>try</code> 和 <code>finally</code> 里面的异常会带来一个问题.</p> <p>如果 <code>try</code> 和 <code>finally</code> 代码块里同时出现异常, 那么 <code>finally</code> 里面的异常会被抛出, <code>try</code> 里面的异常会丢失.</p> <p>但是一般情况下, 我们可能更加关心 <code>try</code> 里面的异常;</p> <p>通过<strong>带资源的 <code>try</code> 语句</strong>可以解决这种问题.</p> <ul><li>带资源的 <code>try</code> 语句格式如下 👇:</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-10-54-27.png" alt="2020-04-18-10-54-27"></p> <ul><li><code>try</code> 后面的括号里可以写多行声明, 每个声明的变量类型必须都是 AutoCloseable 的子类;</li> <li>每条声明用分号 <code>;</code> 隔开;</li> <li>AutoCloseable 接口声明了一个 <code>close()</code> 方法;
<ul><li><code>void close() throws Exception</code>;</li></ul></li> <li>假设资源属于一个实现了 AutoCloseable 接口的类, 那么就可以写在括号里面了;</li> <li><code>try</code> 代码块退出时, 会自动调用括号中声明的资源实例的 <code>close</code> 方法去关闭资源;</li> <li>这样就不需要在 <code>finally</code> 代码块中去关闭资源了;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-10-59-03.png" alt="2020-04-18-10-59-03"></p> <ul><li>如果 <code>try</code> 和 <code>finally</code> 里面都出现了异常, 那么会抛出 <code>try</code> 里面的异常, <code>finally</code> 的异常会被抑制;</li></ul> <h4 id="分析堆栈轨迹"><a href="#分析堆栈轨迹" class="header-anchor">#</a> 分析堆栈轨迹</h4> <ul><li>堆栈轨迹 stack trace 是一个方法调用过程的列表, 它包含了程序执行过程中方法调用的特定位置;</li></ul> <p>🌰 例如, 下面是 👇 是递归斐波那契函数的堆栈情况:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-11-05-04.png" alt="2020-04-18-11-05-04"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-11-03-59.png" alt="2020-04-18-11-03-59"></p> <p>下面 👇 是和异常相关的接口/类里面的常用方法:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-11-06-16.png" alt="2020-04-18-11-06-16"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-11-06-54.png" alt="2020-04-18-11-06-54"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-04-18-11-07-05.png" alt="2020-04-18-11-07-05"></p> <h2 id="泛型"><a href="#泛型" class="header-anchor">#</a> 泛型</h2> <h3 id="什么是泛型"><a href="#什么是泛型" class="header-anchor">#</a> 什么是泛型</h3> <ul><li>『 泛型 』就是通用的类型；</li> <li>为了解决 &quot;在一开始不确定该是什么类型，在使用的时候才能确定是什么类型&quot; 的问题；</li></ul> <p>下面 👇 的例子中体现了为什么要使用泛型：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 声明了集合，里面可以存任何类型的元素</span>
<span class="token comment">// 希望有办法来约束集合当中只能存某一种类型</span>
<span class="token class-name">List</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 不确定创建时传入什么类型的值</span>
<span class="token comment">// 不用泛型的话，就要写很多个属性</span>
<span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> x1<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> y1<span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name">Integer</span> x2<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">Integer</span> y2<span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name">Double</span> x3<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">Double</span> y3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>想定义一个泛型类, 在类名的后面加上 <code>&lt;T&gt;</code>.</li> <li>T 代表不确定的类型, 被称为『 类型变量 』;</li> <li>类型变量在类中指定方法的返回类型, 或者属性和局部变量的类型;</li> <li>因为 T 只是代表不确定的类型，这里也可以写成别的字母，A，B，C 也可以;</li> <li>在创建对象的时候，要指明类型变量的具体类型；
<ul><li>🌰 <code>Point&lt;String&gt; p = new Point&lt;String&gt;()；</code></li> <li>如果没有指明，它就默认是 Object 类型；</li></ul></li> <li>从 Java 7 开始, 前面对象声明里已经写了具体类型, 后面调用构造函数时, 就可以省略了, 只写 <code>&lt;&gt;</code>;
<ul><li>🌰 <code>Point&lt;String&gt; p = new Point&lt;&gt;()；</code></li></ul></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Point</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token class-name">T</span> x<span class="token punctuation">;</span>
  <span class="token class-name">T</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Point</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 可以省略构造函数中的 String</span>
<span class="token class-name">Point</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">;</span>
</code></pre></div><p>下面 👇 用泛型声明了一个集合, 集合内中能存放 String 类型实例对象;</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 指定集合内只能是字符串类型</span>
<span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 这一条代码，就会报错，因为它不是字符串类型</span>

</code></pre></div><hr> <p>上面 👆 定义的都是泛型类, 下面来介绍如何定义一个带有类型参数的『 泛型方法 』.</p> <ul><li><p><strong>泛型类</strong>：在类上面定义的泛型，在创建对象的时候，指定泛型的类型；</p></li> <li><p><strong>泛型方法</strong>：在方法上定义的泛型，在调用时，通过传入参数指定具体类型；</p></li> <li><p>泛型方法既可以定义在普通类中, 也可以定义在泛型类中;</p></li> <li><p>泛型方法的类型变量 <code>&lt;T&gt;</code> 放在修饰符后面, 返回类型前面;</p></li> <li><p>当调用一个泛型方法时, 在方法名前的尖括号中放入具体的类型;</p></li> <li><p>在绝大多数情况下, 可以省去类型参数, 编译器可以根据传入的参数猜出具体类型;</p></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">ArrayAlg</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">getMiddle</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a<span class="token punctuation">[</span>a<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">String</span> middle <span class="token operator">=</span> <span class="token class-name">ArrayaAlg</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token function">getMiddle</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Tony&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HAHAHA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 可以省略 &lt;String&gt;</span>
<span class="token class-name">String</span> middle <span class="token operator">=</span> <span class="token class-name">ArrayaAlg</span><span class="token punctuation">.</span><span class="token function">getMiddle</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Tony&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HAHAHA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <ul><li>Java 允许同时定义多个类型变量:</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">T</span> first<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">U</span> second<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Pair</span><span class="token punctuation">(</span><span class="token class-name">T</span> first<span class="token punctuation">,</span> <span class="token class-name">U</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>first <span class="token operator">=</span> first<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>second <span class="token operator">=</span> second<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">1221</span><span class="token punctuation">,</span> <span class="token number">12.21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>下面 👇 来整体的看一些 🌰 例子:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GenericTest</span> <span class="token punctuation">{</span>
  <span class="token comment">//这个类是个泛型类</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Generic</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">T</span> key<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Generic</span><span class="token punctuation">(</span><span class="token class-name">T</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 虽然在方法中使用了泛型，但是这并不是一个泛型方法。</span>
    <span class="token comment">// 这只是类中一个普通的成员方法，只不过他的返回值是在声明泛型类时定义的类型参数</span>
    <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> key<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 这才是一个真正的泛型方法。</span>
  <span class="token comment">// 在 public 与返回值之间的 &lt;T&gt; 必不可少，这表明这是一个泛型方法</span>
  <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">showKeyName</span><span class="token punctuation">(</span><span class="token class-name">Generic</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> container<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;container key :&quot;</span> <span class="token operator">+</span> container<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//当然这个例子举的不太合适，只是为了说明泛型方法的特性。</span>
      <span class="token class-name">T</span> test <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> test<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//这也不是一个泛型方法，这就是一个普通的方法，指定了参数必须是 Generic&lt;Number&gt; 类型</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showKeyValue1</span><span class="token punctuation">(</span><span class="token class-name">Generic</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Number</span><span class="token punctuation">&gt;</span></span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;泛型测试&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;key value is &quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="泛型的上限-下限"><a href="#泛型的上限-下限" class="header-anchor">#</a> 泛型的上限 &amp; 下限</h3> <ul><li>泛型的<strong>上限</strong>，用来限定对象的类型必须是指定类型的<strong>子类</strong>, 或指定类型；</li> <li>泛型的<strong>下限</strong>，用来限定对象的类型必须是指定类型的<strong>父类</strong>, 或指定类型；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 指定上限，传入的必须是 Number 的子类或指定类型；</span>
<span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span> <span class="token keyword">extends</span> <span class="token class-name">Number</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 指定下限，传入的必须是 Number 的父类或指定类型；</span>
<span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span> <span class="token keyword">super</span> <span class="token class-name">Number</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><ul><li><code>extends</code> 和 <code>super</code> 关键字后面的限定类型, 也可以是接口;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><ul><li>通过 <code>&amp;</code> 可以指定多个限定类型;</li> <li>但因为 Java 中一个类至多只能继承一个类, 所以 <code>&amp;</code> 合并的都是接口;</li> <li>如果同时出现限定类和限定接口, 将限定类放在第一位;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">T</span> <span class="token keyword">extends</span> <span class="token class-name">Integer</span> <span class="token operator">&amp;</span> <span class="token class-name">Comparable</span> <span class="token operator">&amp;</span> <span class="token class-name">Serializable</span>
</code></pre></div><h3 id="类型擦除"><a href="#类型擦除" class="header-anchor">#</a> 类型擦除</h3> <p>泛型是 1.5 版本以后才加入的, 为了让泛型代码能够很好的和之前的代码兼容. ✏️ <strong>泛型信息只存在于代码编译阶段, 在进入 JVM 之前, 和泛型相关的信息会被擦除掉</strong>, 这被称作『 <strong>类型擦除</strong> 』</p> <p>也就是说擦除完的泛型类/方法, 和普通的类/方法没有什么区别.</p> <p>在类型擦除的时候:</p> <ul><li>✏️ <strong>之前类型参数如果没限定类型，则泛型类型会被替换成 Object 类型</strong>. 🌰 例如: <code>&lt;T&gt;</code></li> <li>✏️ <strong>如果指定限定类型, 则泛型类型就被替换成限定类型</strong>。🌰 例如: <code>&lt;T extends String&gt;</code></li></ul> <details open="open" class="custom-block details"><summary>🌰 例子：</summary> <p>下面 👇 的 <code>Pair&lt;T&gt;</code> 在经过类型擦除之后, 内部的 <code>T</code> 都被替换成了 Object:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-08-14-29-12.png" alt="2020-05-08-14-29-12"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-08-14-28-44.png" alt="2020-05-08-14-28-44"></p></details> <div class="custom-block warning"><p class="custom-block-title">Tip:</p> <p>这里理解成『 类型替换 』更直观一点.</p></div> <p>当程序调用泛型方法时, 如果泛型类型作为方法的返回类型, 但是泛型类型已经被擦除了, 编译器此时就会<strong>插入强制的类型转换</strong>.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Employee</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Employee</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> buddies <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 擦除类型后, getFirst 返回 Object 类型对象</span>
<span class="token comment">// 编译器在这里强制转换成 Employee 类型</span>
<span class="token class-name">Employee</span> buddy <span class="token operator">=</span> buddies<span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="类型擦除带来的约束-局限性"><a href="#类型擦除带来的约束-局限性" class="header-anchor">#</a> 类型擦除带来的约束 &amp; 局限性</h3> <p>下面 👇 讨论一下使用泛型时的一些限制.</p> <p>✏️ <strong>不能用基本类型作为类型参数</strong>:</p> <ul><li><code>int</code>, <code>double</code> 这些基本类型不能作为泛型的类型参数;</li> <li>🌰 <code>Pair&lt;Double&gt;</code> 不能写成 <code>Pair&lt;double&gt;</code>;</li> <li>原因是 Double 类型会被擦除成 Object 类型, 而 Object 类型对象不能储存 double 类型的值;</li></ul> <hr> <p>✏️ <strong>instanceof 不能用于泛型类</strong>:</p> <p>因为类型擦除的存在, 所以不能用 <code>instanceof</code> 去验证一个实例是否属于一个泛型类;</p> <div class="language-java extra-class"><pre class="language-java"><code>a <span class="token keyword">instanceof</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token comment">// Error</span>
a <span class="token keyword">instanceof</span> <span class="token class-name">Pair</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token comment">// Error</span>
</code></pre></div><p>✏️ <strong>不能创建参数化类型的数组</strong>:</p> <p>不能创建参数化类型的数组。例如，下面的代码不能编译：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayOfLists <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// compile-time error</span>
</code></pre></div><p>原因是, 在声明数组时, 我指定了 List 的类型参数是 <code>Integer</code>. 但是类型擦除让 Integer 被替换成 Object 了.</p> <p><code>List&lt;Integer&gt;[]</code> 数组就变成了 <code>List&lt;Object&gt;[]</code> 类型的数组.</p> <p>这个时候, 如果我执行 <code>arrayOfLists[0] = new List&lt;Boolean&gt;()</code> 也是能够通过数组的类型检查的.</p> <p>但是这种操作是存在错误的, 所以出于这个原因, 就不允许创建参数化类型的数组.</p> <p>✏️ <strong>不能实例化类型变量</strong>:</p> <p>不能创建一个类型参数的实例。例如，下面的代码导致编译时错误：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">E</span> elem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">E</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// compile-time error</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>作为解决方法，可以通过反射来创建类型参数的对象：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> cls<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">E</span> elem <span class="token operator">=</span> cls<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// OK</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">append</span><span class="token punctuation">(</span>ls<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>✏️ <strong>不能构造泛型数组</strong>:</p> <p>和上面不能用类型参数实例化一个实例一样, 也不能实例化数组.</p> <p>下面的代码是不能执行的:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">T</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Error</span>
</code></pre></div><p>✏️ <strong>泛型类的静态上下文中的类型变量无效</strong>:</p> <p>不能再静态域或方法中引用类型变量</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-08-15-31-40.png" alt="2020-05-08-15-31-40"></p> <p>原因很简单, 因为静态域和方法被所有类型的实例共享. 那么到底采用哪个实例类型变量的值呢? 所以不能用.</p> <p>✏️ <strong>不能抛出或捕获泛型类的实例</strong>:</p> <p>不能再 <code>catch</code> 的子句中使用类型变量.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-08-15-36-03.png" alt="2020-05-08-15-36-03"></p> <h3 id="通配符类型"><a href="#通配符类型" class="header-anchor">#</a> 通配符类型</h3> <p><strong>无界通配符</strong>:</p> <ul><li>当方法需要接受一个泛型类对象实例，但是却不知道对象的具体类型；</li> <li>可以使用通配符 <code>?</code> 来定义参数；</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 使用通配符，表明还不确定 List 内泛型的类型</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>下面 👇 这种方式是不对 ❌ 的:</p> <ul><li>即使 Integer 是 Number 的子类, 下面的写法也会报错;</li> <li>需要使用 <code>?</code> 通配符才可以;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Number</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>上界通配符</strong>:</p> <p>可以使用上界的通配符来放宽对变量的限制.</p> <p>🌰 例如，假设你想要写上面 👆 的 <code>test</code> 方法同时可以接收 <code>List &lt;Integer&gt;</code> 、 <code>List&lt;Double&gt;</code> 和 <code>List&lt;Number&gt;</code> 你可以通过使用上界的通配符来实现这一点。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Number</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p><strong>下界通配符</strong>:</p> <p><code>?</code> 后面接 <code>super</code> 关键字就可以指定泛型实例的类型变量, 必须是某个类型的父类或其自身.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">addNumbers</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="集合"><a href="#集合" class="header-anchor">#</a> 集合</h2> <p>集合可以看作是一种容器，用来存储对象信息。</p> <p><strong>数组与集合的区别</strong>:</p> <ul><li>数组长度不可变化, 而且无法保存具有映射关系的数据；</li> <li>集合类用于保存数量不确定的数据，以及保存具有映射关系的数据;</li> <li>数组元素既可以是基本类型的值，也可以是对象. (基本类型会被装箱)</li> <li>集合只能保存对象;</li> <li>数组只能储存同一种类型的元素;</li> <li>集合可以储存不同类型的元素;</li></ul> <hr> <p>Java 的集合类库将接口与实现分离.</p> <p>Java 集合框架为不同类型的集合定义了大量接口. 其中集合类的基本接口是:</p> <ul><li><strong>Collection 接口</strong>: 存储一组对象实例;</li> <li><strong>Map 接口</strong> 存储键/值对映射;</li> <li>根据这两个基本接口, 有扩展出了很多不同类型的集合接口;</li> <li>根据这些接口, 又扩展出很多抽象类;</li> <li>再之下是各种集合具体的实现类;</li> <li>所有的集合类都是由 Collection 接口, 和 Map 接口派生出来的;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-09-10-31-23.png" alt="2020-05-09-10-31-23"></p> <p>下表 👇 简要描述了每个集合类的用途:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-09-13-49-12.png" alt="2020-05-09-13-49-12"></p> <p>下图 👇 展示了不同集合的特性:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-09-14-05-07.png" alt="2020-05-09-14-05-07"></p> <h3 id="collection-接口"><a href="#collection-接口" class="header-anchor">#</a> Collection 接口</h3> <p><a href="http://itmyhome.com/java-api/index.html?java/util/Collection.html" target="_blank" rel="noopener noreferrer">🔗 Collection 接口 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Collection 接口中定义了如下方法:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-09-14-34-03.png" alt="2020-05-09-14-34-03"></p> <h4 id="iterable-iterator"><a href="#iterable-iterator" class="header-anchor">#</a> Iterable &amp; Iterator</h4> <p><a href="http://itmyhome.com/java-api/index.html?java/lang/Iterable.html" target="_blank" rel="noopener noreferrer">🔗 Iterable 接口 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="http://itmyhome.com/java-api/index.html?java/util/Iterator.html" target="_blank" rel="noopener noreferrer">🔗 Iterator 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>Collection 接口扩展了 Iterable 接口.</li> <li>Iterable 接口只有一个方法 <code>iterator</code>, 它返回一个在一组实例对象上进行迭代的迭代器.</li> <li>迭代器实现了 Iterator 接口.</li></ul> <p>Iterator 接口中定义的方法如下:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-09-14-35-29.png" alt="2020-05-09-14-35-29"></p> <ul><li>迭代器可以用来发访问集合中的每个元素;</li> <li>调用 <code>next</code> 方法返回迭代的下一个元素, 如果到达了集合的末尾, 会抛出一个异常;</li> <li>因此, 需要在每次调用 <code>next</code> 方法前, 调用 <code>hasNext</code> 方法, 去判断是否后面仍有元素可用于迭代;</li> <li>如果 <code>hasNext</code> 返回 <code>true</code>, 就可以调用 <code>next</code>;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 创建集合</span>
<span class="token class-name">Collection</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;小红&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;小明&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;小张&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建集合的迭代器</span>
<span class="token class-name">Iterator</span> it <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 通过 hasNext 方法判断，迭代器中是否还有元素</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Object</span> item <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Java 编译器为实现了 Iterable 接口的集合提供 <code>for-each</code> 语法糖, 可以使用更简洁的写法去进行遍历.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ls<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ls<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;def&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ls<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;ghi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token operator">:</span> ls<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="list-接口"><a href="#list-接口" class="header-anchor">#</a> List 接口</h3> <p><a href="http://itmyhome.com/java-api/index.html?java/util/List.html" target="_blank" rel="noopener noreferrer">🔗 List 接口 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>List 是元素有序并且可以重复的集合，被称为序列;</li> <li>可以根据元素的整数索引（在列表中的位置）访问元素，或针对指定位置精确添加/删除元素;</li> <li>下面具体实现类有:
<ul><li>ArrayList;</li> <li>LinkedList;</li> <li>Vector (已过时);</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-09-23-04-09.png" alt="2020-05-09-23-04-09"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-09-23-04-26.png" alt="2020-05-09-23-04-26"></p> <h4 id="listiterator"><a href="#listiterator" class="header-anchor">#</a> ListIterator</h4> <p><a href="http://itmyhome.com/java-api/java/util/ListIterator.html" target="_blank" rel="noopener noreferrer">🔗 ListIterator 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>List 接口中定义了方法, 用以获取特殊的迭代器 ListIterator, 称为『 列表迭代器 』</p> <p>除了允许 Iterator 接口提供的正常操作外，该迭代器还允许在遍历时, 向集合中插入/替换元素，以及双向访问。</p> <p>List 接口还提供了一个方法, 来获取从列表中指定位置开始的列表迭代器。</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-10-12-37-33.png" alt="2020-05-10-12-37-33"></p> <hr> <p>ListIterator 接口中的方法 👇:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-10-12-38-15.png" alt="2020-05-10-12-38-15"></p> <h4 id="arraylist"><a href="#arraylist" class="header-anchor">#</a> ArrayList</h4> <p><a href="http://itmyhome.com/java-api/java/util/ArrayList.html" target="_blank" rel="noopener noreferrer">🔗 ArrayList 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>集合中元素排列有序, 可以重复;</li> <li>底层使用数组实现;</li> <li>增加/删除元素, 速度慢;</li> <li>使用 <code>get</code> 和 <code>set</code> 进行随机访问, 速度快;</li> <li>当容量不够时, 可以自动扩容;</li> <li>ArrayList 线程是不同步的:
<ul><li>如果多个线程同时访问一个 ArrayList 实例，而其中至少一个线程从结构上修改了列表，那么它必须保持外部同步;</li> <li>结构上的修改, 是指任何添加/删除一个或多个元素的操作，或者显式调整底层数组的大小. 仅仅设置元素的值不是结构上的修改;</li> <li>因此使用迭代器遍历集合过程中，不可用其他方式修改集合结构，否则会引发异常;</li> <li>只能用迭代器自身的 <code>remove</code> 或 <code>add</code> 方法从结构上对列表进行修改;</li></ul></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// ArrayList 用法示例</span>
<span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> arrayList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

arrayList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;Evankaka&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
arrayList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;sihai&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
arrayList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;德德&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
arrayList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;Evankaka&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
arrayList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;小红&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 将索引位置为 2 的对象修改</span>
arrayList<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;sihai2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 将对象添加到索引位置为 3 的位置</span>
arrayList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;好好学java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 结果: Evankaka sihai sihai2 好好学java Evankaka 小红</span>


<span class="token comment">// 遍历方法 1</span>
<span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> it <span class="token operator">=</span> arrayList<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 遍历方法 2</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o <span class="token operator">:</span> arrayList<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 遍历方法 3</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arrayList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>arrayList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 删除元素</span>
arrayList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">&quot;Evankaka&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
arrayList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
it <span class="token operator">=</span> arrayList<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">String</span> s <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;好好学java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    it<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="linkedlist"><a href="#linkedlist" class="header-anchor">#</a> LinkedList</h4> <p><a href="http://itmyhome.com/java-api/java/util/LinkedList.html" target="_blank" rel="noopener noreferrer">🔗 LinkedList 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="http://itmyhome.com/java-api/java/util/Deque.html" target="_blank" rel="noopener noreferrer">🔗 Deque 接口 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>集合元素排列有序, 可重复;</li> <li>使用『 双向循环链表 』实现;</li> <li>查询速度慢;</li> <li>增加/删除元素, 速度快;</li> <li>和 ArrayList 一样, 线程是不同步的;</li> <li>除了实现 List 接口外，LinkedList 类还实现了 Deque 接口, 以使得 LinkedList 能够用作堆栈、队列或双端队列;</li></ul> <p><strong>LinkedList 基本操作</strong>:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> lList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 添加元素</span>
lList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

lList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取并移除此列表的第一个元素</span>
lList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取并移除此列表中指定位置的元素;</span>
lList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 清空列表</span>

<span class="token comment">// 将 LinkedList 转换成 ArrayList</span>
<span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> arrayList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>linkedList<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将 ArrayList 转换成 LinkedList</span>
<span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> linkedList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>arrayList<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>LinkedList 实现队列效果</strong>:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Queue</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">LinkedList</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Object</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    list<span class="token punctuation">.</span><span class="token function">addFirst</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">removeLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>LinkedList 实现堆栈效果</strong>:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">StackL</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">LinkedList</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">Object</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    list<span class="token punctuation">.</span><span class="token function">addFirst</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">removeFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="vector"><a href="#vector" class="header-anchor">#</a> Vector</h4> <p><a href="http://itmyhome.com/java-api/index.html?java/util/List.html" target="_blank" rel="noopener noreferrer">🔗 Vector 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>Vector 和 ArrayList 相似, 都是基于数组实现的, 有序的, 可以动态扩容的集合类;</li> <li>但是 Vector 方法调用是线程同步的;</li> <li>可以允许多个线程同时安全地访问一个 Vector 实例;</li> <li>但是同步操作需要耗费大量时间, 在性能上会有损耗;</li> <li>在大多数情况下, 并不需要使用 Vector, ArrayList 就可以了;</li></ul> <p>⚠️ 更具体的这里先略过.......</p> <h3 id="set-接口"><a href="#set-接口" class="header-anchor">#</a> Set 接口</h3> <p><a href="http://itmyhome.com/java-api/index.html?java/util/Set.html" target="_blank" rel="noopener noreferrer">🔗 Set 接口 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>Set 是元素不重复，排列无顺序的集合;</li> <li>主要有如下实现类:
<ul><li>HashSet;</li> <li>LinkedHashSet;</li> <li>TreeSet;</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-10-19-09-39.png" alt="2020-05-10-19-09-39"></p> <h4 id="hashset"><a href="#hashset" class="header-anchor">#</a> HashSet</h4> <p><a href="http://itmyhome.com/java-api/java/util/HashSet.html" target="_blank" rel="noopener noreferrer">🔗 HashSet 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>底层使用 Hash 表实现;</li> <li>添加/删除/访问元素的速度快;</li> <li>在将对象添加进 HashSet 集合中前, 会调用对象实例的 <code>hashCode</code> 方法来计算出哈希值;
<ul><li>如果想添加自定义的对象, 就要在定义类时重写 <code>hashCode</code> 方法;</li> <li>同样的对象实例, 调用 <code>hashCode</code> 方法的结果相同;</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-10-18-57-26.png" alt="2020-05-10-18-57-26"></p> <ul><li>根据算出的哈希值, 再计算出要在集合中储存位置的下标, 如果下标位置为空, 就直接储存;</li> <li>如果已经被占, 就将要储存的元素, 与已有元素进行 <code>equals</code> 比较, 如果相同, 就不存了. 如果不同, 就存到下标位置对应的链表中;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-10-19-02-34.png" alt="2020-05-10-19-02-34"></p> <p>📚 <strong>利用 HashSet 来存取自定义对象实例</strong>:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token comment">// 属性</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

  <span class="token comment">// 构造方法</span>
  <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 要让哈希表存储不重复的元素，就必须重写hasCode和equals方法</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">final</span> <span class="token keyword">int</span> prime <span class="token operator">=</span> <span class="token number">31</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      result <span class="token operator">=</span> prime <span class="token operator">*</span> result <span class="token operator">+</span> age<span class="token punctuation">;</span>
      result <span class="token operator">=</span> prime <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> name<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> obj<span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token class-name">Person</span> other <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>age <span class="token operator">!=</span> other<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>other<span class="token punctuation">.</span>name <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
              <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 利用 HashSet 来存取自定义对象 Person</span>
<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;李四&quot;</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;王五&quot;</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 已经有一个张三了, 这个就不存了</span>
</code></pre></div><h4 id="treeset"><a href="#treeset" class="header-anchor">#</a> TreeSet</h4> <p><a href="http://itmyhome.com/java-api/java/util/TreeSet.html" target="_blank" rel="noopener noreferrer">🔗 TreeSet 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>TreeSet 是一个有序集合;</li> <li>可以以任意顺序将元素存入进去. 但是对集合遍历时, 每个元素会按照排序后的顺序呈现;</li> <li>使用红黑树实现;</li> <li>因为存入 TreeSet 集合的元素是有顺序的, 所以元素间必须能够比较;
<ul><li>存入的对象必须实现了 Comparable 接口;</li> <li>或者在创建 TreeSet 实例时, 向构造器中传入实现了 Comparator 接口并重写了 <code>compare</code> 方法的实现类实例;</li> <li>如果都没有, 则 TreeSet 抛出异常;</li></ul></li></ul> <p>📚 下面用两种方式储存自定义对象到 TreeSet:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
  <span class="token comment">// 属性</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

  <span class="token comment">// 构造方法</span>
  <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

  <span class="token comment">// 比较规则是先按照 年龄排序，年龄相等的情况按照年龄排序</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">Person</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">-</span> o<span class="token punctuation">.</span>age<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 利用 TreeSet 来存储自定义类 Person 对象</span>
<span class="token class-name">TreeSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> treeSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

treeSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张山1&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
treeSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张山2&quot;</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
treeSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张山3&quot;</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
treeSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张山4&quot;</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
treeSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张山5&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 利用 TreeSet 来存储自定义类 Person 对象</span>
<span class="token comment">// 创建 TreeSet 对象的时候传入 Comparator 比较器，使用匿名内部类的方式.</span>

<span class="token class-name">TreeSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> treeSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">Person</span> o1<span class="token punctuation">,</span> <span class="token class-name">Person</span> o2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o1 <span class="token operator">==</span> o2<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> o1<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> o2<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> o1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>o2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

treeSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张山1&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
treeSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张山2&quot;</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
treeSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张山3&quot;</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
treeSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张山4&quot;</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
treeSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张山5&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="linkedhashset"><a href="#linkedhashset" class="header-anchor">#</a> LinkedHashSet</h4> <p><a href="http://itmyhome.com/java-api/java/util/LinkedHashSet.html" target="_blank" rel="noopener noreferrer">🔗 LinkedHashSet 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>采用哈希表储存, 用双向链表来记录插入顺序;</li> <li>集合中的元素可以有序地迭代;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-10-19-31-20.png" alt="2020-05-10-19-31-20"></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;李四&quot;</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;王五&quot;</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 遍历</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Person</span> p <span class="token operator">:</span> set<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 结果:</span>
<span class="token comment">// Person [name=张三, age=12]</span>
<span class="token comment">// Person [name=李四, age=13]</span>
<span class="token comment">// Person [name=王五, age=22]</span>
</code></pre></div><h3 id="queue-接口"><a href="#queue-接口" class="header-anchor">#</a> Queue 接口</h3> <p><a href="http://itmyhome.com/java-api/java/util/Queue.html" target="_blank" rel="noopener noreferrer">🔗 Queue 接口 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="http://itmyhome.com/java-api/java/util/Deque.html" target="_blank" rel="noopener noreferrer">🔗 Deque 接口 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>队列集合以 FIFO（先进先出）的方式存储各个元素;</li> <li>Deque 接口支持在两端插入/删除元素, 称作双端队列;
<ul><li>ArrayDeque 类和 LinkedList 类实现了 Deque 接口;</li></ul></li> <li>Queue 接口中的每种操作都存在两种形式, 操作失败时:
<ul><li>一种抛出异常;</li> <li>另一种返回一个特殊值（null 或 false）</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-10-20-01-31.png" alt="2020-05-10-20-01-31"></p> <h4 id="arraydeque"><a href="#arraydeque" class="header-anchor">#</a> ArrayDeque</h4> <p><a href="http://itmyhome.com/java-api/java/util/ArrayDeque.html" target="_blank" rel="noopener noreferrer">🔗 ArrayDeque 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>用数组来实现的队列;</li> <li>在用作堆栈时, 与 LinkedList 相比, 它随机访问性能更好;</li> <li>Stack 类继承自 Vector 类, 因为线程同步的原因, ArrayDeque 访问速度也更快;</li></ul> <h4 id="priorityqueue"><a href="#priorityqueue" class="header-anchor">#</a> PriorityQueue</h4> <p><a href="http://itmyhome.com/java-api/java/util/PriorityQueue.html" target="_blank" rel="noopener noreferrer">🔗 PriorityQueue 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>也称为『 优先级队列 』;</li> <li>实现逻辑是『 堆 』也称『 完全二叉树 』, 具体实现是数组;</li> <li>可以按照任意顺序插入元素, 但是总是按照排序的顺序进行检索;</li> <li>无论何时, 调用 <code>remove</code> 总会先删除优先级最高的元素;</li> <li>与 TreeSet 一样, PriorityQueue 既可以保存实现了 Comparable 接口的类对象, 也可以在构造器中直接传入实现了 Comparator 接口并重写了 compare 方法的实现类实例;</li> <li>使用优先级队列的典型示例是『 任务调度 』, 每一个任务有一个优先级, 任务以随机顺序添加到队列中, 每当启动一个新的任务时, 都将优先级最高的任务从队列中删除.</li></ul> <h3 id="map-接口"><a href="#map-接口" class="header-anchor">#</a> Map 接口</h3> <p><a href="http://itmyhome.com/java-api/index.html?java/util/Map.html" target="_blank" rel="noopener noreferrer">🔗 Map 接口 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>Map 集合用来存放键值对映射;</li> <li>通过『 键 』可以快速找到对应的『 值 』;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-10-21-06-25.png" alt="2020-05-10-21-06-25"></p> <h4 id="hashmap"><a href="#hashmap" class="header-anchor">#</a> HashMap</h4> <p><a href="http://itmyhome.com/java-api/java/util/HashMap.html" target="_blank" rel="noopener noreferrer">🔗 HashMap 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>排列无序, 键不可重复;</li> <li>基于哈希表实现;</li> <li>储存自定义对象, 要保证键的唯一性，需要覆盖自定义类的 <code>hashCode</code> 方法，和 <code>equals</code> 方法;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">HashMap</span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
users<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;11&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;张浩太&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将学生信息键值对存储到Map中</span>
users<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;22&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;刘思诚&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
users<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;33&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;王强文&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
users<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;44&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;李国量&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
users<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;55&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;王路路&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过 keySet 获得所有键组成的 Set 集合</span>
<span class="token class-name">Iterator</span> it <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 遍历 Map</span>
    <span class="token class-name">Object</span> key <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Object</span> val <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 通过 values 获取所有值组成的集合</span>
<span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> vs <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Iterator</span> it <span class="token operator">=</span> vs<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">String</span> value <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="treemap"><a href="#treemap" class="header-anchor">#</a> TreeMap</h4> <p><a href="http://itmyhome.com/java-api/java/util/TreeMap.html" target="_blank" rel="noopener noreferrer">🔗 TreeMap 类 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>基于红黑树实现;</li> <li>TreeMap 可以对集合中元素的键进行排序;</li> <li>和 TreeSet 一样原理，需要让存储在键位置的对象实现 Comparable 接口，重写 <code>compareTo</code> 方法;</li> <li>或者在创建 TreeMap 实例时, 向构造器中传入实现了 Comparator 接口并重写了 <code>compare</code> 方法的实现类实例;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;orange&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;pear&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// apple, orange, pear</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">Person</span> p1<span class="token punctuation">,</span> <span class="token class-name">Person</span> p2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> p1<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Tom&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Lily&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Person</span> key <span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// {Person: Bob}, {Person: Lily}, {Person: Tom}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

  <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;{Person: &quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;}&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="并发"><a href="#并发" class="header-anchor">#</a> 并发</h2> <ul><li><strong>进程</strong>: 一整个任务称为一个进程;
<ul><li>🌰 浏览器就是一个进程，视频播放器是一个进程, 音乐播放器和 Word 都是进程;</li></ul></li> <li><strong>线程</strong>: 进程内部还需要同时执行多个子任务, 这些子任务被称作线程;
<ul><li>一个进程可以包含一个或多个线程，但至少会有一个线程;</li> <li>🌰 Word 可以让我们一边打字，一边进行拼写检查;</li> <li>🌰 浏览器同时打开多个页面, 同时下载多个图片;</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-10-22-08-12.png" alt="2020-05-10-22-08-12"></p> <p>想在一个程序中执行多任务, 既可以由『 多进程实现 』，也可以由『 单进程内的多线程实现 』，还可以『 混合多进程＋多线程 』</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-10-22-10-26.png" alt="2020-05-10-22-10-26"></p> <p>具体采用哪种方式，要考虑到<strong>进程和线程的特点</strong>:</p> <ul><li>创建进程比创建线程开销大;</li> <li>进程独享一套自己的数据, 线程之间共享数据;</li> <li>共享数据使得线程之间通信比进程更高效;</li> <li>多进程稳定性比多线程高:
<ul><li>在多进程的情况下，一个进程崩溃不会影响其他进程;</li> <li>在多线程的情况下，一个线程崩溃会直接导致整个进程崩溃;</li></ul></li></ul> <h3 id="多线程基础"><a href="#多线程基础" class="header-anchor">#</a> 多线程基础</h3> <ul><li>Java 语言内置了多线程支持;</li> <li>一个 Java 程序实际上是一个 JVM 进程;</li> <li>JVM 进程用一个主线程来执行 <code>main()</code> 方法，在 <code>main()</code> 方法内部，我们又可以启动多个线程;</li> <li>和单线程相比，多线程经常需要读写共享数据，并且需要同步. 这使得多线程编程的复杂度高，调试更困难;</li> <li>Java 的网络、数据库、Web 开发等, 都依赖 Java 多线程编程;</li></ul> <h4 id="创建新线程"><a href="#创建新线程" class="header-anchor">#</a> 创建新线程</h4> <p>创建一个新线程非常容易，我们需要实例化一个 Thread 实例，然后调用它的 <code>start()</code> 方法;</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 启动新线程</span>
</code></pre></div><p>但是这个线程启动后实际上什么也不做就立刻结束了。我们希望新线程能执行指定的代码，有以下几种方法：</p> <p>📚 方法一: <strong>从 Thread 派生一个自定义类，然后覆写 <code>run()</code> 方法</strong>：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 启动新线程</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start new thread!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>📚 方法二: <strong>创建 Thread 实例时，传入一个 Runnable 实例</strong>：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 启动新线程</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyRunnable</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start new thread!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>用 Lambda 语法进一步简写为：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start new thread!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 启动新线程</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <p>在多个线程同时执行时, 执行顺序由操作系统调度，程序本身无法确定线程的调度顺序.</p> <p>为了让线程按想要的顺序执行, 可以在线程中调用 <code>Thread.sleep()</code>，强迫当前线程暂停一段时间：</p> <ul><li><code>sleep()</code> 传入的参数是毫秒;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;main start...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;thread run...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;thread end.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;main end...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 结果:</span>
<span class="token comment">// main start...</span>
<span class="token comment">// thread run...</span>
<span class="token comment">// thread end.</span>
<span class="token comment">// main end...</span>
</code></pre></div><hr> <p>可以对线程设定优先级，设定优先级的方法是 <code>Thread.setPriority(int n)</code> 参数取值范围 1~10, 1 最低, 10 最大, 默认值 5.</p> <ul><li>优先级高的线程被操作系统调度的优先级较高;</li> <li>操作系统对高优先级线程可能调度更频繁;</li> <li><strong>但不能通过设置优先级来确保高优先级的线程一定会先执行</strong>;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="线程的状态"><a href="#线程的状态" class="header-anchor">#</a> 线程的状态</h4> <p>在 Java 程序中，一个线程对象只能调用一次 <code>start()</code> 方法启动新线程，并在新线程中执行 <code>run()</code> 方法。一旦 <code>run()</code> 方法执行完毕，线程就结束了。因此，Java 线程的状态有以下几种:</p> <ul><li><strong>New</strong>：新创建的线程，尚未执行；</li> <li><strong>Runnable</strong>：运行中的线程，正在执行 run()方法的 Java 代码；</li> <li><strong>Blocked</strong>：运行中的线程，因为某些操作被阻塞而挂起；</li> <li><strong>Waiting</strong>：运行中的线程，因为某些操作在等待中；</li> <li><strong>Timed Waiting</strong>：运行中的线程，因为执行 <code>sleep()</code> 方法正在计时等待；</li> <li><strong>Terminated</strong>：线程已终止，因为 <code>run()</code> 方法执行完毕。</li></ul> <hr> <p>一个线程还可以通过 <code>join()</code> 方法等待另一个线程运行结束后在运行:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 结果:</span>
<span class="token comment">// start</span>
<span class="token comment">// hello</span>
<span class="token comment">// end</span>
</code></pre></div><ul><li>在 <code>main</code> 中让 <code>t</code> 调用 <code>join</code> 方法;</li> <li>主线程会等待 <code>t</code> 变量所表示的线程结束后在运行;</li></ul> <h4 id="中断线程"><a href="#中断线程" class="header-anchor">#</a> 中断线程</h4> <p>线程终止的原因有：</p> <ul><li>线程正常终止：<code>run()</code> 方法执行到 <code>return</code> 语句返回；</li> <li>线程意外终止：<code>run()</code> 方法因为未捕获的异常导致线程终止；</li> <li>对线程的 Thread 实例调用 <code>stop()</code> 方法强制终止;
<ul><li><code>stop</code> 是通过立即抛出 ThreadDeath 异常，来达到停止线程的目的, 可能会造成线程安全问题;</li> <li>不建议使用 <code>stop</code> 强制终止线程;</li></ul></li> <li>对线程实例调用 <code>interrupt</code> 方法可以给线程发送一个停止信号, 目标线程会反复检查自身是否为 <code>interrupted</code> 状态, 如果是就结束运行;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 暂停1毫秒</span>
        t<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 中断t线程</span>
        t<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 等待t线程结束</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            n <span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token string">&quot; hello!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>上面 👆 代码中, 在 <code>main</code> 线程中调用 <code>t.interrupt()</code> 方法中断 <code>t</code> 线程;</li> <li><code>interrupt()</code> 方法仅仅向 <code>t</code> 线程发出了“中断请求”;</li> <li><code>t</code> 线程的 <code>while</code> 循环会检测 <code>isInterrupted()</code> 来判断自己是否处于 <code>interrupted</code> 状态. 并据此来做出一些操作;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 中断t线程</span>
        t<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 等待t线程结束</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> hello <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HelloThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hello<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 启动hello线程</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            hello<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 等待hello线程结束</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;interrupted!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        hello<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">HelloThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            n<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token string">&quot; hello!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>如果线程处于等待状态，例如，<code>t.join()</code> 会让 <code>main</code> 线程进入等待状态;</li> <li>此时，如果对 <code>main</code> 线程调用 <code>interrupt()</code>，<code>join()</code> 方法会立刻抛出 InterruptedException;</li> <li>因此，目标线程只要捕获到 <code>join()</code> 方法抛出的 InterruptedException，就说明有其他线程对其调用了 <code>interrupt()</code> 方法，通常情况下该线程应该立刻结束运行;</li> <li>在上面 👆 的例子中:
<ul><li>main 线程通过调用 <code>t.interrupt()</code> 从而通知 <code>t</code> 线程中断，而此时 t 线程正位于 <code>hello.join()</code> 的等待中，此方法会立刻结束等待并抛出 InterruptedException;</li> <li>由于我们在 <code>t</code> 线程中捕获了 InterruptedException，因此，就可以准备结束该线程;</li> <li>在 <code>t</code> 线程结束前，对 <code>hello</code> 线程也进行了 <code>interrupt()</code> 调用通知其中断。如果去掉这一行代码，可以发现 <code>hello</code> 线程仍然会继续运行，且 JVM 不会退出;</li></ul></li></ul> <hr> <p>另一个常用的中断线程的方法是设置『 标志位 』:</p> <ul><li>通常会用一个 <code>running</code> 标志位来标识线程是否应该继续运行;</li> <li>在外部线程中，通过把线程实例的 <code>running</code> 属性置为 <code>false</code>，就可以让线程结束;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>  <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">HelloThread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HelloThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span>running <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 标志位置为false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">HelloThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">volatile</span> <span class="token keyword">boolean</span> running <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>running<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            n <span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token string">&quot; hello!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;end!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>👆 上面的 <code>running</code> 属性, 声明时使用 <code>volatile</code> 关键字标记;</li> <li>volatile 关键字用于声明线程间共享变量;</li> <li>在一个线程中修改了变量值, 再其他线程中能同步读取到最新的值;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-11-11-35-35.png" alt="2020-05-11-11-35-35"></p> <ul><li>在 Java 虚拟机中，变量的值保存在主内存中，但是，当线程访问变量时，它会先获取一个副本，并保存在自己的工作内存中;</li> <li>如果线程修改了变量的值，虚拟机会在某个时刻把修改后的值回写到主内存，但是这个时间是不确定的;</li> <li>这会导致如果一个线程更新了某个变量，另一个线程读取的值可能还是旧的. 这就造成了多线程之间共享的变量不一致;</li> <li><code>volatile</code> 关键字的目的是告诉虚拟机:
<ul><li>每次访问变量时，总是获取主内存的最新值;</li> <li>每次修改变量后，立刻回写到主内存;</li></ul></li> <li>但这会造成性能的损耗;</li></ul> <h4 id="守护线程"><a href="#守护线程" class="header-anchor">#</a> 守护线程</h4> <ul><li><p>Java 程序入口就是由 JVM 启动 <code>main</code> 线程，<code>main</code> 线程又可以启动其他线程。当所有线程都运行结束时，JVM 退出，进程结束;</p></li> <li><p>如果有一个线程没有退出，JVM 进程就不会退出。所以，必须保证所有线程都能及时结束;</p></li> <li><p>假如, 有一个线程在执行无限循环任务, 如果这个线程不结束，JVM 进程就无法结束. 那么由谁负责结束这个线程？</p></li> <li><p>执行这种任务的线程可以使用『 守护线程 』;</p></li> <li><p><strong>守护线程</strong>（Daemon Thread）是指为其他线程服务的线程;</p></li> <li><p>在 JVM 中，所有非守护线程都执行完毕后，无论有没有守护线程，虚拟机都会自动退出;</p></li> <li><p>因此，JVM 退出时，不必关心守护线程是否已结束;</p></li> <li><p>创建守护线程的方法和普通线程一样, 只是在调用 <code>start()</code> 方法前，调用 <code>setDaemon(true)</code> 把该线程标记为守护线程;</p></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
t<span class="token punctuation">.</span><span class="token function">setDaemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="实现-runnable-接口"><a href="#实现-runnable-接口" class="header-anchor">#</a> 实现 Runnable 接口</h4> <p><a href="http://itmyhome.com/java-api/java/lang/Runnable.html" target="_blank" rel="noopener noreferrer">🔗 Runnable 接口 API 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>上面 👆 我们通过创建继承了 Thread 的对象实例, 来创建一个新线程;</p> <p>我们还可以通过让一个类实现 Runnable 接口, 来让这个类的实例能够创建一个新线程, 并且执行其内部的代码;</p> <p>Runnable 接口内部只有一个 <code>run</code> 方法, 它没有返回值, 使用 Runnable 的实现类实例创建一个线程时，在线程中会执行类实例的 <code>run</code> 方法。</p> <p>因为 Java 只能单继承，因此如果是采用继承 Thread 的方法，那么在以后进行代码重构的时候就无法继承别的类了。</p> <p>有经验的程序员往往都会选择实现 Runnable 接口来进行多线程编程.</p> <p>其次，如果一个类继承 Thread，则不适合资源共享。但是如果实现了 Runable 接口的话，则很容易的实现资源共享。</p> <p>🌰 下面来看一下 Thread 和 Runnable 它们使用上的区别:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">testThread</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">&quot;运行  count= &quot;</span> <span class="token operator">+</span> count<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> main <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TestThread</span> mTh1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestThread</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">TestThread</span> mTh2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestThread</span><span class="token punctuation">(</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTh1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTh2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面 👆 创建了两个 TestThread 类实例, 它们内部的属性属于各自的实例;</p> <p>改成用 Runnable 接口实现类来写, 就可以很轻松做到资源共享:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestRunnable</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;运行  count= &quot;</span> <span class="token operator">+</span> count<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> main <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TestRunnable</span> mTh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>mTh<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>mTh<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>mTh<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="线程同步"><a href="#线程同步" class="header-anchor">#</a> 线程同步</h3> <p>当多个线程同时运行时，线程的调度由操作系统决定，程序本身无法决定。因此，任何一个线程都有可能在任何指令处被操作系统暂停，然后在某个时间段后继续执行。</p> <p>这样的话, 如果多个线程同时读写共享变量，会出现数据不一致的问题.</p> <p>因为对变量进行读取和写入时，结果要正确，必须保证是<strong>原子操作</strong>。原子操作是指不能被中断的一个, 或一系列操作。</p> <ul><li>🌰 例如，对于语句：<code>n = n + 1;</code></li> <li>看上去是一行语句，实际上对应了 3 条指令：
<ul><li>ILOAD 读取;</li> <li>IADD 相加;</li> <li>ISTORE 储存;</li></ul></li></ul> <p>假设 <code>n</code> 的值是 100，如果两个线程同时执行 <code>n = n + 1</code>，得到的结果很可能不是 <code>102</code>，而是 <code>101</code>，原因在于：</p> <ul><li>如果线程 1 在执行 ILOAD 后被操作系统中断;</li> <li>此刻如果线程 2 被调度执行，它执行 ILOAD 后获取的值仍然是 100;</li> <li>最终结果被两个线程的 ISTORE 写入后变成了 101，而不是期待的 102;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-11-12-23-00.png" alt="2020-05-11-12-23-00"></p> <h4 id="加锁-解锁"><a href="#加锁-解锁" class="header-anchor">#</a> 加锁 &amp; 解锁</h4> <p>多线程模型下，要保证逻辑正确，对共享变量进行读写时，必须保证一组指令以『 原子方式 』执行：<strong>即某一个线程执行时，其他线程必须等待</strong>;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-11-12-25-21.png" alt="2020-05-11-12-25-21"></p> <ul><li>通过 <strong>加锁</strong> 和 <strong>解锁</strong> 的操作，就能保证一组指令在线程中执行时, 不能被打断;</li> <li>加锁和解锁之间的代码块我们称之为 <strong>临界区</strong>, 任何时候临界区最多只有一个线程能执行;</li> <li>Java 程序使用 <code>synchronized</code> 关键字对一个对象进行加锁;
<ul><li>首先, 找出修改共享变量的线程中的代码块;</li> <li>选择一个共享实例作为锁;</li> <li>然后用 <code>synchronized(lock) { ... }</code> 包裹这部分代码;</li></ul></li></ul> <p>🌰 下面展示了如何在程序中使用 <code>synchronized</code> 定义一个临界区:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> add <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AddThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> dec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        add<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dec<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        add<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dec<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AddThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 定义临界区</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Counter</span><span class="token punctuation">.</span>count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">DecThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 定义临界区</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Counter</span><span class="token punctuation">.</span>count <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 结果: 0</span>
</code></pre></div><ul><li>例子中, 用 <code>Counter.lock</code> 实例作为锁;</li> <li>两个线程在执行各自的 <code>synchronized(Counter.lock) { ... }</code> 代码块时，必须先获得锁，才能进入代码块。在 <code>synchronized</code> 语句块结束会自动释放锁;</li> <li>这样一来，对 <code>Counter.count</code> 变量进行读写就不可能同时进行。上述代码无论运行多少次，最终结果都是 0;</li></ul> <hr> <p>在使用 <code>synchronized</code> 的时候，不必担心抛出异常。因为无论是否有异常，都会在 <code>synchronized</code> 结束处正确释放锁;</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+=</span> m<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token comment">// 无论有无异常，都会在此释放锁</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <p><strong>JVM 规范定义了几种原子操作</strong>, 它们是不需要 <code>synchronized</code> 的操作:</p> <ul><li>基本类型（<code>long</code> 和 <code>double</code> 除外）赋值，例如：<code>int n = m</code>；
<ul><li><code>long</code> 和 <code>double</code> 是 64 位数据，JVM 没有明确规定 64 位赋值操作是不是一个原子操作;</li></ul></li> <li>引用类型赋值，例如：<code>List&lt;String&gt; list = anotherList</code>;</li></ul> <p>🌰 例如, 下面的代码就不需要 <code>synchronized</code>:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span><span class="token punctuation">(</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> m<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 可以写成</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <p>让线程自己选择锁对象往往会使得代码逻辑混乱，也不利于封装。<strong>更好的方法是把 <code>synchronized</code> 逻辑封装起来</strong>。</p> <p>🌰 例如，我们编写一个计数器如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dec</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            count <span class="token operator">-=</span> n<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> count<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li>线程调用 <code>add()</code>、<code>dec()</code>方法时，它不必关心同步逻辑，因为 <code>synchronized</code> 代码块在 <code>add()</code>、<code>dec()</code>方法内部;</li> <li><code>并且，我们注意到，synchronized</code> 锁住的对象是 <code>this</code>，即当前实例，这又使得创建多个 Counter 实例的时候，它们之间互不影响，可以并发执行;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">var</span> c1 <span class="token operator">=</span> <span class="token class-name">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c2 <span class="token operator">=</span> <span class="token class-name">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 对c1进行操作的线程:</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    c1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    c1<span class="token punctuation">.</span><span class="token function">dec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 对c2进行操作的线程:</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    c2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    c2<span class="token punctuation">.</span><span class="token function">dec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>✏️ <strong>线程安全</strong>: 如果一个类被设计为允许多线程正确访问，我们就说这个类就是线程安全的（thread-safe）</p> <p>有一些类, 它们的所有成员变量都是 <code>final</code>，多线程同时访问时只能读不能写，这些不变类也是线程安全的.</p> <p>还有一些类, 它们只提供 <code>static</code> 静态方法，没有成员变量的类，也是线程安全的;</p> <p>非线程安全的类实例, 如果在各个线程中只读取, 而不写入, 那么这个实例也是可以安全地在线程间共享的;</p> <h4 id="同步方法"><a href="#同步方法" class="header-anchor">#</a> 同步方法</h4> <p>我们再观察 Counter 的代码:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>add</code> 方法中锁住的是调用 <code>add</code> 方法的 Counter 实例.</p> <p>这时, 实际上可以用 <code>synchronized</code> 修饰这个方法. 用 <code>synchronized</code> 修饰的方法就是同步方法，它表示整个方法都必须用 <code>this</code> 实例加锁:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对于 <code>static</code> 方法，是没有 <code>this</code> 实例的，但任何一个类都有一个由 JVM 自动创建的 Class 实例. 所以对 <code>static</code> 方法添加 <code>synchronized</code>，锁住的是该类的 Class 实例:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>等价于:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="可重入锁-死锁"><a href="#可重入锁-死锁" class="header-anchor">#</a> 可重入锁 &amp; 死锁</h4> <p>✏️ <strong>可重入锁</strong>: JVM 允许同一个线程重复获取同一个锁，这种能被同一个线程反复获取的锁，就叫做『 可重入锁 』</p> <ul><li>上面 👆 用 <code>synchronized</code> 声明的线程锁就是可重入锁;</li></ul> <p>🌰 下面的代码中, 在一个同步方法中, 调用了另一个同步方法;</p> <ul><li>当在一个线程中调用 Counter 实例的 <code>add</code> 方法, 其内部的 <code>dec</code> 方法也可以执行. 因为是在同一个线程中;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">dec</span><span class="token punctuation">(</span><span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用另一个同步方法</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">dec</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <p>✏️ <strong>死锁</strong>: 当两个线程各自持有不同的锁，然后各自试图获取对方手里的锁, 造成了双方无限等待下去，这就是『 死锁 』:</p> <ul><li>死锁发生后，没有任何机制能解除死锁，只能强制结束 JVM 进程;</li> <li>在编写多线程应用时，要特别注意防止死锁。因为死锁一旦形成，就只能强制结束进程;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span><span class="token punctuation">(</span>lockA<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 获得lockA的锁</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+=</span> m<span class="token punctuation">;</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span>lockB<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 获得lockB的锁</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>another <span class="token operator">+=</span> m<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token comment">// 释放lockB的锁</span>
    <span class="token punctuation">}</span> <span class="token comment">// 释放lockA的锁</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dec</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span><span class="token punctuation">(</span>lockB<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 获得lockB的锁</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>another <span class="token operator">-=</span> m<span class="token punctuation">;</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span>lockA<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 获得lockA的锁</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">-=</span> m<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token comment">// 释放lockA的锁</span>
    <span class="token punctuation">}</span> <span class="token comment">// 释放lockB的锁</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>对于上述代码，线程 1 和线程 2 如果分别执行 <code>add()</code> 和 <code>dec()</code> 方法时:
<ul><li>线程 1：进入 <code>add()</code>，获得 <code>lockA</code>;</li> <li>线程 2：进入 <code>dec()</code>，获得 <code>lockB</code>;</li></ul></li> <li>之后:
<ul><li>线程 1：准备获得 <code>lockB</code>，失败，等待中;</li> <li>线程 2：准备获得 <code>lockA</code>，失败，等待中;</li></ul></li> <li>这就造成了死锁;</li></ul> <p><strong>想要避免死锁, 线程获取锁的顺序要一致</strong>. 上面 👆 的例子可以改写成:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span><span class="token punctuation">(</span>lockA<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 获得lockA的锁</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+=</span> m<span class="token punctuation">;</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span>lockB<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 获得lockB的锁</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>another <span class="token operator">+=</span> m<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token comment">// 释放lockB的锁</span>
    <span class="token punctuation">}</span> <span class="token comment">// 释放lockA的锁</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dec</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span><span class="token punctuation">(</span>lockA<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 获得lockA的锁</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">-=</span> m<span class="token punctuation">;</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span>lockB<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 获得lockB的锁</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>another <span class="token operator">-=</span> m<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token comment">// 释放lockB的锁</span>
    <span class="token punctuation">}</span> <span class="token comment">// 释放lockA的锁</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="wait-notify"><a href="#wait-notify" class="header-anchor">#</a> wait &amp; notify</h4> <p>在上面 👆, 我们用 <code>synchronized</code> 解决了多线程竞争的问题, 也就是多个线程同时访问一个实例对象, 谁先谁后的问题.</p> <p>但是 <code>synchronized</code> 并没有解决 <strong>多线程协调</strong> 的问题。</p> <p>🌰 例如, 下面是一个任务队列, 里面用 <code>addTask</code> 方法添加任务, <code>getTask</code> 方法获取任务:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">TaskQueue</span> <span class="token punctuation">{</span>
    <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">addTask</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token class-name">String</span> <span class="token function">getTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 任务队列为空, 等待任务</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> queue<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>上面 👆 代码设想的功能是:
<ul><li><code>getTask()</code> 内部先判断队列是否为空，如果为空，就循环等待;</li> <li>直到另一个线程调用 <code>addTask()</code> 往队列中放入了一个任务，<code>while</code> 循环退出，返回列表中的添加的任务;</li></ul></li> <li>但实际上 <code>while()</code> 循环永远不会退出。因为线程在执行 <code>while()</code> 循环时，已经在 <code>getTask()</code> 入口获取了 <code>this</code> 锁;</li> <li>其他线程根本无法调用 <code>addTask()</code>，因为 <code>addTask()</code> 执行条件也是获取 <code>this</code> 锁。</li></ul> <p>想要实现的 <strong>多线程协调运行</strong> 的原则就是：</p> <ul><li>当条件不满足时，线程进入等待状态;</li> <li>当条件满足时，线程被唤醒，继续执行任务;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token class-name">String</span> <span class="token function">getTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 释放this锁:</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 重新获取this锁</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> queue<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>wait()</code> 方法必须在当前获取的锁对象上调用;
<ul><li>上面 👆 代码中获取的是 <code>this</code> 锁，因此调用 <code>this.wait()</code>;</li></ul></li> <li>调用 <code>wait()</code> 方法后，线程进入等待状态, <code>wait()</code> 方法不会返回，直到将来某个时刻，线程从等待状态被其他线程唤醒后，<code>wait()</code> 方法才会返回，然后继续执行下一条语句;</li> <li><code>wait()</code> 方法调用时，会释放 <code>synchronized</code> 块获得的锁，<code>wait()</code> 方法返回后，线程又会重新试图获得锁;</li></ul> <p>在调用 <code>wait()</code> 方法的锁对象上调用 <code>notify()</code> 方法让等待的线程被重新唤醒;</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">addTask</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 唤醒在this锁等待的线程</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>在往队列中添加了任务后，线程立刻对 <code>this</code> 锁对象调用 <code>notify()</code> 方法，这个方法会唤醒一个正在 <code>this</code> 锁等待的线程;</li></ul> <p>可能有多个线程都在等待, 这时 <code>notify()</code> 只会唤醒其中一个, 具体哪个依赖操作系统，有一定的随机性;</p> <p>使用 <code>notifyAll()</code> 将唤醒所有当前正在等待的线程;</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">addTask</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="使用-reentrantlock"><a href="#使用-reentrantlock" class="header-anchor">#</a> 使用 ReentrantLock</h4> <p>从 Java 5 开始，引入了一个高级的处理并发的 <code>java.util.concurrent</code> 包，它提供了大量更高级的并发功能，能大大简化多线程程序的编写.</p> <p><code>java.util.concurrent.locks</code> 包提供的 <code>ReentrantLock</code> 用于替代 <code>synchronized</code> 加锁</p> <p>🌰 先看一个 <code>synchronized</code> 版本:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以使用 <code>ReentrantLock</code> 替换成:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>因为 <code>synchronized</code> 是 Java 语言层面提供的语法，所以我们不需要考虑异常;</li> <li>而 <code>ReentrantLock</code> 是 Java 代码实现的锁，我们就必须先获取锁，然后在 <code>finally</code> 中正确释放锁;</li> <li>和 <code>synchronized</code> <code>一样，ReentrantLock</code> 是可重入锁, 一个线程可以多次获取同一个锁;</li></ul> <p>和 <code>synchronized</code> 不同的是，<code>ReentrantLock</code> 可以尝试获取锁：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>lock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>上述代码在尝试获取锁的时候，最多等待 1 秒。如果 1 秒后仍未获取到锁，<code>tryLock()</code> 返回 <code>false</code></li> <li>使用 <code>ReentrantLock</code> 比直接使用 <code>synchronized</code> 更安全，线程在 <code>tryLock()</code> 失败的时候不会导致死锁;</li></ul> <hr> <p><code>synchronized</code> 可以配合 <code>wait</code> 和 <code>notify</code> 实现线程在条件不满足时等待，条件满足时唤醒.</p> <p><code>ReentrantLock</code> 中使用 <code>Condition</code> 对象来实现 <code>wait</code> 和 <code>notify</code> 的功能。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">TaskQueue</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Condition</span> condition <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">newCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addTask</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
            condition<span class="token punctuation">.</span><span class="token function">signalAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                condition<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> queue<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>Condition 对象实例从 <code>Lock</code> 实例的 <code>newCondition()</code>返回，这样才能获得一个绑定了 <code>Lock</code> 实例的 <code>Condition</code> 实例;</li> <li>Condition 提供的 <code>await()</code>、<code>signal()</code>、<code>signalAll()</code> 原理和 <code>synchronized</code> 锁对象的 <code>wait()</code>、<code>notify()</code>、<code>notifyAll()</code> 是一致的，并且其行为也是一样的;</li> <li>和 <code>tryLock()</code> 类似，<code>await()</code> 可以在等待指定时间后，如果还没有被其他线程唤醒，可以自己醒来;
<ul><li>🌰 <code>condition.await(1, TimeUnit.SECOND)</code></li></ul></li></ul> <h4 id="使用-concurrent-集合"><a href="#使用-concurrent-集合" class="header-anchor">#</a> 使用 Concurrent 集合</h4> <p>👆 前面已经通过 <code>ReentrantLock</code> 和 <code>Condition</code> 实现了一个线程安全的任务队列 <code>TaskQueue</code>.</p> <p>在实际开发中, 我们并不需要自己去实现. Java 标准库的 <code>java.util.concurrent</code> 包提供的线程安全的集合<code>ArrayBlockingQueue</code>。</p> <p>除此之外, 针对 List、Map、Set、Deque 等，<code>java.util.concurrent</code> 包也提供了对应的并发集合类:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-11-19-52-47.png" alt="2020-05-11-19-52-47"></p> <p>所有的同步和加锁的逻辑都在集合内部实现, 所以这些并发集合与使用非线程安全的集合类完全相同.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 在不同的线程读写:</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="线程池"><a href="#线程池" class="header-anchor">#</a> 线程池</h3> <p>创建线程需要花费操作系统资源（线程资源，栈空间等），频繁
创建和销毁大量线程需要消耗大量时间。</p> <p>可以设想, 我们创建一组线程, 当有任务需要线程时, 就分配给它一个, 等他用完再还回来, 而不是销毁. 这样要比每次有任务就创建一个新线程, 然后用完就销毁, 要高效的多.</p> <p>这种能接收大量小任务并进行分发处理的就是『 <strong>线程池</strong> 』</p> <ul><li>线程池内部维护了若干个线程，没有任务的时候，这些线程都处于等待状态;</li> <li>如果有新任务，就分配一个空闲线程执行;</li> <li>如果所有线程都处于忙碌状态，新任务要么放入队列等待，要么增加一个新线程进行处理;</li></ul> <hr> <p>Java 标准库提供了 <code>ExecutorService</code> 接口表示线程池. Java 标准库提供的几个常用实现类有：</p> <ul><li><strong>FixedThreadPool</strong>：线程数固定的线程池；</li> <li><strong>CachedThreadPool</strong>：线程数根据任务动态调整的线程池；</li> <li><strong>SingleThreadExecutor</strong>：仅单线程执行的线程池。</li></ul> <p>创建这些线程池的方法都被封装到 <code>Executors</code> 这个类中.</p> <p>🌰 例子, 下面创建了一个有 4 个线程的 <code>FixedThreadPool</code> 线程池:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent</span><span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 创建一个固定大小的线程池:</span>
        <span class="token class-name">ExecutorService</span> es <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            es<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 关闭线程池:</span>
        es<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Task</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start task &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;end task &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
结果:
  start task 1
  start task 3
  start task 0
  start task 2
  end task 1
  end task 3
  end task 2
  end task 0
  start task 4
  start task 5
  end task 4
  end task 5
*/</span>
</code></pre></div><ul><li>一次性放入 6 个任务，由于线程池只有固定的 4 个线程，因此，前 4 个任务会同时执行，等到有线程空闲后，才会执行后面的两个任务;</li> <li>线程池在程序结束的时候要关闭:
<ul><li><code>shutdown()</code> 方法关闭线程池的时候，它会等待正在执行的任务先完成，然后再关闭;</li> <li><code>shutdownNow()</code> 会立刻停止正在执行的任务;</li> <li><code>awaitTermination()</code> 则会等待指定的时间让线程池关闭;</li></ul></li></ul> <h4 id="使用-future"><a href="#使用-future" class="header-anchor">#</a> 使用 Future</h4> <p>在执行多个任务的时候，使用 Java 标准库提供的线程池是非常方便的。我们提交的任务只需要实现 Runnable 接口，就可以让线程池去执行.</p> <p>但 Runnable 接口有个问题，它的方法没有返回值。如果任务需要一个返回结果，那么只能保存到变量，还要提供额外的方法读取，非常不便。</p> <p>所以，Java 标准库还提供了一个 Callable 接口，和 Runnable 接口比，它多了一个返回值.</p> <p>并且 Callable 接口是一个泛型接口，可以返回指定类型的结果。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Task</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">longTimeCalculation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>现在的问题是，如何获得异步执行的结果？</p> <p><code>ExecutorService.submit()</code> 返回了一个 Future 类型对象，它代表一个未来能获取结果的对象.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 定义任务:</span>
<span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 提交任务并获得Future:</span>
<span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> executor<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 从Future获取异步执行返回的结果:</span>
<span class="token class-name">String</span> result <span class="token operator">=</span> future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 可能阻塞</span>
</code></pre></div><p>在某个时刻调用 Future 对象的 <code>get()</code> 方法，就可以获得异步执行的结果:</p> <ul><li>在调用 <code>get()</code> 时，如果异步任务已经完成，我们就直接获得结果;</li> <li>如果异步任务还没有完成，那么 <code>get()</code> 会阻塞，直到任务完成后才返回结果;</li></ul> <p>一个实现了 <code>Future&lt;V&gt;</code> 接口的类表示一个未来可能会返回的结果，它定义的方法有：</p> <ul><li><code>get()</code>：获取结果（可能会等待）</li> <li><code>get(long timeout, TimeUnit unit)</code>：获取结果，但只等待指定的时间；</li> <li><code>cancel(boolean mayInterruptIfRunning)</code>：取消当前任务；</li> <li><code>isDone()</code>：判断任务是否已完成;</li></ul> <h4 id="使用-completablefuture"><a href="#使用-completablefuture" class="header-anchor">#</a> 使用 CompletableFuture</h4> <p>前面说, 使用 <code>Future</code> 类型实例的 <code>get</code> 方法获取异步结果, 可能会造成阻塞.</p> <p>从 Java 8 开始引入了 <code>CompletableFuture</code>，它针对 <code>Future</code> 做了改进，可以传入回调对象，当异步任务完成或者发生异常时，自动调用回调方法.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建异步执行任务:</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> cf <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">fetchPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 如果执行成功:</span>
    cf<span class="token punctuation">.</span><span class="token function">thenAccept</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;price: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 如果执行异常:</span>
    cf<span class="token punctuation">.</span><span class="token function">exceptionally</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 主线程不要立刻结束，否则 CompletableFuture 默认使用的线程池会立刻关闭:</span>
    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token class-name">Double</span> <span class="token function">fetchPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;fetch price failed!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>CompletableFuture 更强大的功能是，多个 CompletableFuture 可以<strong>串行执行</strong>.</p> <p>🌰 例如，定义两个 CompletableFuture:</p> <ul><li>第一个 CompletableFuture 根据证券名称查询证券代码;</li> <li>第二个 CompletableFuture 根据证券代码查询证券价格;</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// 第一个任务:</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> cfQuery <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">queryCode</span><span class="token punctuation">(</span><span class="token string">&quot;中国石油&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// cfQuery成功后继续执行下一个任务:</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> cfFetch <span class="token operator">=</span> cfQuery<span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">fetchPrice</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// cfFetch成功后打印结果:</span>
    cfFetch<span class="token punctuation">.</span><span class="token function">thenAccept</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;price: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 主线程不要立刻结束，否则CompletableFuture默认使用的线程池会立刻关闭:</span>
    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">queryCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&quot;601857&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token class-name">Double</span> <span class="token function">fetchPrice</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>除了串行执行外，多个 CompletableFuture 还可以<strong>并行执行</strong>。</p> <p>🌰 例如，同时从新浪和网易查询证券代码，只要任意一个返回结果，就进行下一步查询价格，查询价格也同时从新浪和网易查询，只要任意一个返回结果:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// 两个CompletableFuture执行异步查询:</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> cfQueryFromSina <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">queryCode</span><span class="token punctuation">(</span><span class="token string">&quot;中国石油&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https://finance.sina.com.cn/code/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> cfQueryFrom163 <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">queryCode</span><span class="token punctuation">(</span><span class="token string">&quot;中国石油&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https://money.163.com/code/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 用anyOf合并为一个新的CompletableFuture:</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> cfQuery <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">anyOf</span><span class="token punctuation">(</span>cfQueryFromSina<span class="token punctuation">,</span> cfQueryFrom163<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 两个CompletableFuture执行异步查询:</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> cfFetchFromSina <span class="token operator">=</span> cfQuery<span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">fetchPrice</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> code<span class="token punctuation">,</span> <span class="token string">&quot;https://finance.sina.com.cn/price/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> cfFetchFrom163 <span class="token operator">=</span> cfQuery<span class="token punctuation">.</span><span class="token function">thenApplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">fetchPrice</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> code<span class="token punctuation">,</span> <span class="token string">&quot;https://money.163.com/price/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 用anyOf合并为一个新的CompletableFuture:</span>
    <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> cfFetch <span class="token operator">=</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">anyOf</span><span class="token punctuation">(</span>cfFetchFromSina<span class="token punctuation">,</span> cfFetchFrom163<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 最终结果:</span>
    cfFetch<span class="token punctuation">.</span><span class="token function">thenAccept</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;price: &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 主线程不要立刻结束，否则CompletableFuture默认使用的线程池会立刻关闭:</span>
    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">queryCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;query code from &quot;</span> <span class="token operator">+</span> url <span class="token operator">+</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token string">&quot;601857&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token class-name">Double</span> <span class="token function">fetchPrice</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;query price from &quot;</span> <span class="token operator">+</span> url <span class="token operator">+</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>anyOf()</code> 可以实现“任意个 CompletableFuture 只要一个成功”;</li> <li><code>allOf()</code> 可以实现“所有 CompletableFuture 都必须成功”</li></ul> <h4 id="使用-threadlocal"><a href="#使用-threadlocal" class="header-anchor">#</a> 使用 ThreadLocal</h4> <p>Java 中的 <code>ThreadLocal</code> 类允许我们创建只能被同一个线程读写的 <strong>线程局部变量</strong>。</p> <p>因此，如果一段代码含有一个 <code>ThreadLocal</code> 变量的引用，即使两个线程同时执行这段代码，它们也无法访问到对方的 <code>ThreadLocal</code> 变量。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">ThreadLocal</span> myThreadLocal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>只需要实例化 <code>ThreadLocal</code> 对象一次，并且也不需要知道它是被哪个线程实例化。虽然所有的线程都能访问到这个 <code>ThreadLocal</code> 实例，但是每个线程却只能访问到自己通过调用 <code>ThreadLocal</code> 的 <code>set()</code> 方法设置的值。</p> <p>通过 <code>get()</code> 方法可以获取存入的值.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> threadLocalValue <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> myThreadLocal<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可以创建一个指定泛型类型的 <code>ThreadLocal</code> 对象，这样我们就不需要每次对使用 <code>get()</code> 方法返回的值作强制类型转换了。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> myThreadLocal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们可以通过创建一个 <code>ThreadLocal</code> 的子类并且重写 <code>initialValue()</code> 方法，来为一个 <code>ThreadLocal</code> 对象指定一个初始值。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> myThreadLocal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">initialValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">&quot;This is the initial value&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>🌰 下面是一个完整的例子:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadLocalExample</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MyRunnable</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">ThreadLocal</span> threadLocal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      threadLocal<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100D</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadLocal<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">MyRunnable</span> sharedRunnableInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Thread</span> thread1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>sharedRunnableInstance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Thread</span> thread2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>sharedRunnableInstance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    thread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="相关参考"><a href="#相关参考" class="header-anchor">#</a> 相关参考</h2> <ul><li><a href="http://itmyhome.com/java-api/overview-summary.html" target="_blank" rel="noopener noreferrer">Java 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.javatpoint.com/java-tutorial" target="_blank" rel="noopener noreferrer">教程 - java T point<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.liaoxuefeng.com/wiki/1252599548343744" target="_blank" rel="noopener noreferrer">廖雪峰的 Java 教程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://book.douban.com/subject/26880667/" target="_blank" rel="noopener noreferrer">书籍 - Java 核心技术 卷 1<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">7/3/2020, 4:14:54 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my-notebook/assets/js/app.7c72f570.js" defer></script><script src="/my-notebook/assets/js/2.a47e0c14.js" defer></script><script src="/my-notebook/assets/js/166.046085b9.js" defer></script>
  </body>
</html>
