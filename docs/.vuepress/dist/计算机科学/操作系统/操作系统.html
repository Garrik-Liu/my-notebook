<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>操作系统 | Garrik 的笔记</title>
    <meta name="description" content="这里是 Garrik 的前端笔记本">
    
    
    <link rel="preload" href="/my-notebook/assets/css/0.styles.09dde1b2.css" as="style"><link rel="preload" href="/my-notebook/assets/js/app.f62ca298.js" as="script"><link rel="preload" href="/my-notebook/assets/js/2.a47e0c14.js" as="script"><link rel="preload" href="/my-notebook/assets/js/206.644515cf.js" as="script"><link rel="prefetch" href="/my-notebook/assets/js/10.8997541a.js"><link rel="prefetch" href="/my-notebook/assets/js/100.427dc936.js"><link rel="prefetch" href="/my-notebook/assets/js/101.2e64c5de.js"><link rel="prefetch" href="/my-notebook/assets/js/102.a5c08049.js"><link rel="prefetch" href="/my-notebook/assets/js/103.9ef8a25f.js"><link rel="prefetch" href="/my-notebook/assets/js/104.aa49d776.js"><link rel="prefetch" href="/my-notebook/assets/js/105.3d62823a.js"><link rel="prefetch" href="/my-notebook/assets/js/106.54cd26d1.js"><link rel="prefetch" href="/my-notebook/assets/js/107.1236bf01.js"><link rel="prefetch" href="/my-notebook/assets/js/108.0c0dd474.js"><link rel="prefetch" href="/my-notebook/assets/js/109.7d87ad2b.js"><link rel="prefetch" href="/my-notebook/assets/js/11.4c887f62.js"><link rel="prefetch" href="/my-notebook/assets/js/110.253e892d.js"><link rel="prefetch" href="/my-notebook/assets/js/111.357035da.js"><link rel="prefetch" href="/my-notebook/assets/js/112.ee568638.js"><link rel="prefetch" href="/my-notebook/assets/js/113.4f9a88f2.js"><link rel="prefetch" href="/my-notebook/assets/js/114.cddcb8eb.js"><link rel="prefetch" href="/my-notebook/assets/js/115.e38e51e2.js"><link rel="prefetch" href="/my-notebook/assets/js/116.b5ca4479.js"><link rel="prefetch" href="/my-notebook/assets/js/117.2eecd643.js"><link rel="prefetch" href="/my-notebook/assets/js/118.fe17a03a.js"><link rel="prefetch" href="/my-notebook/assets/js/119.f3d7e15e.js"><link rel="prefetch" href="/my-notebook/assets/js/12.50e8875e.js"><link rel="prefetch" href="/my-notebook/assets/js/120.cddae5a5.js"><link rel="prefetch" href="/my-notebook/assets/js/121.7a1aaaf2.js"><link rel="prefetch" href="/my-notebook/assets/js/122.1db1e2df.js"><link rel="prefetch" href="/my-notebook/assets/js/123.ee10ea32.js"><link rel="prefetch" href="/my-notebook/assets/js/124.c76722d5.js"><link rel="prefetch" href="/my-notebook/assets/js/125.d0c3953b.js"><link rel="prefetch" href="/my-notebook/assets/js/126.f75354ce.js"><link rel="prefetch" href="/my-notebook/assets/js/127.b54cd127.js"><link rel="prefetch" href="/my-notebook/assets/js/128.d16b7a8b.js"><link rel="prefetch" href="/my-notebook/assets/js/129.95539f27.js"><link rel="prefetch" href="/my-notebook/assets/js/13.7cbb18ca.js"><link rel="prefetch" href="/my-notebook/assets/js/130.70edbd71.js"><link rel="prefetch" href="/my-notebook/assets/js/131.b1916871.js"><link rel="prefetch" href="/my-notebook/assets/js/132.500d9566.js"><link rel="prefetch" href="/my-notebook/assets/js/133.bced79a6.js"><link rel="prefetch" href="/my-notebook/assets/js/134.5c11ebe4.js"><link rel="prefetch" href="/my-notebook/assets/js/135.c646dd2c.js"><link rel="prefetch" href="/my-notebook/assets/js/136.5d84b002.js"><link rel="prefetch" href="/my-notebook/assets/js/137.590ae040.js"><link rel="prefetch" href="/my-notebook/assets/js/138.022bbe99.js"><link rel="prefetch" href="/my-notebook/assets/js/139.4a2bd903.js"><link rel="prefetch" href="/my-notebook/assets/js/14.86d621aa.js"><link rel="prefetch" href="/my-notebook/assets/js/140.d411f1ae.js"><link rel="prefetch" href="/my-notebook/assets/js/141.82f2a6c4.js"><link rel="prefetch" href="/my-notebook/assets/js/142.a1b070fd.js"><link rel="prefetch" href="/my-notebook/assets/js/143.c9bb6d3f.js"><link rel="prefetch" href="/my-notebook/assets/js/144.74704ab9.js"><link rel="prefetch" href="/my-notebook/assets/js/145.8889291c.js"><link rel="prefetch" href="/my-notebook/assets/js/146.ca061372.js"><link rel="prefetch" href="/my-notebook/assets/js/147.bb5da85d.js"><link rel="prefetch" href="/my-notebook/assets/js/148.61c0fce5.js"><link rel="prefetch" href="/my-notebook/assets/js/149.3a8cf86f.js"><link rel="prefetch" href="/my-notebook/assets/js/15.01f6456c.js"><link rel="prefetch" href="/my-notebook/assets/js/150.ecb9fa70.js"><link rel="prefetch" href="/my-notebook/assets/js/151.d8444745.js"><link rel="prefetch" href="/my-notebook/assets/js/152.3a969ab0.js"><link rel="prefetch" href="/my-notebook/assets/js/153.ce7825bc.js"><link rel="prefetch" href="/my-notebook/assets/js/154.0dca20cd.js"><link rel="prefetch" href="/my-notebook/assets/js/155.ce4cfa24.js"><link rel="prefetch" href="/my-notebook/assets/js/156.ca19aa14.js"><link rel="prefetch" href="/my-notebook/assets/js/157.4b6fc479.js"><link rel="prefetch" href="/my-notebook/assets/js/158.82350ed5.js"><link rel="prefetch" href="/my-notebook/assets/js/159.58ad2261.js"><link rel="prefetch" href="/my-notebook/assets/js/16.18111090.js"><link rel="prefetch" href="/my-notebook/assets/js/160.952f4281.js"><link rel="prefetch" href="/my-notebook/assets/js/161.69bf13ff.js"><link rel="prefetch" href="/my-notebook/assets/js/162.70e33cb8.js"><link rel="prefetch" href="/my-notebook/assets/js/163.97f19a9c.js"><link rel="prefetch" href="/my-notebook/assets/js/164.48fe4189.js"><link rel="prefetch" href="/my-notebook/assets/js/165.8c2327e4.js"><link rel="prefetch" href="/my-notebook/assets/js/166.53baeecc.js"><link rel="prefetch" href="/my-notebook/assets/js/167.1e2e844e.js"><link rel="prefetch" href="/my-notebook/assets/js/168.d2cbd304.js"><link rel="prefetch" href="/my-notebook/assets/js/169.ba55018c.js"><link rel="prefetch" href="/my-notebook/assets/js/17.f65e9deb.js"><link rel="prefetch" href="/my-notebook/assets/js/170.b9b19630.js"><link rel="prefetch" href="/my-notebook/assets/js/171.78786c48.js"><link rel="prefetch" href="/my-notebook/assets/js/172.17037e33.js"><link rel="prefetch" href="/my-notebook/assets/js/173.47a52d29.js"><link rel="prefetch" href="/my-notebook/assets/js/174.1afcf28b.js"><link rel="prefetch" href="/my-notebook/assets/js/175.80c4b072.js"><link rel="prefetch" href="/my-notebook/assets/js/176.05229643.js"><link rel="prefetch" href="/my-notebook/assets/js/177.5a045336.js"><link rel="prefetch" href="/my-notebook/assets/js/178.1c72acd3.js"><link rel="prefetch" href="/my-notebook/assets/js/179.ab4349a8.js"><link rel="prefetch" href="/my-notebook/assets/js/18.dcd32911.js"><link rel="prefetch" href="/my-notebook/assets/js/180.74c3762e.js"><link rel="prefetch" href="/my-notebook/assets/js/181.b619f8ef.js"><link rel="prefetch" href="/my-notebook/assets/js/182.a4448806.js"><link rel="prefetch" href="/my-notebook/assets/js/183.fba7c2d8.js"><link rel="prefetch" href="/my-notebook/assets/js/184.76a51921.js"><link rel="prefetch" href="/my-notebook/assets/js/185.1be81190.js"><link rel="prefetch" href="/my-notebook/assets/js/186.6c44435a.js"><link rel="prefetch" href="/my-notebook/assets/js/187.f688dbf4.js"><link rel="prefetch" href="/my-notebook/assets/js/188.ef1f5a14.js"><link rel="prefetch" href="/my-notebook/assets/js/189.2fce0840.js"><link rel="prefetch" href="/my-notebook/assets/js/19.237c9863.js"><link rel="prefetch" href="/my-notebook/assets/js/190.289460a1.js"><link rel="prefetch" href="/my-notebook/assets/js/191.76d6cc8e.js"><link rel="prefetch" href="/my-notebook/assets/js/192.855c2f34.js"><link rel="prefetch" href="/my-notebook/assets/js/193.d1fe56cd.js"><link rel="prefetch" href="/my-notebook/assets/js/194.041833e0.js"><link rel="prefetch" href="/my-notebook/assets/js/195.6b11dd84.js"><link rel="prefetch" href="/my-notebook/assets/js/196.3078cf29.js"><link rel="prefetch" href="/my-notebook/assets/js/197.5f03b2f5.js"><link rel="prefetch" href="/my-notebook/assets/js/198.276acecb.js"><link rel="prefetch" href="/my-notebook/assets/js/199.7823314c.js"><link rel="prefetch" href="/my-notebook/assets/js/20.8ff87884.js"><link rel="prefetch" href="/my-notebook/assets/js/200.3b600756.js"><link rel="prefetch" href="/my-notebook/assets/js/201.7d418d22.js"><link rel="prefetch" href="/my-notebook/assets/js/202.c44bddea.js"><link rel="prefetch" href="/my-notebook/assets/js/203.e4324d8e.js"><link rel="prefetch" href="/my-notebook/assets/js/204.f31c0ff2.js"><link rel="prefetch" href="/my-notebook/assets/js/205.ae55aa52.js"><link rel="prefetch" href="/my-notebook/assets/js/207.d7bf9343.js"><link rel="prefetch" href="/my-notebook/assets/js/208.83b60a09.js"><link rel="prefetch" href="/my-notebook/assets/js/209.9ea0cf64.js"><link rel="prefetch" href="/my-notebook/assets/js/21.1f60ac32.js"><link rel="prefetch" href="/my-notebook/assets/js/210.c3de90df.js"><link rel="prefetch" href="/my-notebook/assets/js/211.87d7ccb2.js"><link rel="prefetch" href="/my-notebook/assets/js/212.da647fc3.js"><link rel="prefetch" href="/my-notebook/assets/js/213.3e38ada6.js"><link rel="prefetch" href="/my-notebook/assets/js/214.7cbcd47c.js"><link rel="prefetch" href="/my-notebook/assets/js/215.55bc32d8.js"><link rel="prefetch" href="/my-notebook/assets/js/216.2875bb74.js"><link rel="prefetch" href="/my-notebook/assets/js/217.7cd130fa.js"><link rel="prefetch" href="/my-notebook/assets/js/218.4a76329f.js"><link rel="prefetch" href="/my-notebook/assets/js/219.2385b437.js"><link rel="prefetch" href="/my-notebook/assets/js/22.a0e8e8a8.js"><link rel="prefetch" href="/my-notebook/assets/js/220.00e9225c.js"><link rel="prefetch" href="/my-notebook/assets/js/221.49a8822e.js"><link rel="prefetch" href="/my-notebook/assets/js/222.5a003d6b.js"><link rel="prefetch" href="/my-notebook/assets/js/223.46d033ce.js"><link rel="prefetch" href="/my-notebook/assets/js/224.a5a6be17.js"><link rel="prefetch" href="/my-notebook/assets/js/225.393f8808.js"><link rel="prefetch" href="/my-notebook/assets/js/226.79fbd929.js"><link rel="prefetch" href="/my-notebook/assets/js/227.372e4bf3.js"><link rel="prefetch" href="/my-notebook/assets/js/228.7b33616a.js"><link rel="prefetch" href="/my-notebook/assets/js/229.fd079d27.js"><link rel="prefetch" href="/my-notebook/assets/js/23.0845f164.js"><link rel="prefetch" href="/my-notebook/assets/js/230.23030ff1.js"><link rel="prefetch" href="/my-notebook/assets/js/231.23bcae45.js"><link rel="prefetch" href="/my-notebook/assets/js/232.52988e15.js"><link rel="prefetch" href="/my-notebook/assets/js/233.eb2a71f8.js"><link rel="prefetch" href="/my-notebook/assets/js/234.1d7059dc.js"><link rel="prefetch" href="/my-notebook/assets/js/235.234c4cfc.js"><link rel="prefetch" href="/my-notebook/assets/js/236.a84699a2.js"><link rel="prefetch" href="/my-notebook/assets/js/237.bcad344b.js"><link rel="prefetch" href="/my-notebook/assets/js/238.73eeda69.js"><link rel="prefetch" href="/my-notebook/assets/js/239.0f112a76.js"><link rel="prefetch" href="/my-notebook/assets/js/24.569160d3.js"><link rel="prefetch" href="/my-notebook/assets/js/240.05cdfdf3.js"><link rel="prefetch" href="/my-notebook/assets/js/241.e4706375.js"><link rel="prefetch" href="/my-notebook/assets/js/242.09c013a2.js"><link rel="prefetch" href="/my-notebook/assets/js/243.9d4a573b.js"><link rel="prefetch" href="/my-notebook/assets/js/244.61e560a9.js"><link rel="prefetch" href="/my-notebook/assets/js/245.150c8644.js"><link rel="prefetch" href="/my-notebook/assets/js/246.d6c18f99.js"><link rel="prefetch" href="/my-notebook/assets/js/247.48bf33b6.js"><link rel="prefetch" href="/my-notebook/assets/js/248.3d27833e.js"><link rel="prefetch" href="/my-notebook/assets/js/249.e155e0af.js"><link rel="prefetch" href="/my-notebook/assets/js/25.1579c984.js"><link rel="prefetch" href="/my-notebook/assets/js/250.bd1d2acc.js"><link rel="prefetch" href="/my-notebook/assets/js/251.9b80d999.js"><link rel="prefetch" href="/my-notebook/assets/js/252.76139dc4.js"><link rel="prefetch" href="/my-notebook/assets/js/253.4d1284b0.js"><link rel="prefetch" href="/my-notebook/assets/js/254.ff9e2b67.js"><link rel="prefetch" href="/my-notebook/assets/js/255.8cad9651.js"><link rel="prefetch" href="/my-notebook/assets/js/256.ac9aa041.js"><link rel="prefetch" href="/my-notebook/assets/js/257.9586d3fc.js"><link rel="prefetch" href="/my-notebook/assets/js/258.e3aa797d.js"><link rel="prefetch" href="/my-notebook/assets/js/259.00770e84.js"><link rel="prefetch" href="/my-notebook/assets/js/26.8dfa0dde.js"><link rel="prefetch" href="/my-notebook/assets/js/260.675406fc.js"><link rel="prefetch" href="/my-notebook/assets/js/261.23825f11.js"><link rel="prefetch" href="/my-notebook/assets/js/262.143a2b1f.js"><link rel="prefetch" href="/my-notebook/assets/js/263.a5e4858c.js"><link rel="prefetch" href="/my-notebook/assets/js/264.de8a0392.js"><link rel="prefetch" href="/my-notebook/assets/js/265.e4ac5cd1.js"><link rel="prefetch" href="/my-notebook/assets/js/266.06e18ede.js"><link rel="prefetch" href="/my-notebook/assets/js/27.f58d9915.js"><link rel="prefetch" href="/my-notebook/assets/js/28.d9a7528b.js"><link rel="prefetch" href="/my-notebook/assets/js/29.10f9236a.js"><link rel="prefetch" href="/my-notebook/assets/js/3.db75fba4.js"><link rel="prefetch" href="/my-notebook/assets/js/30.b7170576.js"><link rel="prefetch" href="/my-notebook/assets/js/31.04ce150c.js"><link rel="prefetch" href="/my-notebook/assets/js/32.02bdf1dd.js"><link rel="prefetch" href="/my-notebook/assets/js/33.d6641107.js"><link rel="prefetch" href="/my-notebook/assets/js/34.90a1bb20.js"><link rel="prefetch" href="/my-notebook/assets/js/35.b48a5251.js"><link rel="prefetch" href="/my-notebook/assets/js/36.5ff68adc.js"><link rel="prefetch" href="/my-notebook/assets/js/37.8fc8e706.js"><link rel="prefetch" href="/my-notebook/assets/js/38.493ef730.js"><link rel="prefetch" href="/my-notebook/assets/js/39.b44f4e42.js"><link rel="prefetch" href="/my-notebook/assets/js/4.db331c2b.js"><link rel="prefetch" href="/my-notebook/assets/js/40.e180947b.js"><link rel="prefetch" href="/my-notebook/assets/js/41.6d23eb27.js"><link rel="prefetch" href="/my-notebook/assets/js/42.3da9b2a4.js"><link rel="prefetch" href="/my-notebook/assets/js/43.b4579630.js"><link rel="prefetch" href="/my-notebook/assets/js/44.7cf30deb.js"><link rel="prefetch" href="/my-notebook/assets/js/45.c3b51ad8.js"><link rel="prefetch" href="/my-notebook/assets/js/46.b52d8568.js"><link rel="prefetch" href="/my-notebook/assets/js/47.66d720e1.js"><link rel="prefetch" href="/my-notebook/assets/js/48.690ad421.js"><link rel="prefetch" href="/my-notebook/assets/js/49.8439b976.js"><link rel="prefetch" href="/my-notebook/assets/js/5.977f0fd9.js"><link rel="prefetch" href="/my-notebook/assets/js/50.849204fe.js"><link rel="prefetch" href="/my-notebook/assets/js/51.5f159048.js"><link rel="prefetch" href="/my-notebook/assets/js/52.21ee14c1.js"><link rel="prefetch" href="/my-notebook/assets/js/53.eeef2ccc.js"><link rel="prefetch" href="/my-notebook/assets/js/54.b3ead0f9.js"><link rel="prefetch" href="/my-notebook/assets/js/55.edad724c.js"><link rel="prefetch" href="/my-notebook/assets/js/56.6527c9d1.js"><link rel="prefetch" href="/my-notebook/assets/js/57.12a21695.js"><link rel="prefetch" href="/my-notebook/assets/js/58.2b44cf49.js"><link rel="prefetch" href="/my-notebook/assets/js/59.3699a337.js"><link rel="prefetch" href="/my-notebook/assets/js/6.33e25759.js"><link rel="prefetch" href="/my-notebook/assets/js/60.162aa4f2.js"><link rel="prefetch" href="/my-notebook/assets/js/61.f82cd93c.js"><link rel="prefetch" href="/my-notebook/assets/js/62.cc1099ad.js"><link rel="prefetch" href="/my-notebook/assets/js/63.c5cf6408.js"><link rel="prefetch" href="/my-notebook/assets/js/64.f1ce4bbc.js"><link rel="prefetch" href="/my-notebook/assets/js/65.4413a5f7.js"><link rel="prefetch" href="/my-notebook/assets/js/66.322bcffc.js"><link rel="prefetch" href="/my-notebook/assets/js/67.29af8eae.js"><link rel="prefetch" href="/my-notebook/assets/js/68.7d9155d8.js"><link rel="prefetch" href="/my-notebook/assets/js/69.ffb80eaa.js"><link rel="prefetch" href="/my-notebook/assets/js/7.0354d112.js"><link rel="prefetch" href="/my-notebook/assets/js/70.c8323fc4.js"><link rel="prefetch" href="/my-notebook/assets/js/71.2b30e708.js"><link rel="prefetch" href="/my-notebook/assets/js/72.dc8b9925.js"><link rel="prefetch" href="/my-notebook/assets/js/73.ae8436f7.js"><link rel="prefetch" href="/my-notebook/assets/js/74.5204a953.js"><link rel="prefetch" href="/my-notebook/assets/js/75.c20db4d7.js"><link rel="prefetch" href="/my-notebook/assets/js/76.74eaddb0.js"><link rel="prefetch" href="/my-notebook/assets/js/77.71d26542.js"><link rel="prefetch" href="/my-notebook/assets/js/78.bd9498a5.js"><link rel="prefetch" href="/my-notebook/assets/js/79.13122127.js"><link rel="prefetch" href="/my-notebook/assets/js/8.3f9fd241.js"><link rel="prefetch" href="/my-notebook/assets/js/80.f0ad36b0.js"><link rel="prefetch" href="/my-notebook/assets/js/81.1d861701.js"><link rel="prefetch" href="/my-notebook/assets/js/82.e9302c20.js"><link rel="prefetch" href="/my-notebook/assets/js/83.05744b48.js"><link rel="prefetch" href="/my-notebook/assets/js/84.b148533f.js"><link rel="prefetch" href="/my-notebook/assets/js/85.2009ad85.js"><link rel="prefetch" href="/my-notebook/assets/js/86.8b8c52ed.js"><link rel="prefetch" href="/my-notebook/assets/js/87.e2c25871.js"><link rel="prefetch" href="/my-notebook/assets/js/88.1b979489.js"><link rel="prefetch" href="/my-notebook/assets/js/89.7f70e576.js"><link rel="prefetch" href="/my-notebook/assets/js/9.4e3162a9.js"><link rel="prefetch" href="/my-notebook/assets/js/90.79427280.js"><link rel="prefetch" href="/my-notebook/assets/js/91.5db577c5.js"><link rel="prefetch" href="/my-notebook/assets/js/92.a5ae341b.js"><link rel="prefetch" href="/my-notebook/assets/js/93.ad647e77.js"><link rel="prefetch" href="/my-notebook/assets/js/94.c3a79430.js"><link rel="prefetch" href="/my-notebook/assets/js/95.4ca359cb.js"><link rel="prefetch" href="/my-notebook/assets/js/96.31a712f5.js"><link rel="prefetch" href="/my-notebook/assets/js/97.e2088ae9.js"><link rel="prefetch" href="/my-notebook/assets/js/98.3af8fc5a.js"><link rel="prefetch" href="/my-notebook/assets/js/99.ef0d23ed.js">
    <link rel="stylesheet" href="/my-notebook/assets/css/0.styles.09dde1b2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-notebook/" class="home-link router-link-active"><!----> <span class="site-name">Garrik 的笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-notebook/" class="nav-link">主页</a></div><div class="nav-item"><a href="https://github.com/Garrik-Liu/my-notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-notebook/" class="nav-link">主页</a></div><div class="nav-item"><a href="https://github.com/Garrik-Liu/my-notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>操作系统</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#操作系统概述" class="sidebar-link">操作系统概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#操作系统的发展" class="sidebar-link">操作系统的发展</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#操作系统的主要功能-服务" class="sidebar-link">操作系统的主要功能 &amp; 服务</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#操作系统的运行环境" class="sidebar-link">操作系统的运行环境</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#进程管理" class="sidebar-link">进程管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#进程-线程" class="sidebar-link">进程 &amp; 线程</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#处理器调度" class="sidebar-link">处理器调度</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#同步-互斥" class="sidebar-link">同步 &amp; 互斥</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#死锁" class="sidebar-link">死锁</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#内存管理" class="sidebar-link">内存管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#内存管理基础" class="sidebar-link">内存管理基础</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#连续分配管理方式" class="sidebar-link">连续分配管理方式</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#非连续分配管理方式" class="sidebar-link">非连续分配管理方式</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#虚拟内存管理" class="sidebar-link">虚拟内存管理</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#内存管理方式之间的对比" class="sidebar-link">内存管理方式之间的对比</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#文件管理" class="sidebar-link">文件管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#文件系统基础" class="sidebar-link">文件系统基础</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#文件系统及实现" class="sidebar-link">文件系统及实现</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html#i-0-管理" class="sidebar-link">I/0 管理</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="操作系统"><a href="#操作系统" class="header-anchor">#</a> 操作系统</h1> <h2 id="操作系统概述"><a href="#操作系统概述" class="header-anchor">#</a> 操作系统概述</h2> <h3 id="操作系统的发展"><a href="#操作系统的发展" class="header-anchor">#</a> 操作系统的发展</h3> <p>操作系统是根据实际的 &quot;需求&quot; 而产生和发展的.</p> <p><strong>1 - 无操作系统</strong></p> <ul><li>最早人们用手工操作的方式使用计算机, 将程序和数据用纸带的形式输入进计算机, 手动控制计算机运行程序. 这种方式用户独占计算机, 资源的利用率低;</li> <li>随着 CPU 的速度不断提升, 出现了手工操作的慢速与 CPU 的高速之间不必配的矛盾. 导致计算机资源的利用率进一步变低;</li> <li>为了解决 CPU 与 I/O 设备之间速度不匹配的问题, 引入了『 脱机输入 / 输出 』技术.
<ul><li>用户预先把程序和数据通过 &quot;外围机&quot; 以慢速输入到 &quot;输入带&quot; 上. 当 CPU 需要这些内容时, &quot;输入带&quot; 可以高速传输到内存;</li> <li>同理, CPU 把输出内容高速地传送到 &quot;输出带&quot;, 然后 &quot;传送带&quot; 再通过外围机把内容慢速地传输给外部输出设备;</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-14-58-00.png" alt="2020-07-05-14-58-00"></p> <p><strong>2 - 单道批处理系统</strong></p> <ul><li>单道批处理系统是最早出现的一种操作系统, 但只能算是现代操作系统的前身, 不算是现代操作系统;</li> <li>为了让计算机可以得到充分地利用, 应尽量使 CPU 连续运行, 减少空闲时间;</li> <li>做法是将一批作业通过脱机输入的方式传输到输入带中, 并在计算机中配置一个『 监督程序 』用来管理作业的运行;</li> <li>计算机在 &quot;监督程序&quot; 的控制下一个一个顺序地处理作业, 直到把所有输入带上的作业都处理完;</li> <li>这便形成了早期的『 批处理系统 』</li> <li>因为监督程序每次只调入一道程序进入内存中让 CPU 运行, 如果程序进行 I/O 操作, 就会造成 CPU 空闲, 导致 CPU 利用率下降;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-15-07-08.png" alt="2020-07-05-15-07-08"></p> <p><strong>3 - 多道批处理系统</strong></p> <ul><li>为了进一步提高 CPU 的利用率出现了多道批处理系统;</li> <li>它能将一个以上的作业调入主存中, 并让它们同时处于运行状态. 这些作业间共享处理器, 外设以及其他资源;</li> <li>虽然宏观上多个程序都在运行, 但是任一时间 CPU 上只运行一个程序, 多个程序间轮流使用 CPU, 交替运行;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-15-16-45.png" alt="2020-07-05-15-16-45"></p> <ul><li>在实现多道批处理系统时, 需要妥善地解决如下的一系列问题:
<ul><li>如何分配处理器给程序, 给谁, 什么时候给, 什么时候回收?</li> <li>如何给每个程序分配必要的内存空间?</li> <li>如何让多个程序能共享多种类型的 I/O 设备?</li> <li>如何保证数据的安全性和一致性;</li></ul></li></ul> <p><strong>4 - 操作系统的形成</strong></p> <ul><li>为了解决多道批处理系统里涉及的各种问题, 又在其内部添加了一堆软件, 这样便形成了完整的操作系统;</li> <li>简单说, <strong>操作系统是一组控制和管理计算机硬件和软件资源 ,合理地组织计算机工作流程以及方便用户使用的程序的集合</strong>;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-13-14-03.png" alt="2020-07-05-13-14-03"></p> <h3 id="操作系统的主要功能-服务"><a href="#操作系统的主要功能-服务" class="header-anchor">#</a> 操作系统的主要功能 &amp; 服务</h3> <p><strong>1 - 处理器管理</strong>:</p> <ul><li>操作系统能够对处理器进行分配和运行实施有效的管理;</li> <li>多道程序环境下, 处理器的分配和运行是以『 进程 』为基本单位的. 因此对处理器的管理可以归结为对进程的管理;</li> <li>主要功能如下:</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-15-30-04.png" alt="2020-07-05-15-30-04"></p> <p><strong>2 - 存储器管理</strong>:</p> <ul><li>操作系统能够对内存进行分配, 保护和扩充. 主要功能如下:</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-15-31-33.png" alt="2020-07-05-15-31-33"></p> <p><strong>3 - 设备管理</strong>:</p> <ul><li>操作系统能够对计算机系统内的所有设备实施有效的管理. 主要功能如下:</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-15-32-45.png" alt="2020-07-05-15-32-45"></p> <p><strong>4 - 文件管理</strong>:</p> <ul><li>操作系统能够对计算机中的信息进行管理, 称为『 文件管理 』, 主要任务就是支持文件存储, 检索和修改等操作. 解决文件的共享, 保密和保护问题. 主要功能如下;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-15-34-30.png" alt="2020-07-05-15-34-30"></p> <p><strong>5 - 用户接口</strong>:</p> <ul><li>为了方便用户使用, 操作系统还提供了用户接口:</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-15-36-15.png" alt="2020-07-05-15-36-15"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-15-36-58.png" alt="2020-07-05-15-36-58"></p> <h3 id="操作系统的运行环境"><a href="#操作系统的运行环境" class="header-anchor">#</a> 操作系统的运行环境</h3> <h4 id="核心态-用户态"><a href="#核心态-用户态" class="header-anchor">#</a> 核心态 &amp; 用户态</h4> <p>为了避免操作系统及其关键数据受到用户程序有意或无意的破坏, 通常将『 处理器的执行状态 』分成两种:</p> <ul><li>核心态 / 系统态: 是操作系统中系统程序执行时所处的状态, 具有较高的特权, 能执行一切指令, 能访问所有的存储器;</li> <li>用户态: 是用户程序执行时所处的状态, 具有较低特权, 只能执行规定的指令, 访问指定的存储器;</li></ul> <h4 id="中断-异常"><a href="#中断-异常" class="header-anchor">#</a> 中断 &amp; 异常</h4> <p><strong>中断</strong>, 也称为 &quot;外中断&quot;, 是系统正常功能的一部分, 用以在当前进程运行时, 插入一个需要优先处理的操作. 操作完又会继续执行中断前的进程.</p> <p><strong>异常</strong>, 也称为 &quot;内中断&quot;, 是错误引起的. 通常异常会引起中断.</p> <h4 id="系统调用"><a href="#系统调用" class="header-anchor">#</a> 系统调用</h4> <p>操作系统的一个主要功能是为应用程序运行提供良好的环境, 为了实现这个目的, 内核提供了一系列具有功能的内核函数. 同时, 操作系统提供一组称为『 <strong>系统调用</strong> System Call 』的接口给用户, <strong>系统调用可以把应用程序的请求传递给内核, 然后调用响应的内核函数实现预期的功能, 并将处理结果返回给应用程序</strong>.</p> <p>系统调用通常包括的功能有, 进程控制, 文件系统控制, 内存管理, 网络管理, 用户管理, etc;</p> <p>用户程序调用系统调用时, 会通过『 陷入 trap 』指令引起一个中断, 进入操作系统的系统内核, 此时从 &quot;用户态&quot; 变为 &quot;系统态&quot;, 然后执行相应的内核函数, 最后将处理结果返回给应用程序, 此时 &quot;系统态&quot; 变为 &quot;用户态&quot;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-19-25-29.png" alt="2020-07-05-19-25-29"></p> <h2 id="进程管理"><a href="#进程管理" class="header-anchor">#</a> 进程管理</h2> <h3 id="进程-线程"><a href="#进程-线程" class="header-anchor">#</a> 进程 &amp; 线程</h3> <h4 id="程序并发执行的问题"><a href="#程序并发执行的问题" class="header-anchor">#</a> 程序并发执行的问题</h4> <p>一个程序由若干个程序段组成, 它们按照先后次序顺序执行. 当处理器在运行一个程序时, 呈现出如下特性:</p> <ul><li><strong>顺序性</strong>: 处理器严格按照程序所规定的顺序一步步地执行;</li> <li><strong>封闭性</strong>: 程序在运行时独占系统的各种资源, 这些资源的状态只有本程序才能改变, 程序执行结果不受外部因素影响;</li> <li><strong>可再现性</strong>: 只要程序执行时的初始条件和执行环境相同, 重复执行程序, 每次结果都相同;</li></ul> <p>但是当程序并发执行时, 虽然提高了系统的处理能力和资源的利用率, 但是也带来一些新问题:</p> <ul><li><strong>间断性</strong>:</li> <li><strong>失去封闭性</strong>: 多个程序共享系统中的资源, 那么这些资源的状态可能由多个程序所改变, 致使程序的运行失去封闭性;</li> <li><strong>不可再现性</strong>: 因为失去了封闭性, 一个程序在执行时, 可能会受到其他程序的影响. 这也导致运行结果可能每次都不一样;</li></ul> <p>为了让程序并发执行, 必须要满足一些限制条件, 以保持程序的封闭性和可再现性.</p> <ul><li>将程序 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.803ex" height="1.439ex" viewBox="0 -442 797 636" style="vertical-align:-0.439ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(503, -150) scale(0.707)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container> 在执行期间需要 &quot;引用&quot; 的所有变量的集合, 称为『 <strong>读集</strong> 』 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="23.541ex" height="2.262ex" viewBox="0 -750 10405.1 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mo" transform="translate(759, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(1148, 0)"><g data-mml-node="mi"><path data-c="70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(503, -150) scale(0.707)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1945, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2611.7, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(3667.5, 0)"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(4167.5, 0)"><g data-mml-node="mi"><path data-c="61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mn" transform="translate(529, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(5100.1, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(5544.7, 0)"><g data-mml-node="mi"><path data-c="61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mn" transform="translate(529, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(6477.3, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(6921.9, 0)"><path data-c="22EF" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250ZM525 250Q525 274 542 292T585 310Q609 310 627 294T646 251Q646 226 629 208T586 190T543 207T525 250ZM972 250Q972 274 989 292T1032 310Q1056 310 1074 294T1093 251Q1093 226 1076 208T1033 190T990 207T972 250Z"></path></g><g data-mml-node="mo" transform="translate(8260.6, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(8705.3, 0)"><g data-mml-node="mi"><path data-c="61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(529, -150) scale(0.707)"><path data-c="6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(9905.1, 0)"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g></g></g></svg></mjx-container></li> <li>将程序 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.803ex" height="1.439ex" viewBox="0 -442 797 636" style="vertical-align:-0.439ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(503, -150) scale(0.707)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container> 在执行期间需要 &quot;改变&quot; 的所有变量的集合, 称为『 <strong>写集</strong> 』 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="23.071ex" height="2.262ex" viewBox="0 -750 10197.5 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="57" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="mo" transform="translate(1048, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(1437, 0)"><g data-mml-node="mi"><path data-c="70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(503, -150) scale(0.707)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(2234, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2900.7, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(3956.5, 0)"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(4456.5, 0)"><g data-mml-node="mi"><path data-c="62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mn" transform="translate(429, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(5289.1, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(5733.7, 0)"><g data-mml-node="mi"><path data-c="62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mn" transform="translate(429, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(6566.3, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(7010.9, 0)"><path data-c="22EF" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250ZM525 250Q525 274 542 292T585 310Q609 310 627 294T646 251Q646 226 629 208T586 190T543 207T525 250ZM972 250Q972 274 989 292T1032 310Q1056 310 1074 294T1093 251Q1093 226 1076 208T1033 190T990 207T972 250Z"></path></g><g data-mml-node="mo" transform="translate(8349.6, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(8794.3, 0)"><g data-mml-node="mi"><path data-c="62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(429, -150) scale(0.707)"><path data-c="6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(9697.5, 0)"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g></g></g></svg></mjx-container></li></ul> <p>当两个程序 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.051ex" height="1.439ex" viewBox="0 -442 906.6 636" style="vertical-align:-0.439ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mn" transform="translate(503, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 和 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.051ex" height="1.439ex" viewBox="0 -442 906.6 636" style="vertical-align:-0.439ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mn" transform="translate(503, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 同时满足一下 3 个条件, 它们便可以并发执行, 每个程序都保持封闭性和可再现性. 此条件称为『 <strong>Bernstein 条件</strong> 』</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-22-30-43.png" alt="2020-07-05-22-30-43"></p> <h4 id="进程的定义-描述"><a href="#进程的定义-描述" class="header-anchor">#</a> 进程的定义 &amp; 描述</h4> <p>因为在多道程序环境下, 程序并发执行会带来如上的问题, 所以就引入了『 进程 』的概念.</p> <p><strong>进程的定义</strong>: 进程是程序在一个数据集合上的运行过程, 是系统进行资源分配和调度的一个独立单位;</p> <p><strong>进程和程序的关系</strong>:</p> <ul><li>程序要执行时, 操作系统创建一个进程, 把程序和需要的数据装入其中, 然后放入内存等待 CPU 执行;</li> <li>进程使程序能够与其他程序并发执行;</li> <li>多个进程同时存在于内存中, 能在一段时间内同时运行;</li></ul> <p><strong>进程的组成</strong>:</p> <p>进程一般由如下几个部分组成:</p> <ul><li><strong>进程控制块 PCB</strong>: 用以唯一标识进程, 存储程序执行瞬间的状态, 以及一些相关信息的数据结构;</li> <li><strong>程序段</strong>: 需要执行的程序代码段;</li> <li><strong>数据段</strong>: 程序运行需要的原始数据, 程序执行过程中产生的中间或结果数据;</li></ul> <p>进程控制块 PCB 根据操作系统要求的不同, 所包含的内容也各有不同, 但是一般包含如下:</p> <ul><li><strong>进程标识符 PID</strong>: 进程的唯一标识;</li> <li><strong>进程当前状态</strong>: 进程的当前状态, 作为进程调度程序分配处理器的依据;</li> <li><strong>进程队列指针</strong>: 用以记录 PCB 队列中的下一个 PCB. 系统中的 PCB 可能组织成多个队列. 例如, 就绪队列, 阻塞队列;</li> <li><strong>程序和数据地址</strong>: 进程的程序段和数据段所在的地址;</li> <li><strong>进程优先级</strong>: 反映进程要求 CPU 的紧急程度, 优先级高的进程可以优先获得处理器;</li> <li><strong>CPU 现场保护区</strong>: 当进程因某些原因释放处理器时, CPU 现场信息 ( 例如, 指令计数器, 状态寄存器, etc ) 需要保存在 PCB 的该区域中, 以便进程重新获得处理器时可以继续之前的状态执行;</li> <li><strong>通信信息</strong>: 记录进程在执行过程中与别的进程信息交换的情况;</li> <li><strong>家族信息</strong>: 系统允许进程创建子进程, 从而形成一个进程家族树, 一个进程与家族的关系需要记录在 PCB 的该区域;</li> <li><strong>占有资源信息</strong>: 进程所需资源以及已分配资源的清单</li></ul> <h4 id="进程的状态-转换"><a href="#进程的状态-转换" class="header-anchor">#</a> 进程的状态 &amp; 转换</h4> <p>进程在运行过程中, 由于系统中多个进程并发运行以及相互制约的结果, 使得进程的状态不断地变化:</p> <ul><li><strong>创建状态</strong>: 进程正在被创建, 向系统申请空白的 PCB 并初始化, 然后系统给该进程分配运行所需的资源, 然后转入就绪状态;</li> <li><strong>就绪状态</strong>: 进程已获得了除处理器之外的所有资源, 一旦获得处理器就可以立即执行;</li> <li><strong>执行状态</strong> ( 运行状态 ) : 正在被处理器执行的进程;</li> <li><strong>阻塞状态</strong> ( 等待状态 ) : 正在执行的进程, 因发生了某事件而无法执行下去 ( 例如, 等待 I/O 操作完成 ) 此时进程处于阻塞状态, 需要把处理器分配给其他进程;</li> <li><strong>结束状态</strong>: 进程从系统中被删除, 导致进程结束的事件可能是进程正常执行完毕, 进程发送异常, 或者外部干预;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-23-02-43.png" alt="2020-07-05-23-02-43"></p> <h4 id="线程"><a href="#线程" class="header-anchor">#</a> 线程</h4> <p>进程具有如下两个基本属性:</p> <ul><li>进程是一个拥有资源的独立单元;</li> <li>进程是一个可以被处理器独立调度和分配的单元;</li></ul> <p>为了使进程能并发执行, 操作系统需要进行一系列进程操作, 例如, 创建进程, 撤销进程, 阻塞/唤醒进程, 进程切换. 在执行这些操作时, 需要为进程分配 / 回收资源, 为运行进程保存现场信息, 这些工作会有很多时间和空间上的花销.</p> <p>因此, 如果进程操作太多就会导致资源的浪费. 如果限制进程数量, 进程切换的频率又会限制系统的并发程度;</p> <p>为了使程序更好地并发执行, 需要尽量减少操作系统的开销, 同时保证系统的并发程度, 为此引入了『 <strong>线程</strong> 』的概念.</p> <p><strong>线程的定义</strong>: 线程是进程中一个相对独立的, 可调度的执行单元. 线程只拥有一些在运行时必须的资源, 一个进程中的线程共享进程拥有的全部资源;</p> <p>可以理解为, 操作系统的设计者把进程拥有的两个属性分开来, 第一个交给进程, 第二个交给线程;</p> <h3 id="处理器调度"><a href="#处理器调度" class="header-anchor">#</a> 处理器调度</h3> <h4 id="处理器的三级调度"><a href="#处理器的三级调度" class="header-anchor">#</a> 处理器的三级调度</h4> <p>在多道程序环境下, 一个作业从提交到执行, 经常需要经历多级调度. 不同的操作系统, 采用的调度层级也不同. 👇 下图展示了 &quot;三级调度&quot; 的过程:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-05-23-41-22.png" alt="2020-07-05-23-41-22"></p> <p><strong>高级调度</strong>:</p> <ul><li>也称为 &quot;宏观调度&quot;, &quot;作业调度&quot;, &quot;长程调度&quot;;</li> <li>主要任务是按照一定的原则从外存上处于后备状态的作业中选择一个或多个, 给它们分配内存, I/O 设备等必要资源, 并建立相应的进程;</li></ul> <p><strong>中级调度</strong>:</p> <ul><li>也称 &quot;中程调度&quot;, &quot;交换调度&quot;;</li> <li>主要任务是按照某种策略, 将处于 &quot;外存对换区&quot; 中具备运行条件的进程调度内存, 并将其状态修改为 &quot;就绪状态&quot;, 挂在就绪队列上等待执行;</li> <li>或者将处于内存中暂时不能运行的进程交换到外存对换区, 此时进程的状态被称为 &quot;挂起状态&quot;;</li></ul> <p><strong>低级调度</strong>:</p> <ul><li>也称 &quot;微观调度&quot;, &quot;进程调度&quot;, &quot;短程调度&quot;;</li> <li>主要任务是按照某种策略从就绪队列中选取一个进程, 将处理器分配给它;</li></ul> <h4 id="进程调度"><a href="#进程调度" class="header-anchor">#</a> 进程调度</h4> <p>将处理器分配给进程的任务是由『 <strong>进程调度程序</strong> 』完成的.</p> <p><strong>进程调度的功能</strong>:</p> <ul><li><strong>记录系统中所有进程的有关情况 &amp; 状态特性</strong>:
<ul><li>将系统中各进程的执行情况和状态记录在 PCB 中, 同时根据各进程的状态和资源需求将 PCB 组织成相应的队列, 并根据运行情况将进程 PCB 在各个队列中进行转换;</li></ul></li> <li><strong>选择获得处理器的进程</strong>:
<ul><li>按照一定的策略选择一个处于就绪状态的进程, 使其得到处理器执行;</li></ul></li> <li><strong>处理器分配</strong>:
<ul><li>当正在运行的进程由于某种原因要放弃处理器时, 进程调出程序需要保存当前进程的 CPU 现场, 然后把它状态改为阻塞或就绪状态, 并插入到对应的队列中;</li> <li>同时, 从就绪队列中选出一个进程, 恢复其 CPU 现场, 让其得到处理器执行;</li></ul></li></ul> <p><strong>引起进程调度的原因</strong>:</p> <ul><li>正在运行的进程结束了. 可能是正常结束, 也可能是发生异常而结束;</li> <li>正在运行的进程进入了阻塞状态;</li> <li>执行完系统调用后返回用户进程. 可以看作是系统进程执行完毕, 从而调度到一个新的用户进程;</li> <li>在采用抢占方式的系统中, 一个优先级更高的进程请求使用处理器;</li> <li>在分时系统中, 分配给该进程的时间片用完了;</li></ul> <p><strong>不能进行进程调度的情况</strong>:</p> <ul><li>处理中断的过程中. 中断属于系统工作的一部分, 逻辑上不属于一个进程, 所以不应该剥夺正在处理进程的处理器资源;</li> <li>进程处于临界区时. 在临界区中, 进程独占式的访问共享资源, 期间不应该有其他并行程序打扰;</li> <li>执行需要完全屏蔽中断的原子操作中. 例如, 加锁, 解锁, 中断线程保护, 恢复等不可再分和打断的原子操作;</li></ul> <p><strong>进程调度的方式</strong>: 当一个进程正在执行时, 如果一个更为重要或紧迫的进程需要进行处理 ( 优先级更高的进程进入就绪队列 ) , 该如何分配处理器;</p> <ul><li><strong>抢占方式</strong> ( 可剥夺方式 ) : 立即执行正在执行的进程, 将处理器分配给优先级更高的进程;</li> <li><strong>非抢占方式</strong> ( 不可剥夺方式 ) : 正在执行的进程继续执行, 直到该进程完成或变成阻塞状态时, 才把处理器分配给优先级更高的进程;</li></ul> <h4 id="常见调度算法"><a href="#常见调度算法" class="header-anchor">#</a> 常见调度算法</h4> <p><strong>先来先服务调度算法</strong> ( 作业调度, 进程调度 ) :</p> <ul><li>最简单的调度算法. 基本思想是按照进程进入就绪队列的先后顺序来分配处理器. 采用 &quot;非抢占&quot; 的调度方式;</li> <li>缺点: 该算法对于每一个进程都是公平的, 假设有一个长进程 ( 执行完毕花费 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="3.079ex" height="1.557ex" viewBox="0 -666 1361 688" style="vertical-align:-0.05ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500, 0)"></path></g><g data-mml-node="mi" transform="translate(1000, 0)"><path data-c="74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container> ) 一个短进程 ( <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.948ex" height="1.532ex" viewBox="0 -666 861 677" style="vertical-align:-0.025ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(500, 0)"><path data-c="74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container> ). 如果长进程先执行, 短进程就要等待 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="3.079ex" height="1.557ex" viewBox="0 -666 1361 688" style="vertical-align:-0.05ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500, 0)"></path></g><g data-mml-node="mi" transform="translate(1000, 0)"><path data-c="74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container>. 而如果短进程先执行, 长进程只需要等待 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.948ex" height="1.532ex" viewBox="0 -666 861 677" style="vertical-align:-0.025ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(500, 0)"><path data-c="74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container></li></ul> <p><strong>短作业 ( 进程 ) 优先调度算法</strong> ( 作业调度, 进程调度 ) :</p> <ul><li>基本思想是把处理器分配给能最快完成的作业 ( 或进程 )</li> <li>缺点: 如果多个短进程不断地进入就绪队列, 长进程就会一直等待处理器, 得不到执行, 这个现象叫做 &quot;饥饿&quot;;</li></ul> <p><strong>优先级调度算法</strong> ( 作业调度, 进程调度 ) :</p> <ul><li>基本思想是把处理器分配给优先级最高的进程;</li> <li>优先级相同的情况下, 一般按照 &quot;先来先服务&quot; 或 &quot;短作业优先&quot; 的策略来选择进程执行;</li></ul> <p>进程优先级的确定分为两种:</p> <ul><li><p><strong>静态优先级</strong>: 创建进程时确定的.</p> <ul><li>确定静态优先级主要依据有如下几种:
<ul><li>进程类型: 系统进程的优先级高于用户进程;</li> <li>作业的资源要求: 进程所申请的资源越多, 那么估计运行的时间就越长, 优先级也就越低;</li> <li>用户类型: 计算机可以按照不同的标准分类, 不同用户创建的进程优先级可以设置差别;</li></ul></li></ul></li> <li><p><strong>动态优先级</strong>: 创建进程时先确定一个优先级, 然后在进程运行过程汇总该根据情况调整优先级.</p> <ul><li>确定动态优先级主要依据有如下几种:
<ul><li>进程占有 CPU 时间的长短: 一个进程占用 CPU 的时间约长, 优先级越低, 再次获得调度的可能性变小;</li> <li>就绪进程等待 CPU 时间的长短: 一个进行在就绪队列中等待的时间越长, 优先级越高, 获得调度的可能性越大;</li></ul></li></ul></li></ul> <p><strong>时间片轮转调度算法</strong> ( 进程调度 ) :</p> <ul><li>在分时系统中, 进程的调度通常采用时间片轮转调度算法;</li> <li>每个进程被执行时, 会规定一个执行时间, 称为 &quot;时间片&quot;. 当时间到了之后, 系统就把正在执行的进程暂停, 然后送至就绪队列末尾. 之后再把处理器分配给下一个就绪进程;</li></ul> <p><strong>高响应比优先调度算法</strong> ( 作业调度 ) :</p> <ul><li>结合了 &quot;先来先服务&quot; 和 &quot;短作业优先&quot; 的两种调度算法的优点;</li> <li>基本思想是每次进行作业调度时, 先计算就绪队列中每个作业的响应比, 挑选响应比最高的作业投入运行;</li> <li>响应比 = 作业响应时间 / 估计运行时间;</li> <li>同时照顾到短作业和长作业, 短作业运行时间短, 响应比较高. 长作业在等待事件很长时, 响应比也变高;</li></ul> <p><strong>多级队列调度算法</strong> ( 进程调度 ) :</p> <ul><li>基本思想是根据进程的性质和类型, 将就绪队列分为若干个独立的队列, 每个进程固定地属于一个队列, 每个队列采用一种调度算法, 不同的队列可以采用不同的调度算法;</li></ul> <p><strong>多级反馈队列调度算法</strong> ( 进程调度 ) :</p> <ul><li>结合了 &quot;时间片轮转优先级调度算法&quot; 和 &quot;优先级调度算法&quot;;</li> <li>首先设置多个就绪队列, 每个队列对应不同的优先级, 进程所在的队列的优先级越高, 该队列采用的时间片就越短; 当前一个队列为空时, 后一个队列中的进程才会被调度;</li> <li>当处理器正在运行某个进程时, 如果有新进程进入了优先级更高的队列中, 此时新进程将抢占正在运行进程的处理器;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-01-22-36.png" alt="2020-07-06-01-22-36"></p> <h3 id="同步-互斥"><a href="#同步-互斥" class="header-anchor">#</a> 同步 &amp; 互斥</h3> <h4 id="同步-互斥的基本概念"><a href="#同步-互斥的基本概念" class="header-anchor">#</a> 同步 &amp; 互斥的基本概念</h4> <p><strong>互斥 - 间接相互制约关系</strong>:</p> <ul><li><strong>定义</strong>: 若某一资源同一时间只能被一个进程使用. 一个进程占用资源时, 另一个进程想使用必须等待前一个进程释放资源之后才行. 这两个进程间呈现出 &quot;互斥&quot; 的关系.</li> <li>为了维持两个进程间的互斥关系, 系统应当遵循如下准则:</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-10-56-57.png" alt="2020-07-06-10-56-57"></p> <p><strong>同步 - 直接相互制约关系</strong>:</p> <ul><li><strong>定义</strong>: 若一个进程收不到另一个进程给它提供的必要信息就无法运行下去, 这两个进程呈现出 &quot;同步&quot; 的关系.</li></ul> <p><strong>临界资源 &amp; 临界区</strong>: 把同时仅允许一个进程使用的资源称为『 临界资源 』</p> <ul><li>为了保证对临界资源的正确使用, 可以把对临界资源的访问过程分为如下 4 个部分, 它们都属于要访问临界资源的进程, 是进程中的一部分代码:
<ul><li><strong>进入区</strong>: 在进入临界区使用临界资源之前, 需要在进入区检查该进程是否可以进入临界资源;</li> <li><strong>临界区</strong>: 进程中用于访问临界资源的代码;</li> <li><strong>退出区</strong>: 释放对于临界区相应的限制, 允许其他进程进入;</li> <li><strong>剩余区</strong>: 进程中除了上述三个部分之外的其他代码;</li></ul></li></ul> <h4 id="互斥实现方法"><a href="#互斥实现方法" class="header-anchor">#</a> 互斥实现方法</h4> <p>可以通过软件方法, 或者硬件方法来实现进程间互斥. 下面 👇 只介绍软件方法的实现:</p> <p><strong>算法 1</strong>:</p> <p><strong>设置一个公用整形变量 <code>turn</code>, 用来表示允许进入临界区的进程标识</strong>.</p> <ul><li>若 <code>turn</code> 为 <code>0</code>, 则允许进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.92ex" viewBox="0 -683 1045.6 848.6" style="vertical-align:-0.375ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g></g></svg></mjx-container> 进入临界区. 否则循环检查该变量, 直到 <code>turn</code> 变为 <code>0</code>;</li> <li>在 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.92ex" viewBox="0 -683 1045.6 848.6" style="vertical-align:-0.375ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g></g></svg></mjx-container> 的退出区, 修改 <code>turn</code> 为 <code>1</code>, 此时进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 则可以进入临界区;</li> <li>在 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 的退出区, 再把 <code>turn</code> 改为 <code>0</code>. 如此循环往复;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-11-06-59.png" alt="2020-07-06-11-06-59"></p> <p>此方法强制两个进程交替地进入临界区, 很容易造成资源利用不充分:</p> <ul><li>🌰 例如, <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.92ex" viewBox="0 -683 1045.6 848.6" style="vertical-align:-0.375ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g></g></svg></mjx-container> 在退出区把 <code>turn</code> 改为 <code>1</code> 允许 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 进入临界区, 但是此时 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 并不想访问临界资源, 而 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.92ex" viewBox="0 -683 1045.6 848.6" style="vertical-align:-0.375ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g></g></svg></mjx-container> 想再次访问临界资源, 可是 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.92ex" viewBox="0 -683 1045.6 848.6" style="vertical-align:-0.375ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g></g></svg></mjx-container> 却无法进入临界区;</li> <li>此算法没有实现『 <strong>空闲让进</strong> 』的准则;</li></ul> <p><strong>算法 2</strong>:</p> <p><strong>设置标示数组 <code>flag[]</code> 来表示进程是否在临界区中执行</strong>:</p> <ul><li>每个元素的初始值均设置为 <code>false</code>;</li> <li>在每个进程访问该临界资源之前, 先检查另一个进程是否在临界区中, 若不在, 则修改本进程对应的临界区标志为 <code>true</code> 并进入临界区;</li> <li>在退出区修改本进程对应的临界区标志为 <code>false</code>;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-11-10-33.png" alt="2020-07-06-11-10-33"></p> <p>虽然解决了 &quot;空闲让进&quot; 的问题, 但是也带来了新的问题:</p> <ul><li>🌰 例如, 如果两个进程同时都想进入临界区, 并且发现对方的临界区标志都为 <code>false</code>, 于是两个进程同时进入了各自的临界区;</li> <li>这样就违背了『 <strong>忙则等待</strong> 』的准则;</li></ul> <p><strong>算法 3</strong>:</p> <p><strong>设置标志数组 <code>flag[]</code> 表示进程是否 &quot;希望&quot; 进入临界区</strong>:</p> <ul><li>每个进程在访问临界资源之前, 先将自己的标志设置为 <code>true</code>, 表示希望进入临界区;</li> <li>然后检查另一个进程的标志, 如果也为 <code>true</code>, 则进程等待. 反之, 则进入临界区;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-11-17-17.png" alt="2020-07-06-11-17-17"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-11-16-59.png" alt="2020-07-06-11-16-59"></p> <p>虽然可以防止两个进程同时进入临界区, 但是可能会出现两个进程同时进不了临界区的问题:</p> <ul><li>🌰 例如, 两个进程都想进入临界区, 它们把自己的标志都设置为 <code>true</code>, 同时去检查对方的状态, 发现对方也想进入临界区. 于是双方都开始等待, 导致谁也进不去临界区;</li> <li>这就造成了『 <strong>死等</strong> 』的现象, 违背了『 <strong>有限等待</strong> 』的准则;</li></ul> <p><strong>算法 4</strong>:</p> <p>是 &quot;算法 1&quot; 和 &quot;算法 3&quot; 的结合.</p> <p><strong>标志数组 <code>flag[]</code> 表示进程是否希望进入临界区, 或是否正在临界区中执行, 此外还设置一个 <code>turn</code> 变量, 表示允许进入临界区的进程标识</strong>:</p> <ul><li>在进程想进入临界区时把对应的 <code>flag</code> 标志设置为 <code>true</code>. 同时把 <code>turn</code> 标志设为允许另一个进程进入临界区;</li> <li>如果恰好此时另一个进程也想进入临界区, 它也会执行上述的操作;</li> <li>无论怎么样, 两个进程同时想进入临界区时, 必定只有一个进程的 <code>flag</code> 标识为 <code>true</code> 同时 <code>turn</code> 标识对应到它. 则此进程进入临界区, 另一个进程等待;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-11-23-22.png" alt="2020-07-06-11-23-22"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-11-23-31.png" alt="2020-07-06-11-23-31"></p> <h4 id="信号量"><a href="#信号量" class="header-anchor">#</a> 信号量</h4> <p>荷兰的计算机科学家 Dijkstra 在 1965 年提出了一个同步机构, 称为『 <strong>信号量</strong> 』基本思想是, 在多个互相合作的进程之间使用简单的信号来同步.</p> <p>信号量是一个确定的二元组 <code>(s,q)</code>:</p> <ul><li><code>s</code> 是一个具有非负初值的整型变量, 表示系统中的某类资源的数目.
<ul><li>值大于 0 时, 表示系统中当前可用资源的数目;</li> <li>值小于 0 时, 表示系统中因请求该类资源而被阻塞的进程的数目;</li></ul></li> <li><code>q</code> 是一个初始状态为空的队列, 用以存放等待访问该资源的进程;</li></ul> <p>建立信号量时, 必须说明 <code>s</code> 的意义和初始值, 并且安排一个空队列;</p> <p>信号量的值只能由 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.699ex" height="1.545ex" viewBox="0 -683 751 683" style="vertical-align:0;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g></g></g></svg></mjx-container> 操作 ( <code>wait</code> 操作 ) 和 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.74ex" height="1.595ex" viewBox="0 -683 769 705" style="vertical-align:-0.05ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g></g></g></svg></mjx-container> 操作 ( <code>signal</code> 操作 ) 改变;</p> <ul><li><mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="4.52ex" height="2.262ex" viewBox="0 -750 1998 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mo" transform="translate(751, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1140, 0)"><path data-c="73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(1609, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container> 执行时, 先执行 <code>s = s - 1</code>, 若 <code>s &gt;= 0</code> 则该进程继续运行. 若 <code>s &lt; 0</code> 则阻塞该进程, 并将它插入到该信号量的等待队列中;</li> <li><mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="4.561ex" height="2.262ex" viewBox="0 -750 2016 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mo" transform="translate(769, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1158, 0)"><path data-c="73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(1627, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container> 执行时, 先执行 <code>s = s + 1</code>, 若 <code>s &gt; 0</code> 则继续执行该进程. 若 <code>s &lt;= 0</code> 则从该信号量等待队列中移出第一个进程, 将其插入到就绪队列, 然后再返回原进程继续执行;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-13-22-37.png" alt="2020-07-06-13-22-37"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-13-22-51.png" alt="2020-07-06-13-22-51"></p> <p><strong>信号量实现进程同步</strong>:</p> <p>假设存在并发进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 和 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container>. <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 中有一条语句 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.3ex" height="1.934ex" viewBox="0 -705 1016.6 855" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="53" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(613, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container>, <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 中有一条语句 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.3ex" height="1.934ex" viewBox="0 -705 1016.6 855" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="53" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(613, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container>, 要求 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.3ex" height="1.934ex" viewBox="0 -705 1016.6 855" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="53" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(613, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 必须在 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.3ex" height="1.934ex" viewBox="0 -705 1016.6 855" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="53" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(613, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 之前执行.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-13-33-01.png" alt="2020-07-06-13-33-01"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-13-33-09.png" alt="2020-07-06-13-33-09"></p> <p><strong>信号量实现进程互斥</strong>:</p> <p>假设有进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 和 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container>, 两者有各自的临界区, 系统要求同时只能有一个进程进入自己的临界区.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-13-36-29.png" alt="2020-07-06-13-36-29"></p> <h4 id="经典同步问题"><a href="#经典同步问题" class="header-anchor">#</a> 经典同步问题</h4> <p><strong>生产者 - 消费者问题</strong>:</p> <p>生产者 - 消费者是对许多相互合作的进程的一种抽象, 描述了一组生产者向一组消费者提供产品, 它们共享一个缓冲区, 生产者向里投入产品, 消费者从中取走产品;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-13-47-22.png" alt="2020-07-06-13-47-22"></p> <hr> <p><strong>读者 - 写者问题</strong>:</p> <p>有许多进程共享一个数据区, 一些进程只向数据区执行 &quot;读取&quot; 操作, 一些进程只向数据区执行 &quot;写入&quot; 操作. 需要满足如下条件:</p> <ul><li>任意多个读者可以同时读数据;</li> <li>一次只能有一个写者可以写入;</li> <li>如果一个写者正在写入, 禁止任何读者执行读操作;</li></ul> <p>该问题可以分情况有多种实现:</p> <ul><li><p><strong>读者优先算法</strong>: 只有当没有读者进行读操作时, 写者才可以写入, 否则写者就等待, 直至所有读者都不再读取数据区;</p> <ul><li>设置整型变量 <code>readcount</code>, 用以记录当前正在读取数据区的读者的数量, 初始值为 0. 大于 0 时, 写者不可以执行写操作;</li> <li>设置互斥信号量 <code>rmutex</code> 初始值为 1, 用以保证多个读者进程对于 <code>readcount</code> 的互斥访问;</li> <li>设置互斥信号量 <code>mutex</code> 初始值为 1, 用以控制写者进程对数据区的互斥访问;</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-13-59-46.png" alt="2020-07-06-13-59-46"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-13-59-53.png" alt="2020-07-06-13-59-53"></p> <ul><li><strong>公平情况算法</strong>: 进程执行的顺序完全按照到达顺序. 即当有读者试图进行读操作时, 如果有写进程正在进行写操作, 后续到达的读者要进行等待;
<ul><li>和读者优先算法相比, 增加一个信号量 <code>wmutex</code> 初始值为 1, 表示是否有写者正在执行, 或在等待执行写操作. 通过 <code>wmutex</code> 可以让读写进程按照到达顺序执行, 避免读者进程优先;</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-14-07-09.png" alt="2020-07-06-14-07-09"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-14-07-19.png" alt="2020-07-06-14-07-19"></p> <ul><li><strong>写者优先算法</strong>: 当写者和读者同时等待时, 写者先执行, 只要等待队列中有写者, 不管何时到达, 都优先与读者执行;
<ul><li>设置信号量 <code>readable</code> 用以控制写者到达时可以优先于读者进入临界区. 第一个写者到达后申请占用 <code>readable</code>, 最后一个写者离开后释放 <code>readable</code>, 期间读者一直申请不到 <code>readable</code> 信号量, 所以就一直被阻塞;</li> <li>设置整型变量 <code>writecount</code> 用以记录写者的数量;</li> <li>设置信号量 <code>wmutex</code> 用以控制写者间互斥访问 <code>writecount</code>;</li> <li>设置信号量 <code>mutex</code> 用于控制写者对数据区的互斥写入;</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-14-18-18.png" alt="2020-07-06-14-18-18"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-14-18-34.png" alt="2020-07-06-14-18-34"></p> <hr> <p><strong>哲学家进餐问题</strong>: 5 个哲学家围绕着一个圆桌而坐, 桌上放着 5 根筷子, 每两个哲学家之间有一根筷子. 哲学家的工作包括 &quot;思考&quot; 和 &quot;进餐&quot;, 进餐时需要同时拿起左右两边的两根筷子, 思考时将筷子放回原处.</p> <ul><li>在这个问题中, 筷子是临界资源, 同一根筷子不能被两个哲学家同时使用, 因此需要设置一个信号量数组来控制哲学家对筷子的使用;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-14-50-31.png" alt="2020-07-06-14-50-31"></p> <ul><li>为了防止『 <strong>死锁</strong> 』的发生 ( 假设 5 个哲学家同时拿左边的筷子, 然后再想拿右边筷子的时, 会因为没有筷子而无限等待 ) 将哲学家编号, 奇数号的哲学家先拿左边的筷子, 偶数号的哲学家先拿右边的筷子;</li></ul> <hr> <p><strong>理发师问题</strong>: 理发店有一个理发师, 一把理发椅和若干供顾客等待的凳子:</p> <ul><li>没有顾客时, 理发师休息.</li> <li>当有一个顾客到来时, 同时没有顾客在剪发, 则顾客坐在理发椅上剪发;</li> <li>如果有顾客正在剪发, 则找椅子坐下来等待;</li> <li>如果没有空椅子, 则顾客离开;</li></ul> <p>第一种思路: <strong>将理发椅和等待的椅子看作是两种不同的资源</strong>;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-15-01-08.png" alt="2020-07-06-15-01-08"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-15-05-13.png" alt="2020-07-06-15-05-13"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-15-05-22.png" alt="2020-07-06-15-05-22"></p> <p>第二种思路: <strong>将理发椅和等待的椅子看作是同一种资源</strong>;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-15-09-13.png" alt="2020-07-06-15-09-13"></p> <h3 id="死锁"><a href="#死锁" class="header-anchor">#</a> 死锁</h3> <p>一组进程中, 所有进程都处于永久阻塞的状态, 每个进程都在无限期地等待某个其他进程占用的资源, 若无外力作用, 这些进程将永远无法向前推进. 这种现象叫做『 <strong>死锁</strong> 』</p> <details open="open" class="custom-block details"><summary>🌰 例子：</summary> <p>例如, 系统中有一台打印机和一台输入设备, 进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 占用输入设备, 同时提出使用打印机的请求. 但是此时打印机被进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 占用. 而 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 在未释放打印机之前, 又提出请求使用正在被 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 占用的输入设备. 这样两个进程就无休止地等待下去, 无法继续执行了.</p></details> <h4 id="死锁产生的原因"><a href="#死锁产生的原因" class="header-anchor">#</a> 死锁产生的原因</h4> <p>可以把系统中的资源分为:</p> <ul><li><strong>可剥夺资源</strong>: 即使资源正被一个进程所占有, 但另一个进程可以强行把该资源剥夺过来自己使用;
<ul><li>进程对于可剥夺资源的竞争不会造成死锁;</li></ul></li> <li><strong>不可剥夺资源</strong>: 一个进程不可以剥夺另一个进程所占有的资源, 资源只能被占用进程主动释放;
<ul><li>进程对于不可剥夺资源的竞争可能会造成死锁;</li></ul></li></ul> <p>一个资源属于哪一种分类, 取决于资源的性质.</p> <ul><li>🌰 例如, 打印机就是一个 &quot;不可剥夺资源&quot;, 而主存和 CPU 就是 &quot;可剥夺资源&quot;.</li></ul> <hr> <p><strong>死锁产生的原因是进程间竞争资源</strong>. 如果系统中只有一个进程在运行, 它独享所有的资源, 就不会有死锁发生了.</p> <p>下图 👇 展示了进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 和 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 的运行时对资源的请求步骤.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-22-19-09.png" alt="2020-07-06-22-19-09"></p> <p><mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 和 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 进程对资源 A 和 B 产生了竞争, 但是资源竞争不一定会产生死锁, 只有进程运行过程中请求和释放资源的顺序不当时, 才会导致死锁.</p> <p>下图 👇 展示了不同执行顺序时, 两条进程运行的情况;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-22-24-18.png" alt="2020-07-06-22-24-18"></p> <ul><li>在路径 ④ 中, <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 先申请资源 B, <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 再申请资源 A. 此时资源 A 和 B 都被占用了, 进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 没有办法申请资源 B, 进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 也没有办法申请资源 A. 进程陷入了死锁.</li> <li>其他执行路径下, 两条线程都可以顺利执行;</li></ul> <h4 id="死锁产生的必要条件"><a href="#死锁产生的必要条件" class="header-anchor">#</a> 死锁产生的必要条件</h4> <p>从上面的论述可以推出, 死锁产生的必要条件有如下 4 条:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-06-22-10-47.png" alt="2020-07-06-22-10-47"></p> <h4 id="处理死锁的基本方法"><a href="#处理死锁的基本方法" class="header-anchor">#</a> 处理死锁的基本方法</h4> <p>目前处理死锁的方法主要有 4 种:</p> <ol><li><strong>鸵鸟算法</strong>: 对死锁视而不见, 不解决死锁;</li> <li><strong>预防死锁</strong>: 通过设置某些限制条件, 去破坏产生死锁的 4 个必要条件中的一个或几个来预防死锁的产生;</li> <li><strong>避免死锁</strong>: 在资源的动态分配过程中, 用某种方式避免系统进入可能会产生死锁的不安全状态, 从而避免死锁的产生;</li> <li><strong>检查及解除死锁</strong>: 及时检测出死锁的发生, 然后采取某种措施解除死锁;</li></ol> <h4 id="死锁的预防"><a href="#死锁的预防" class="header-anchor">#</a> 死锁的预防</h4> <p>要想防止死锁, 只需破坏产生死锁的 4 个必要条件之一即可.</p> <p><strong>1 - 破坏互斥条件</strong>: 允许多个进程同时访问同一个资源, 但有些资源同一时间只能被一个进程访问. 所以通过破坏互斥条件来防止死锁的发生是不太可取的方案;</p> <p><strong>2 - 破坏不剥夺条件</strong>: 对于一个已经获得某些资源的进程, 若进程想要请求的新资源不能被满足, 则它必须释放所有已经获取的资源, 等以后再重新申请资源.</p> <ul><li>这种方式使得进程之前为获得资源所做的工作都被抛弃了, 造成了系统开销的浪费, 降低了系统吞吐量;</li> <li>这种方式通常不会应用于剥夺资源后代价太大的场合;</li></ul> <p><strong>3 - 破坏请求与保持条件</strong>: 可以采用 &quot;预先静态分配方式&quot;, 在进程运行前一次性申请所有所需的资源, 在资源未满足之前不投入运行. 一旦投入运行, 这些资源就一直归他所有. 但是这样对于那些在进程中只在后期采用到, 或者在某些情况下根本不会用到的资源, 也要预先申请, 导致资源不能被充分利用, 资源利用率下降;</p> <p><strong>4 - 破坏环路等待条件</strong>: 可以采用 &quot;有序资源分配法&quot;, 将系统中所有的资源按照类型赋予一个编号, 要求每个进程严格按照编号递增的次序请求资源, 同类资源一次性申请完. 这样就不会出现进程对资源的请求出现环路的情况. 但是对于资源编号后不宜修改, 限制了新资源的添加. 而且不同作业对于资源的使用顺序也不可控, 也增加了程序编程的复杂性;</p> <h4 id="死锁的避免"><a href="#死锁的避免" class="header-anchor">#</a> 死锁的避免</h4> <p>&quot;预防死锁&quot; 中介绍的策略, 都施加了较强的限制条件. 实现起来简单, 但是限制了系统性能.</p> <p>&quot;避免死锁&quot; 的方法中, 所施加的限制较弱, 有可能获得较好的系统性能.</p> <p><strong>安全状态 &amp; 不安全状态</strong>:</p> <p>在避免死锁的方法中, 允许进程动态的申请资源, 系统在资源分配之前, 先计算资源分配的安全性.</p> <ul><li>若某一时刻, 系统能按照某种顺序为每个进程分配所有所需的资源, 使得每个进程都能顺利完成, 则成为此时的系统处于『 <strong>安全状态</strong> 』称该序列为『 <strong>安全序列</strong> 』</li> <li>若某一时刻不存在这样的安全序列, 则称系统状态为『 <strong>不安全状态</strong> 』, 有可能会发生 &quot;<strong>死锁</strong>&quot;</li></ul> <p><strong>银行家算法</strong>:</p> <p>最具有代表性的避免死锁的算法是 &quot;银行家算法&quot;. 假设系统中有 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" viewBox="0 -442 600 453" style="vertical-align:-0.025ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container> 个进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="15.063ex" height="2.262ex" viewBox="0 -750 6658 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(389, 0)"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(1434.6, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(1879.2, 0)"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(2924.8, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(3369.4, 0)"><path data-c="22EF" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250ZM525 250Q525 274 542 292T585 310Q609 310 627 294T646 251Q646 226 629 208T586 190T543 207T525 250ZM972 250Q972 274 989 292T1032 310Q1056 310 1074 294T1093 251Q1093 226 1076 208T1033 190T990 207T972 250Z"></path></g><g data-mml-node="mo" transform="translate(4708.1, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(5152.8, 0)"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(642, -150) scale(0.707)"><path data-c="6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(6269, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container> , <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.986ex" height="1.025ex" viewBox="0 -442 878 453" style="vertical-align:-0.025ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container> 类资源 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="15.858ex" height="2.262ex" viewBox="0 -750 7009 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(389, 0)"><g data-mml-node="mi"><path data-c="52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mn" transform="translate(759, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(1551.6, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(1996.2, 0)"><g data-mml-node="mi"><path data-c="52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mn" transform="translate(759, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(3158.8, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(3603.4, 0)"><path data-c="22EF" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250ZM525 250Q525 274 542 292T585 310Q609 310 627 294T646 251Q646 226 629 208T586 190T543 207T525 250ZM972 250Q972 274 989 292T1032 310Q1056 310 1074 294T1093 251Q1093 226 1076 208T1033 190T990 207T972 250Z"></path></g><g data-mml-node="mo" transform="translate(4942.1, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(5386.8, 0)"><g data-mml-node="mi"><path data-c="52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mi" transform="translate(759, -150) scale(0.707)"><path data-c="6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(6620, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>, 银行家算法中需要创建如下的数据结构:</p> <ul><li><strong>可利用资源向量 Avaliable</strong>: 含有 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.986ex" height="1.025ex" viewBox="0 -442 878 453" style="vertical-align:-0.025ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container> 个元素的数组, 其中 <code>Avaliable[i]</code> 的值表示第 <code>i</code> 类资源现有的空闲数量, 其初始值为该资源的总数量, 其值随着资源的分配与回收动态变化;</li> <li><strong>最大需求矩阵 Max</strong>: 是一个 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="4.638ex" height="1.025ex" viewBox="0 -442 2050 453" style="vertical-align:-0.025ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(600, 0)"><path data-c="78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mi" transform="translate(1172, 0)"><path data-c="6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container> 的二维数组矩阵, 定义了系统中每一个进程对每类资源的最大需求数量, <code>Max[i][j]</code> 表示的值是第 <code>i</code> 个进程对第 <code>j</code> 类资源的最大需求数;</li> <li><strong>分配矩阵 Allocation</strong>: 是一个 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="4.638ex" height="1.025ex" viewBox="0 -442 2050 453" style="vertical-align:-0.025ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(600, 0)"><path data-c="78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mi" transform="translate(1172, 0)"><path data-c="6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container> 的二维数组矩阵, 定义了系统中每一类资源当前以及分配给每一个进程的资源数目. <code>Allocation[i][j]</code> 表示的值是第 <code>i</code> 个进程当前拥有的第 <code>j</code> 类资源的数量;</li> <li><strong>需求矩阵 Need</strong>: 是一个 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="4.638ex" height="1.025ex" viewBox="0 -442 2050 453" style="vertical-align:-0.025ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(600, 0)"><path data-c="78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mi" transform="translate(1172, 0)"><path data-c="6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container> 的二维数组矩阵, 定义了每个进程还需要的各类资源的数目;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-10-33-10.png" alt="2020-07-07-10-33-10"></p> <p>银行家算法的描述:</p> <p>定义 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="8.672ex" height="1.984ex" viewBox="0 -683 3833 877" style="vertical-align:-0.439ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mi" transform="translate(759, 0)"><path data-c="65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(1225, 0)"><path data-c="71" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(1671, 0)"><path data-c="75" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2243, 0)"><path data-c="65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(2709, 0)"><path data-c="73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="msub" transform="translate(3178, 0)"><g data-mml-node="mi"><path data-c="74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(361, -150) scale(0.707)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container> 向量, 表示第 <code>i</code> 个进程向系统提出的一次申请, 申请的各类资源的数量就是该向量的各个分量;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-10-20-47.png" alt="2020-07-07-10-20-47"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-10-17-54.png" alt="2020-07-07-10-17-54"></p> <p>安全性算法的描述:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-10-25-48.png" alt="2020-07-07-10-25-48"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-10-25-35.png" alt="2020-07-07-10-25-35"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-10-24-29.png" alt="2020-07-07-10-24-29"></p> <details open="open" class="custom-block details"><summary>🌰 例子：</summary> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-11-06-07.png" alt="2020-07-07-11-06-07"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-11-06-42.png" alt="2020-07-07-11-06-42"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-11-06-55.png" alt="2020-07-07-11-06-55"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-11-07-08.png" alt="2020-07-07-11-07-08"></p></details> <h4 id="死锁的检测-解除"><a href="#死锁的检测-解除" class="header-anchor">#</a> 死锁的检测 &amp; 解除</h4> <p><strong>死锁检测</strong>:</p> <p>进程对于资源的请求与占用可以用 &quot;资源分配图 System Resource Allocation Graph, SRAG&quot; 来表示.</p> <ul><li>用圆圈代表进程. 用方框代表每类资源, 框内用圆圈代表资源的个数;</li> <li>&quot;申请资源&quot; 用一条从进程到资源的有向边来表示;</li> <li>&quot;分配资源&quot; 用一条从资源到进程的有向边来表示;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-11-25-23.png" alt="2020-07-07-11-25-23"></p> <p>上图 👆 表示的状态如下:</p> <ul><li>进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 已经占用两个 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.933ex" height="1.339ex" viewBox="0 -442 854.6 592" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(451, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 资源, 而且正在申请一个 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.933ex" height="1.339ex" viewBox="0 -442 854.6 592" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(451, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 资源;</li> <li>进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.366ex" height="1.885ex" viewBox="0 -683 1045.6 833" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(642, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 已经占用一个 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.933ex" height="1.339ex" viewBox="0 -442 854.6 592" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(451, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 资源和一个 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.933ex" height="1.339ex" viewBox="0 -442 854.6 592" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(451, -150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container> 资源, 而且正在申请一个 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.933ex" height="1.339ex" viewBox="0 -442 854.6 592" style="vertical-align:-0.339ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(451, -150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container> 资源;</li></ul> <p>可以通过简化资源分配图的方式来检测是否系统状态 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.387ex" height="1.645ex" viewBox="0 -705 613 727" style="vertical-align:-0.05ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="53" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g></g></g></svg></mjx-container> 是死锁状态:</p> <ul><li>在图中找到一个 &quot;即不拥塞又非孤立&quot; 的进程节点 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.118ex" height="1.902ex" viewBox="0 -683 936 840.8" style="vertical-align:-0.357ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(642, -150) scale(0.707)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container> ( 存在与资源连接 ) 并且申请资源的数量小于系统中已有的空闲资源的数量;</li> <li>也就是说 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.118ex" height="1.902ex" viewBox="0 -683 936 840.8" style="vertical-align:-0.357ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(642, -150) scale(0.707)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container> 可以获得所需的所有资源, 并且正常完成运行, 然后释放占用的所有资源. 相当于 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.118ex" height="1.902ex" viewBox="0 -683 936 840.8" style="vertical-align:-0.357ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(642, -150) scale(0.707)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container> 消去所有与资源连接的边, 变成一个孤立的节点;</li> <li>进程 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="2.118ex" height="1.902ex" viewBox="0 -683 936 840.8" style="vertical-align:-0.357ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(642, -150) scale(0.707)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container> 释放完资源后, 可以唤醒那些因等待资源而 &quot;阻塞&quot; 的进程成为 &quot;非阻塞进程&quot;, 然后再按照上面的步骤进行简化;</li> <li>重复前面的两个步骤之后, 如果能消去图中所有的边, 则称该图是『 <strong>可完全简化的</strong> 』否则就是『 <strong>不可完全简化的</strong> 』, 系统处于 &quot;死锁&quot; 状态;</li></ul> <p><strong>死锁检测算法</strong>:</p> <p>死锁检测算法通过判断某一时刻系统是否处于 &quot;不可完全简化的&quot; 状态, 来判断是否系统发生了死锁. 具体思路:</p> <ul><li>获得某时刻 <code>t</code> 系统中各类可利用资源的数目向量 <code>avaliable(t)</code>;</li> <li>然后找出一个即不拥塞又非孤立的进程, 它对各类资源请求的数目均小于系统现有的各类可用资源的数目. 也就是说它能获得所有所需的资源, 正常运行结束, 然后释放占用的资源;</li> <li>把这样的进程加入到 &quot;可运行结束&quot; 的进程序列中. 然后假设该进程执行结束, 释放了所有资源, 之后再对剩下的进程再进行上述的考察;</li> <li>如果有几个进程不能加入 &quot;可运行结束&quot; 序列的话, 那么系统就发生了死锁;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-11-23-54.png" alt="2020-07-07-11-23-54"></p> <p><strong>死锁解除</strong>:</p> <p>一旦检测出死锁, 就应该让陷入死锁的进程从死锁状态中解除出来. 常用方法有 3 个:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-11-24-57.png" alt="2020-07-07-11-24-57"></p> <h4 id="死锁-饿死"><a href="#死锁-饿死" class="header-anchor">#</a> 死锁 &amp; 饿死</h4> <p>有的时候系统的资源分配策略是不公平的, 可能进程间不会发生死锁, 但是有的进程需要等待很长时间才能获得所需的资源. 这个等待时间给进程的执行带来了明显的影响, 这种现象称为『 <strong>进程饥饿</strong> 』当饥饿达到一定程度, 即使进程执行完毕可能也不再具有实际意义时, 称为『 <strong>饿死</strong> 』</p> <p>与饥饿相关的一个概念是『 <strong>活锁</strong> 』, 指的是进程发生了饥饿, 一直在等待资源, 不能继续执行, 好像 &quot;死锁&quot; 一样. 但是进程最终是可以得到资源的;</p> <h2 id="内存管理"><a href="#内存管理" class="header-anchor">#</a> 内存管理</h2> <h3 id="内存管理基础"><a href="#内存管理基础" class="header-anchor">#</a> 内存管理基础</h3> <p>应用程序从源文件到内存中执行的进程, 大致分为 3 个阶段:</p> <ol><li>通过 &quot;<strong>编译程序</strong> Compiler&quot; 将源代码编译成若干个 &quot;目标模块 Object Module&quot;;</li> <li>然后通过 &quot;<strong>链接程序</strong> Linker&quot; 将目标模块以及程序所需的类库链接在一起, 形成完整的 &quot;装入模块 Load Module&quot;;</li> <li>最后, 通过 &quot;<strong>装入程序</strong> Loader&quot; 将装入模块装入内存并执行;</li></ol> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-13-41-10.png" alt="2020-07-07-13-41-10"></p> <ul><li>对于程序开发者来说, 它们并不需要知道数据和程序段存放的具体地址, 它们通过给数据和程序段用标识符命名, 然后通过名称就可以对其进行访问了. 这些名称称为程序『 <strong>名地址 / 符号名地址</strong> 』</li> <li>源代码编译成目标代码后, 并一起无法得知代码最终在内存中的物理位置, 所以 0 号单元开始编址, 这称为程序的『 <strong>相对地址 / 虚拟地址 / 逻辑地址</strong> 』</li> <li>链接程序把多个从 0 号开始编址的模块, 链接成一个装入模块时, 会按照各个模块的相对地址将其地址构成统一的从 0 开始编址的相对地址;</li> <li>当装入程序把装入模块装入内存时, 通过地址转换将逻辑地址转换成实际的『 <strong>物理地址</strong> 』, 这个过程叫做『 <strong>重定位</strong> 』</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-13-43-33.png" alt="2020-07-07-13-43-33"></p> <p>程序的 &quot;<strong>装入</strong>&quot; 有 3 种方式:</p> <ul><li><strong>绝对装入</strong>: 编译时就知道程序将要驻留在内存的物理地址，编译程序产生含有物理地址的目标代码;</li> <li><strong>可重定位装入</strong>: 根据内存当前的状况，将装入模块装入到内存的适当位置，地址变换通常在装入时一次完成之后不会再改变。这种方式也称为『 <strong>静态重定位</strong> 』。实现起来非常简单，将操作系统为程序分配了一个以某地址为起始地址的一个连续主存区域后，重定位是将程序中指令或者操作数的逻辑地址加上这个起始地址就得到了物理地址。
<ul><li>要求为每个程序分配一个连续的储存区, 如果空间不足以放下程序就不分配, 程序执行期间不能移动, 不能再申请新的内存;</li></ul></li> <li><strong>动态运行装入</strong>: 允许程序运行时在内存中移动位置。装入模块装入到内存后，所有的地址都是相对地址，在程序执行过程中，每当访问到相应的指令或数据时，才将对应的相对地址转化为物理地址。也称为『 <strong>动态重定位</strong> 』。实现时要依靠硬件地址变换机构。
<ul><li>可以将程序分配到不连续的存储区中, 程序运行之前装入它的部分代码即可投入运行, 程序运行期间可以根据需求动态申请新内存;</li></ul></li></ul> <h4 id="覆盖-交换"><a href="#覆盖-交换" class="header-anchor">#</a> 覆盖 &amp; 交换</h4> <p><strong>覆盖技术 Overlay</strong>:</p> <ul><li>主要应用于早期的操作系统中, 早期计算机中内存的容量很小, 某些大作业不能一次性装入内存中;</li> <li>覆盖技术把一个大的程序划分成一系列相对独立的程序单位, 每个单位称为『 <strong>覆盖</strong> 』</li> <li>把程序执行时并不要求同时装入内存的覆盖组成一组, 称为『 <strong>覆盖段</strong> 』</li> <li>覆盖段分配到同一个存储区域, 称为『 <strong>覆盖区</strong> 』, 覆盖区的大小由对应覆盖段中最大的覆盖来确定. 每次只将覆盖段中的一个覆盖装入内存中;</li> <li>覆盖技术打破了必须将一个进程的全部信息都装入主存才能运行的限制;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-14-03-05.png" alt="2020-07-07-14-03-05"></p> <p><strong>交换技术 Swapping</strong>:</p> <ul><li>交换技术把暂时不用的某个程序及数据部分从内存移到外存中去, 以便腾出必要的内存空间;</li> <li>处理器三级调度中的 &quot;中级调度&quot; 就采用了交换技术, 把暂时不用的进程移入外存;</li> <li>交互记住打破了一个程序一旦进入主存便一直运行到结束的限制;</li></ul> <h4 id="内存管理的功能"><a href="#内存管理的功能" class="header-anchor">#</a> 内存管理的功能</h4> <p>总的来说, 操作系统提供的内存管理主要包含如下功能:</p> <ul><li><strong>内存的分配 &amp; 回收</strong>: 为程序的运行提供内存的分配与回收;</li> <li><strong>地址变换</strong>: 将程序的逻辑地址转换成内存中的物理地址;</li> <li><strong>扩充内存</strong>: 为用户提供比物理内存空间更大的虚拟地址空间, 从逻辑上实现扩充内存容量的目的;</li> <li><strong>存储保护</strong>: 保证进入内存的各个进程都在自己的存储空间内运行, 互不干扰;</li></ul> <h3 id="连续分配管理方式"><a href="#连续分配管理方式" class="header-anchor">#</a> 连续分配管理方式</h3> <p><strong>连续分配只允许将一个程序装入到连续的内存分区中</strong>.</p> <details open="open" class="custom-block details"><summary>内部碎片 &amp; 外部碎片：</summary> <p>在介绍连续分配管理方式之前, 先介绍 &quot;内部碎片&quot; 和 &quot;外部碎片&quot; 概念:</p> <ul><li><strong>内部碎片</strong>: 已经分配给进程, 但是不能被利用的内存空间;</li> <li><strong>外部碎片</strong>: 因为空间太小, 而无法分配给申请内存的新进程的内存空间;</li></ul></details> <h4 id="单一连续分配"><a href="#单一连续分配" class="header-anchor">#</a> 单一连续分配</h4> <ul><li>最简单的存储管理方式, 通常只用于单用户, 单任务的操作系统中;</li> <li>将内存分为两个连续存储区域, 一个区域固定地分配给操作系统使用. 另一部分给用户作业使用, 通常用户作业只占用一部分内存, 剩下的内存空间就被浪费掉了, 会产生 &quot;内部碎片&quot;;</li> <li>采用 &quot;静态重定位&quot; 方式把进程装入内存, 适合单道程序, 可采用覆盖技术. 进程一旦进入内存, 就要等待进程结束才能是否内存. 无法实现多道程序共享内存;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-15-59-56.png" alt="2020-07-07-15-59-56"></p> <h4 id="固定分区分配"><a href="#固定分区分配" class="header-anchor">#</a> 固定分区分配</h4> <ul><li>是一种最简单的适应于多道程序的存储管理方式;</li> <li>将内存划分为若干个固定大小的分区, 每个分区可以装入一道程序. 分区大小可以不等, 但事先必须确定, 运行时不可以更改;
<ul><li>系统需要一张分区说明表, 以记录可用于分配的分区号, 分区的大小, 分区的起始地址, 以及分区状态;</li> <li>当某个用户程序要装入内存时, 由 &quot;内存分配程序&quot; 检索分区说明表, 找出能满足需求的 &quot;未分配&quot; 分区分配给该程序. 然后修改分区说明表中相应分区的状态为 &quot;已分配&quot;. 如果找不到大小足够的分区, 则拒绝为此程序分配内存;</li></ul></li> <li>采用 &quot;静态重定位&quot; 方式进程装入内存. 不能实现多道程序共享一个主存空间, 内存利用率较低, 会产生 &quot;内部碎片&quot;;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-16-00-08.png" alt="2020-07-07-16-00-08"></p> <h4 id="动态连续分配"><a href="#动态连续分配" class="header-anchor">#</a> 动态连续分配</h4> <p>是一种动态划分内存空间的存储管理方式. 在作业进入主存时, 根据作业大小动态地建立分区, 使分区的大小刚好满足作业的需求;</p> <p><strong>分区分配中的数据结构</strong>:</p> <p>需要创建相应的数据结构来记录内存的使用情况, 常用的有两种形式:</p> <ul><li><strong>空闲分区表</strong>: 设置一个表格来登记内存中的空闲分区, 每个表项包含分区号, 起始地址, 空间大小, 状态;</li> <li><strong>空闲分区链</strong>: 设置一个链表把内存中的空闲分区用指针链接起来. 用每个空闲分区的起始的若干字节空间存放相关信息, 以及一个指向下一个空间的指针;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-16-10-03.png" alt="2020-07-07-16-10-03"></p> <p><strong>分区分配的算法</strong>:</p> <p>需要按照一定的策略从空闲分区表中选出一个满足作业需求的分区分配给作业. 如果空闲分区的容量大于作业需要的空间大小, 则把多出来的空间仍然留在空闲分区表中, 同时需要对空闲分区表中相关的信息进行修改.</p> <p>目前常用的分配算法有 4 种:</p> <ol><li><strong>首次适应算法</strong>:
<ul><li>把空闲分区按照 &quot;地址递增&quot; 的次序在空闲分区表上顺序排列, 每次分配内存时从队首开始找, 直到找到足够大的空闲分区, 然后按照作业大小从空闲分区划分一块内存空间给作业. 剩下的部分留在空闲分区表;</li> <li>由于经常有被分割下来的剩余空间, 所以会导致存在很多 &quot;外部碎片&quot;. 而且每次都从头开始找空闲分区, 加大了查找的开销;</li></ul></li> <li><strong>下次适应算法</strong>:
<ul><li>在 &quot;首次适应算法&quot; 的基础上, 把队列改成循环队列. 而且每次从上次找到的空闲分区的下一个分区开始找;</li> <li>不用每次都从头开始找, 减少了查找的开销. 但是可能每次查找到的空闲分区的大小可能要比作业需要的大很多, 导致大的空间被切分, 致使缺乏大的空闲分区;</li></ul></li> <li><strong>最佳适应算法</strong>:
<ul><li>要求将空闲分区按照 &quot;容量大小递增&quot; 的次序排列, 每次未作业分配空间时, 都能找到满足空间大小的最小的空闲分区;</li> <li>但是也会产生很多 &quot;外部碎片&quot;;</li></ul></li> <li><strong>最差适应算法</strong>:
<ul><li>要求将空闲分区按照 &quot;容量大小递减&quot; 的次序排列, 每次总是将满足要求的最大的空闲空间分配给作业;</li> <li>会造成大的空闲空间被分割, 致使缺乏大的空闲分区;</li></ul></li></ol> <p><strong>分区的回收</strong>:</p> <ul><li>作业执行结束后, 系统回收已使用完毕的分区. 根据回收分区的大小和首地址, 在空闲分区表中查找其有没有相邻的空闲分区, 如果有的话就将它们合并成一个大的空闲分区, 并修改相关的分区信息;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-16-33-44.png" alt="2020-07-07-16-33-44"></p> <p><strong>分区分配的动态管理</strong>:</p> <p>通过经常的切割空闲分区, 产生了很多个 &quot;外部碎片&quot;. 致使最终有一堆空间很小的空闲分区, 分区的大小都不足以放入一个作业了.</p> <p>为了能够对这些分区进行利用, 需要进行分区分配动态管理. 常用方法有如下两种:</p> <ul><li><strong>拼接技术</strong>: 将已分配分区全部移动到主存的一端, 将内存中无法被利用的存储空间连接成一个大的空闲分区;</li> <li><strong>动态重定位分区分配技术</strong>: 在分配算法中添加拼接功能;</li></ul> <p><strong>优缺点</strong>:</p> <ul><li><strong>优点</strong>:
<ul><li>实现了多道程序共用主存, 也就是多个进程同时存在于主存的不同位置;</li></ul></li> <li><strong>缺点</strong>:
<ul><li>主存利用不够充分, 存在 &quot;外部碎片&quot;;</li> <li>没有实现多进程共享主存, 也就是多个进程都使用同一个内存空间;</li> <li>没有实现主存的扩充. 进程可使用的内存地址空间依旧是内存的物理空间大小;</li></ul></li></ul> <h3 id="非连续分配管理方式"><a href="#非连续分配管理方式" class="header-anchor">#</a> 非连续分配管理方式</h3> <p><strong>非连续分配允许将一个程序分散地装入到不相邻的内存分区中</strong>.</p> <p>根据分区大小是否固定分为:</p> <ul><li><strong>分页存储管理</strong>: 根据运行作业时是否需要把作业的所有页都装入内存才能运行而分为:
<ul><li>基本分页存储管理方式;</li> <li>请求分页存储管理方式;</li></ul></li> <li><strong>分段存储管理</strong>;</li></ul> <h4 id="基本分页存储管理方式"><a href="#基本分页存储管理方式" class="header-anchor">#</a> 基本分页存储管理方式</h4> <p><strong>分页的原理</strong>:</p> <ul><li>用户作业的地址空间被划分为若干个大小相等的区域, 称为『 <strong>页 / 页面</strong> 』</li> <li>将主存的存储空间也分为与页面大小相等的区域, 称为『 <strong>块 / 物理块</strong> 』</li> <li>在为作业分配存储空间时, 总是以 &quot;块&quot; 为单位来分配, 可以将作业中的任意一页放到主存的任意一块中;</li> <li>在进行进程调度时, 必须将作业的所有页面一次调入主存. 如果主存中没有足够的物理块, 则作业等待.这种储存管理方式称为『 <strong>简单分页 / 纯分页</strong> 』</li></ul> <p>分页存储管理系统中的 &quot;逻辑地址&quot; 包含两个部分:</p> <ul><li>页号 P;</li> <li>页内位移 W:</li></ul> <p>假设逻辑地址为 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.697ex" height="1.62ex" viewBox="0 -716 750 716" style="vertical-align:0;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g></g></svg></mjx-container>, 页面的大小为 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="1.541ex" height="1.545ex" viewBox="0 -683 681 683" style="vertical-align:0;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="4C" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path></g></g></g></svg></mjx-container>:</p> <ul><li>页号 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="14.3ex" height="2.262ex" viewBox="0 -750 6320.6 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mo" transform="translate(1028.8, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(2084.6, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2473.6, 0)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2818.6, 0)"><path data-c="6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(3418.6, 0)"><path data-c="74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(3779.6, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mspace" transform="translate(4168.6, 0)"></g><g data-mml-node="mi" transform="translate(4389.6, 0)"><path data-c="41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="TeXAtom" transform="translate(5139.6, 0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mi" transform="translate(5639.6, 0)"><path data-c="4C" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path></g></g></g></svg></mjx-container></li> <li>页内位移 <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="10.51ex" height="1.882ex" viewBox="0 -750 4645.6 832" style="vertical-align:-0.186ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="57" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="mo" transform="translate(1325.8, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2381.6, 0)"><path data-c="41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(3131.6, 0)"><path data-c="25" d="M465 605Q428 605 394 614T340 632T319 641Q332 608 332 548Q332 458 293 403T202 347Q145 347 101 402T56 548Q56 637 101 693T202 750Q241 750 272 719Q359 642 464 642Q580 642 650 732Q662 748 668 749Q670 750 673 750Q682 750 688 743T693 726Q178 -47 170 -52Q166 -56 160 -56Q147 -56 142 -45Q137 -36 142 -27Q143 -24 363 304Q469 462 525 546T581 630Q528 605 465 605ZM207 385Q235 385 263 427T292 548Q292 617 267 664T200 712Q193 712 186 709T167 698T147 668T134 615Q132 595 132 548V527Q132 436 165 403Q183 385 203 385H207ZM500 146Q500 234 544 290T647 347Q699 347 737 292T776 146T737 0T646 -56Q590 -56 545 0T500 146ZM651 -18Q679 -18 707 24T736 146Q736 215 711 262T644 309Q637 309 630 306T611 295T591 265T578 212Q577 200 577 146V124Q577 -18 647 -18H651Z"></path></g><g data-mml-node="mi" transform="translate(3964.6, 0)"><path data-c="4C" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path></g></g></g></svg></mjx-container></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-17-55-22.png" alt="2020-07-07-17-55-22"></p> <p><strong>页表</strong>:</p> <p>使用 &quot;页表&quot; 记录页面与内存块的映射关系. 页表中的每项由 &quot;页号&quot; 和 &quot;块号&quot; 组成.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-18-02-48.png" alt="2020-07-07-18-02-48"></p> <p><strong>基本地址变换机构</strong>:</p> <p>使用一个 <strong>页面寄存器 PTR</strong> 来存放页表在内存中的起始地址和页表的长度.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-18-04-44.png" alt="2020-07-07-18-04-44"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-18-06-27.png" alt="2020-07-07-18-06-27"></p> <p><strong>具有 &quot;快表&quot; 的地址变换机构</strong>:</p> <p>可以在地址变换机构中添加一个具有并行查找功能的高速缓冲存储器, 称为『 <strong>快表</strong> 』存放正在运行的作业正在访问的那些页表项, 其余部分仍旧放在内存中.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-18-09-47.png" alt="2020-07-07-18-09-47"></p> <p><strong>两级页表</strong>:</p> <ul><li>随着页号位数的增加, 页表长度会指数增加. 会导致整张页表很难连续地存放在内存中;</li> <li>两级页表将逻辑地址划分为 &quot;外层页号&quot; &quot;外层页内地址&quot; &quot;页内地址&quot;;
<ul><li>先用外层页号 P1 在 &quot;外部页表&quot; 上查找, 找出对应的 &quot;二级页表&quot; 的首地址;</li> <li>然后用二层页表的首地址, 加上外层页内地址 P2 得到页表项地址;</li> <li>取出里面的值 ( 即物理块号 ) 与页内地址 d 相结合就得到物理地址;</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-18-12-57.png" alt="2020-07-07-18-12-57"></p> <p><strong>页的共享</strong>: 实现共享的方式是, 让共享的用户地址空间中的页指向相同的物理块;</p> <h4 id="基本分段存储管理方式"><a href="#基本分段存储管理方式" class="header-anchor">#</a> 基本分段存储管理方式</h4> <ul><li>作业的地址空间由若干个逻辑分段组成. 每个分段有自己的名字;</li> <li>每个分段都是从 0 开始编址, 并采用一段连续的地址空间;</li> <li>各段之间不要求连续;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-18-24-27.png" alt="2020-07-07-18-24-27"></p> <p><strong>段表及地址变换过程</strong>:</p> <p>系统为每个进程建立了一个 &quot;段表&quot;, 来记录每个分段的逻辑地址与物理地址的映射关系. 表项中包含 &quot;段号&quot;, &quot;段长&quot;, &quot;段的内存起始地址&quot;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-18-28-24.png" alt="2020-07-07-18-28-24"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-18-30-01.png" alt="2020-07-07-18-30-01"></p> <p>系统中设置 <strong>段表寄存器</strong> 来存放段表的起始地址和段表长度.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-18-29-51.png" alt="2020-07-07-18-29-51"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-18-31-43.png" alt="2020-07-07-18-31-43"></p> <p><strong>分段的共享</strong>: 通过使多个作业的段表中相应表项都指向被共享段的同一个物理副本来实现;</p> <p><strong>分段和分页的区别</strong>:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-18-34-17.png" alt="2020-07-07-18-34-17"></p> <h4 id="基本段页式存储管理方式"><a href="#基本段页式存储管理方式" class="header-anchor">#</a> 基本段页式存储管理方式</h4> <p>地址空间首先被分为若干个逻辑分段, 每段都有自己的段号. 然后再奖每一段分为若干个大小固定的页. 主存空间分为若干个页面大小的物理块;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-22-48-29.png" alt="2020-07-07-22-48-29"></p> <p>系统需要为每个进程建立一张 &quot;段表&quot; 和一张 &quot;页表&quot;. 需要配置一个段表寄存器来储存 &quot;段表&quot; 的起始地址和长度;</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-22-49-32.png" alt="2020-07-07-22-49-32"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-22-51-17.png" alt="2020-07-07-22-51-17"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-22-51-49.png" alt="2020-07-07-22-51-49"></p> <h3 id="虚拟内存管理"><a href="#虚拟内存管理" class="header-anchor">#</a> 虚拟内存管理</h3> <p>前面介绍的存储管理方式需要将程序一次性全部地装入内存才可以运行, 并且知道运行结束才释放资源.</p> <p>在程序执行的过程中, 有很多代码是很少用到的 ( 例如, 错误处理代码 ), 或者需要较长时间的 I/O 操作. 如果按照上面的做法把程序装入内存, 会造成空间利用率的降低.</p> <p>为此需要一种能只装入部分程序就可以让程序运行的存储管理技术, 即虚拟内存管理技术;</p> <p><strong>局部性原理</strong>:</p> <ul><li>时间局部性: 刚刚执行过的指令, 或访问过的数据, 在一个较短的时期内还会再次访问;</li> <li>空间局部性: 一段时间内调用的指令, 访问的数据, 都在集中在同一段空间里;</li></ul> <p><strong>虚拟内存的定义和特征</strong>:</p> <ul><li>基于局部性原理, 在程序装入时, 只讲一部分放入内存, 其余部分放在外存 ( <strong>部分装入</strong> )</li> <li>在程序执行时, 如果访问的信息不在内存里, 再去外存中调入需要的部分进入内存 ( <strong>请求调入</strong> )</li> <li>另一方面将内存中暂时不需要的信息拿出来放到外存上, 从而腾出空间存放要调入内存的信息 ( <strong>置换功能</strong> )</li></ul> <p>内存容量在逻辑上被扩充了, 构成了『 <strong>虚拟内存</strong> 』用户在运行程序时, 可以突破物理内存容量的限制;</p> <h4 id="请求分页存储管理方式"><a href="#请求分页存储管理方式" class="header-anchor">#</a> 请求分页存储管理方式</h4> <p>&quot;分页存储管理方式&quot; 需要一次性把程序的所有页面都装入内存, 当程序太大时就无法被装入内存执行了.</p> <p><strong>&quot;请求分页存储管理方式&quot; 等同于 &quot;分页存储管理方式&quot; + &quot;请求调页功能&quot; + &quot;页面置换功能&quot;</strong></p> <ul><li>作业运行前, 只需要将程序的一部分页面装入主存, 就可以运行程序了;</li> <li>在访问过程中, 根据需要从外存调入新的页面装;</li> <li>通过置换功能可以将不用的页面放入外存上;</li></ul> <p><strong>页表结构</strong>:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-23-23-29.png" alt="2020-07-07-23-23-29"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-23-28-36.png" alt="2020-07-07-23-28-36"></p> <p><strong>缺页中断 &amp; 地址变换</strong></p> <p>若系统发现要访问的页面不再内存中, 便会发出一个 &quot;<strong>缺页中断信号</strong>&quot;, 此时用户程序被中断, 控制转入操作系统的缺页中断处理程序上.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-23-29-13.png" alt="2020-07-07-23-29-13"></p> <h4 id="页面置换算法"><a href="#页面置换算法" class="header-anchor">#</a> 页面置换算法</h4> <p>页面置换算法是用来选出内存中不需要的, 要被换出去存入外存的页面的算法.</p> <p><strong>先进先出 FIFO 算法</strong>:</p> <ul><li>最简单的页面置换算法, 总是淘汰掉最先进入内存的页面, 也就是总是淘汰掉在内存中驻留时间最长的页面, 使用队列来实现;</li> <li>但是最早调入的页面往往是最频繁使用的, 所以该算法可能与实际运行规律不符;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-08-45-15.png" alt="2020-07-08-08-45-15"></p> <p><strong>最少使用 LRU 算法</strong>:</p> <ul><li>淘汰最长时间没有被使用的页面, 使用寄存器组和栈来实现, 性能较好;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-08-46-05.png" alt="2020-07-08-08-46-05"></p> <p><strong>时钟置换 CLOCK 算法</strong>:</p> <ul><li>也称为『 最近未使用 NRU 算法 』</li> <li>给每个页面设置一个 &quot;访问位&quot;, 用以标识该页面最近有没有被访问过. 维护了一个内存中所有页面组成的循环链表, 当程序访问了链表中的页面时, 页面的访问位就设置为 1;</li> <li>如果页面不存在于链表中, 就遍历循环链表找到一个空位, 或者找到访问位为 0 的页面淘汰掉, 然后把需要的页面从外存中引入. 如果遇到访问位为 1 的页面, 把 访问位的值设置为 0;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-08-52-15.png" alt="2020-07-08-08-52-15"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-08-51-40.png" alt="2020-07-08-08-51-40"></p> <p><strong>改进型时钟 CLOCK 算法</strong>:</p> <ul><li>考虑了页面载入内存中是否被修改的问题, 增加了 &quot;修改位&quot;. 当访问位同为 0 的时候, 优先淘汰掉没有被修改过的页面;</li> <li>因为修改过的页面还需要写回到外存中. 此算法可以减少 I/O 次数, 但是会增加扫描次数;</li></ul> <h4 id="页面分配策略"><a href="#页面分配策略" class="header-anchor">#</a> 页面分配策略</h4> <p>在请求分页存储管理系统中, 可以采取两种页面分配策略: <strong>固定分配, 可变分配</strong>;</p> <p>在进行页面置换的时候, 可以采取两种策略: <strong>全局置换, 局部置换</strong>;</p> <p>组合起来可以有如下 3 种合适的策略 ( 固定分配全局置换不合理, 所以不存在 ) :</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-08-59-42.png" alt="2020-07-08-08-59-42"></p> <h4 id="页面调入策略"><a href="#页面调入策略" class="header-anchor">#</a> 页面调入策略</h4> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-09-01-38.png" alt="2020-07-08-09-01-38"></p> <h4 id="抖动现象-缺页率"><a href="#抖动现象-缺页率" class="header-anchor">#</a> 抖动现象 &amp; 缺页率</h4> <p><strong>Belady 异常</strong>: 由于 FIFO 算法的置换特征与进程访问内存的动态特征相矛盾, 会导致缺页率可能随着分配的物理块数量的增加而增加.</p> <p><strong>抖动现象</strong>: 刚被淘汰的页面, 过不久就又被程序访问, 并且调入后不久就又被调出, 如此反复;</p> <p><strong>缺页率 &amp; 命中率</strong>:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-09-08-04.png" alt="2020-07-08-09-08-04"></p> <h4 id="请求分段存储管理系统"><a href="#请求分段存储管理系统" class="header-anchor">#</a> 请求分段存储管理系统</h4> <p>整体来讲, 和 &quot;请求分页存储管理系统&quot; 各方面类似.</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-23-37-13.png" alt="2020-07-07-23-37-13"></p> <h3 id="内存管理方式之间的对比"><a href="#内存管理方式之间的对比" class="header-anchor">#</a> 内存管理方式之间的对比</h3> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-23-38-03.png" alt="2020-07-07-23-38-03"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-07-23-38-41.png" alt="2020-07-07-23-38-41"></p> <h2 id="文件管理"><a href="#文件管理" class="header-anchor">#</a> 文件管理</h2> <h3 id="文件系统基础"><a href="#文件系统基础" class="header-anchor">#</a> 文件系统基础</h3> <h4 id="文件的基本概念"><a href="#文件的基本概念" class="header-anchor">#</a> 文件的基本概念</h4> <p><strong>文件的概念</strong>: 文件是具有名称的一组相关元素的集合;</p> <p>文件的组成结构:</p> <ul><li><strong>数据项</strong>: 是文件系统中最低级的数据组织形式, 分为如下两类:
<ul><li>进本数据项: 用于描述一个对象的某种属性的一个值. 例如, 姓名, 年龄, 日期, etc;</li> <li>组合数据项: 由多个基本数据项组成;</li></ul></li> <li><strong>记录</strong>: 一组相关的数据项的集合, 用以描述一个对象在某方面的一组属性;</li> <li><strong>文件</strong>: 一组相关信息的集合, 逻辑上可以分为:
<ul><li>有结构文件: 由一组相似的记录组成;</li> <li>无结构文件: 一组字符流, 又称流式文件. 例如, 二进制流文件</li></ul></li></ul> <p><strong>文件的属性</strong>:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-13-22-16.png" alt="2020-07-08-13-22-16"></p> <p><strong>文件的分类</strong>:</p> <p>按照用途分类:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-13-32-57.png" alt="2020-07-08-13-32-57"></p> <p>按照保护级别分类:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-13-32-47.png" alt="2020-07-08-13-32-47"></p> <p>按照信息流分类:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-13-32-35.png" alt="2020-07-08-13-32-35"></p> <p>按照数据形式分类:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-13-32-19.png" alt="2020-07-08-13-32-19"></p> <p><strong>文件的操作</strong>:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-13-34-14.png" alt="2020-07-08-13-34-14"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-13-34-32.png" alt="2020-07-08-13-34-32"> <img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-08-13-34-46.png" alt="2020-07-08-13-34-46"></p> <h4 id="文件的逻辑结构"><a href="#文件的逻辑结构" class="header-anchor">#</a> 文件的逻辑结构</h4> <p>文件按照逻辑结构来分类, 可以分为:</p> <ul><li>有结构的记录式文件;</li> <li>无结构的流式文件;</li></ul> <p>记录式文件可以分为:</p> <ul><li>顺序文件:</li> <li>索引文件:</li> <li>索引顺序文件:</li></ul> <p>流式</p> <h4 id="目录结构"><a href="#目录结构" class="header-anchor">#</a> 目录结构</h4> <h3 id="文件系统及实现"><a href="#文件系统及实现" class="header-anchor">#</a> 文件系统及实现</h3> <h2 id="i-0-管理"><a href="#i-0-管理" class="header-anchor">#</a> I/0 管理</h2></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">7/8/2020, 8:10:59 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my-notebook/assets/js/app.f62ca298.js" defer></script><script src="/my-notebook/assets/js/2.a47e0c14.js" defer></script><script src="/my-notebook/assets/js/206.644515cf.js" defer></script>
  </body>
</html>
