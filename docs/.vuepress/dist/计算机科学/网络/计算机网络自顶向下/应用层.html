<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>应用层 | Garrik 的笔记</title>
    <meta name="description" content="这里是 Garrik 的前端笔记本">
    
    
    <link rel="preload" href="/my-notebook/assets/css/0.styles.64328b17.css" as="style"><link rel="preload" href="/my-notebook/assets/js/app.7f26aa6e.js" as="script"><link rel="preload" href="/my-notebook/assets/js/2.86213550.js" as="script"><link rel="preload" href="/my-notebook/assets/js/253.30f1dd88.js" as="script"><link rel="prefetch" href="/my-notebook/assets/js/10.df4856a5.js"><link rel="prefetch" href="/my-notebook/assets/js/100.7e1906c6.js"><link rel="prefetch" href="/my-notebook/assets/js/101.bc5505db.js"><link rel="prefetch" href="/my-notebook/assets/js/102.cc1253aa.js"><link rel="prefetch" href="/my-notebook/assets/js/103.3a0520df.js"><link rel="prefetch" href="/my-notebook/assets/js/104.1e088300.js"><link rel="prefetch" href="/my-notebook/assets/js/105.104c3128.js"><link rel="prefetch" href="/my-notebook/assets/js/106.0d31ba0b.js"><link rel="prefetch" href="/my-notebook/assets/js/107.58db8c9b.js"><link rel="prefetch" href="/my-notebook/assets/js/108.edfbbe17.js"><link rel="prefetch" href="/my-notebook/assets/js/109.4c75dd85.js"><link rel="prefetch" href="/my-notebook/assets/js/11.0e5e26e5.js"><link rel="prefetch" href="/my-notebook/assets/js/110.2adbabc6.js"><link rel="prefetch" href="/my-notebook/assets/js/111.1fa23082.js"><link rel="prefetch" href="/my-notebook/assets/js/112.65ab5887.js"><link rel="prefetch" href="/my-notebook/assets/js/113.ae99e6c1.js"><link rel="prefetch" href="/my-notebook/assets/js/114.73e5932f.js"><link rel="prefetch" href="/my-notebook/assets/js/115.c017351c.js"><link rel="prefetch" href="/my-notebook/assets/js/116.f5710556.js"><link rel="prefetch" href="/my-notebook/assets/js/117.8867f4fe.js"><link rel="prefetch" href="/my-notebook/assets/js/118.9f5a86d2.js"><link rel="prefetch" href="/my-notebook/assets/js/119.17ccc38b.js"><link rel="prefetch" href="/my-notebook/assets/js/12.3df40df2.js"><link rel="prefetch" href="/my-notebook/assets/js/120.75435583.js"><link rel="prefetch" href="/my-notebook/assets/js/121.99c5fda3.js"><link rel="prefetch" href="/my-notebook/assets/js/122.71802328.js"><link rel="prefetch" href="/my-notebook/assets/js/123.d1c3b463.js"><link rel="prefetch" href="/my-notebook/assets/js/124.903f8d24.js"><link rel="prefetch" href="/my-notebook/assets/js/125.85556abc.js"><link rel="prefetch" href="/my-notebook/assets/js/126.fce78e7f.js"><link rel="prefetch" href="/my-notebook/assets/js/127.3199cbe9.js"><link rel="prefetch" href="/my-notebook/assets/js/128.9cb97a8e.js"><link rel="prefetch" href="/my-notebook/assets/js/129.115cd2da.js"><link rel="prefetch" href="/my-notebook/assets/js/13.251aaeb6.js"><link rel="prefetch" href="/my-notebook/assets/js/130.dedaa428.js"><link rel="prefetch" href="/my-notebook/assets/js/131.9ab23ba4.js"><link rel="prefetch" href="/my-notebook/assets/js/132.15a5e931.js"><link rel="prefetch" href="/my-notebook/assets/js/133.075fb266.js"><link rel="prefetch" href="/my-notebook/assets/js/134.885bb9d5.js"><link rel="prefetch" href="/my-notebook/assets/js/135.fd8c8ee6.js"><link rel="prefetch" href="/my-notebook/assets/js/136.ebfdcb4b.js"><link rel="prefetch" href="/my-notebook/assets/js/137.01c4045a.js"><link rel="prefetch" href="/my-notebook/assets/js/138.acd5bc92.js"><link rel="prefetch" href="/my-notebook/assets/js/139.7207c024.js"><link rel="prefetch" href="/my-notebook/assets/js/14.399b1b5c.js"><link rel="prefetch" href="/my-notebook/assets/js/140.f7e7679a.js"><link rel="prefetch" href="/my-notebook/assets/js/141.f4a5ea7f.js"><link rel="prefetch" href="/my-notebook/assets/js/142.e172141c.js"><link rel="prefetch" href="/my-notebook/assets/js/143.54580a22.js"><link rel="prefetch" href="/my-notebook/assets/js/144.654d4d9b.js"><link rel="prefetch" href="/my-notebook/assets/js/145.28d06ba7.js"><link rel="prefetch" href="/my-notebook/assets/js/146.15e89968.js"><link rel="prefetch" href="/my-notebook/assets/js/147.7c135d35.js"><link rel="prefetch" href="/my-notebook/assets/js/148.c180a541.js"><link rel="prefetch" href="/my-notebook/assets/js/149.ed6a3916.js"><link rel="prefetch" href="/my-notebook/assets/js/15.f080837b.js"><link rel="prefetch" href="/my-notebook/assets/js/150.4a9fabf0.js"><link rel="prefetch" href="/my-notebook/assets/js/151.d28091a5.js"><link rel="prefetch" href="/my-notebook/assets/js/152.ebe9ae9f.js"><link rel="prefetch" href="/my-notebook/assets/js/153.e8e716c6.js"><link rel="prefetch" href="/my-notebook/assets/js/154.c632e9a7.js"><link rel="prefetch" href="/my-notebook/assets/js/155.9e1d450b.js"><link rel="prefetch" href="/my-notebook/assets/js/156.cf2fe75c.js"><link rel="prefetch" href="/my-notebook/assets/js/157.d8b3790c.js"><link rel="prefetch" href="/my-notebook/assets/js/158.ec3d51b2.js"><link rel="prefetch" href="/my-notebook/assets/js/159.2bbbf599.js"><link rel="prefetch" href="/my-notebook/assets/js/16.a0b73a29.js"><link rel="prefetch" href="/my-notebook/assets/js/160.092110db.js"><link rel="prefetch" href="/my-notebook/assets/js/161.06b9137a.js"><link rel="prefetch" href="/my-notebook/assets/js/162.1ec83cf6.js"><link rel="prefetch" href="/my-notebook/assets/js/163.dbbc5871.js"><link rel="prefetch" href="/my-notebook/assets/js/164.79efacb3.js"><link rel="prefetch" href="/my-notebook/assets/js/165.314727d3.js"><link rel="prefetch" href="/my-notebook/assets/js/166.4534521f.js"><link rel="prefetch" href="/my-notebook/assets/js/167.4ae62ae8.js"><link rel="prefetch" href="/my-notebook/assets/js/168.4bbd7caf.js"><link rel="prefetch" href="/my-notebook/assets/js/169.f3e00020.js"><link rel="prefetch" href="/my-notebook/assets/js/17.69be7c6d.js"><link rel="prefetch" href="/my-notebook/assets/js/170.168ce036.js"><link rel="prefetch" href="/my-notebook/assets/js/171.cd3242f5.js"><link rel="prefetch" href="/my-notebook/assets/js/172.f2990025.js"><link rel="prefetch" href="/my-notebook/assets/js/173.e229b87c.js"><link rel="prefetch" href="/my-notebook/assets/js/174.eb3f5547.js"><link rel="prefetch" href="/my-notebook/assets/js/175.f0184520.js"><link rel="prefetch" href="/my-notebook/assets/js/176.d0ccb9cd.js"><link rel="prefetch" href="/my-notebook/assets/js/177.0bf31cc8.js"><link rel="prefetch" href="/my-notebook/assets/js/178.0306744f.js"><link rel="prefetch" href="/my-notebook/assets/js/179.592d5b5b.js"><link rel="prefetch" href="/my-notebook/assets/js/18.7fdd2f7b.js"><link rel="prefetch" href="/my-notebook/assets/js/180.72279cd0.js"><link rel="prefetch" href="/my-notebook/assets/js/181.875c893a.js"><link rel="prefetch" href="/my-notebook/assets/js/182.0ead1ff5.js"><link rel="prefetch" href="/my-notebook/assets/js/183.4635938d.js"><link rel="prefetch" href="/my-notebook/assets/js/184.0f220ac2.js"><link rel="prefetch" href="/my-notebook/assets/js/185.40fe7e2a.js"><link rel="prefetch" href="/my-notebook/assets/js/186.2d28d6e0.js"><link rel="prefetch" href="/my-notebook/assets/js/187.819987c4.js"><link rel="prefetch" href="/my-notebook/assets/js/188.6ff89e65.js"><link rel="prefetch" href="/my-notebook/assets/js/189.48c27b94.js"><link rel="prefetch" href="/my-notebook/assets/js/19.143c985a.js"><link rel="prefetch" href="/my-notebook/assets/js/190.eef35f40.js"><link rel="prefetch" href="/my-notebook/assets/js/191.d2c7b19a.js"><link rel="prefetch" href="/my-notebook/assets/js/192.16598296.js"><link rel="prefetch" href="/my-notebook/assets/js/193.b3443de2.js"><link rel="prefetch" href="/my-notebook/assets/js/194.4fa032cc.js"><link rel="prefetch" href="/my-notebook/assets/js/195.0f9b9af1.js"><link rel="prefetch" href="/my-notebook/assets/js/196.9dac2d14.js"><link rel="prefetch" href="/my-notebook/assets/js/197.fa052acc.js"><link rel="prefetch" href="/my-notebook/assets/js/198.4335052c.js"><link rel="prefetch" href="/my-notebook/assets/js/199.200ede16.js"><link rel="prefetch" href="/my-notebook/assets/js/20.b612a13c.js"><link rel="prefetch" href="/my-notebook/assets/js/200.fcbb8335.js"><link rel="prefetch" href="/my-notebook/assets/js/201.7664747e.js"><link rel="prefetch" href="/my-notebook/assets/js/202.0936a6cd.js"><link rel="prefetch" href="/my-notebook/assets/js/203.daa474d6.js"><link rel="prefetch" href="/my-notebook/assets/js/204.13989955.js"><link rel="prefetch" href="/my-notebook/assets/js/205.08ea6933.js"><link rel="prefetch" href="/my-notebook/assets/js/206.8bacb8f9.js"><link rel="prefetch" href="/my-notebook/assets/js/207.3ebfced9.js"><link rel="prefetch" href="/my-notebook/assets/js/208.dea47bc0.js"><link rel="prefetch" href="/my-notebook/assets/js/209.9a750a5e.js"><link rel="prefetch" href="/my-notebook/assets/js/21.93e71dc9.js"><link rel="prefetch" href="/my-notebook/assets/js/210.c11a3d1c.js"><link rel="prefetch" href="/my-notebook/assets/js/211.5ef45d05.js"><link rel="prefetch" href="/my-notebook/assets/js/212.545887ea.js"><link rel="prefetch" href="/my-notebook/assets/js/213.0ca39fdf.js"><link rel="prefetch" href="/my-notebook/assets/js/214.eedac85a.js"><link rel="prefetch" href="/my-notebook/assets/js/215.51495814.js"><link rel="prefetch" href="/my-notebook/assets/js/216.bdf36690.js"><link rel="prefetch" href="/my-notebook/assets/js/217.b855e7ce.js"><link rel="prefetch" href="/my-notebook/assets/js/218.8aa4405b.js"><link rel="prefetch" href="/my-notebook/assets/js/219.3eacb724.js"><link rel="prefetch" href="/my-notebook/assets/js/22.18bacb7f.js"><link rel="prefetch" href="/my-notebook/assets/js/220.6c3d5ea4.js"><link rel="prefetch" href="/my-notebook/assets/js/221.6ed68fd0.js"><link rel="prefetch" href="/my-notebook/assets/js/222.f8209cd0.js"><link rel="prefetch" href="/my-notebook/assets/js/223.18ce0d2f.js"><link rel="prefetch" href="/my-notebook/assets/js/224.9825fe7b.js"><link rel="prefetch" href="/my-notebook/assets/js/225.6f3ea3d4.js"><link rel="prefetch" href="/my-notebook/assets/js/226.747bcd4c.js"><link rel="prefetch" href="/my-notebook/assets/js/227.e9a5c0b2.js"><link rel="prefetch" href="/my-notebook/assets/js/228.d59a5c1d.js"><link rel="prefetch" href="/my-notebook/assets/js/229.e5c8c0e2.js"><link rel="prefetch" href="/my-notebook/assets/js/23.44259601.js"><link rel="prefetch" href="/my-notebook/assets/js/230.3938e9d7.js"><link rel="prefetch" href="/my-notebook/assets/js/231.0b5f408b.js"><link rel="prefetch" href="/my-notebook/assets/js/232.65ddadac.js"><link rel="prefetch" href="/my-notebook/assets/js/233.494bbfe6.js"><link rel="prefetch" href="/my-notebook/assets/js/234.14316bca.js"><link rel="prefetch" href="/my-notebook/assets/js/235.0891ee70.js"><link rel="prefetch" href="/my-notebook/assets/js/236.50654cce.js"><link rel="prefetch" href="/my-notebook/assets/js/237.5fa22eba.js"><link rel="prefetch" href="/my-notebook/assets/js/238.c3a00ea1.js"><link rel="prefetch" href="/my-notebook/assets/js/239.2c3102af.js"><link rel="prefetch" href="/my-notebook/assets/js/24.2be5c0c5.js"><link rel="prefetch" href="/my-notebook/assets/js/240.66aed83e.js"><link rel="prefetch" href="/my-notebook/assets/js/241.c8cab28b.js"><link rel="prefetch" href="/my-notebook/assets/js/242.12d61add.js"><link rel="prefetch" href="/my-notebook/assets/js/243.5f95be96.js"><link rel="prefetch" href="/my-notebook/assets/js/244.1d3f31c2.js"><link rel="prefetch" href="/my-notebook/assets/js/245.1c6790f0.js"><link rel="prefetch" href="/my-notebook/assets/js/246.3a7d93bd.js"><link rel="prefetch" href="/my-notebook/assets/js/247.bf0f8a28.js"><link rel="prefetch" href="/my-notebook/assets/js/248.23fb8208.js"><link rel="prefetch" href="/my-notebook/assets/js/249.59e3d733.js"><link rel="prefetch" href="/my-notebook/assets/js/25.e449644a.js"><link rel="prefetch" href="/my-notebook/assets/js/250.67f08a5c.js"><link rel="prefetch" href="/my-notebook/assets/js/251.b8d14692.js"><link rel="prefetch" href="/my-notebook/assets/js/252.aadf6170.js"><link rel="prefetch" href="/my-notebook/assets/js/254.ce1629f6.js"><link rel="prefetch" href="/my-notebook/assets/js/255.31be4cbf.js"><link rel="prefetch" href="/my-notebook/assets/js/256.59900637.js"><link rel="prefetch" href="/my-notebook/assets/js/257.26f22e10.js"><link rel="prefetch" href="/my-notebook/assets/js/258.bf144e87.js"><link rel="prefetch" href="/my-notebook/assets/js/259.247dcb47.js"><link rel="prefetch" href="/my-notebook/assets/js/26.744497b1.js"><link rel="prefetch" href="/my-notebook/assets/js/260.82c916e6.js"><link rel="prefetch" href="/my-notebook/assets/js/261.d0eaeb0c.js"><link rel="prefetch" href="/my-notebook/assets/js/262.6edc2bbc.js"><link rel="prefetch" href="/my-notebook/assets/js/263.0c206edd.js"><link rel="prefetch" href="/my-notebook/assets/js/264.ef10c942.js"><link rel="prefetch" href="/my-notebook/assets/js/265.30593aea.js"><link rel="prefetch" href="/my-notebook/assets/js/266.431ad91b.js"><link rel="prefetch" href="/my-notebook/assets/js/267.cce5023b.js"><link rel="prefetch" href="/my-notebook/assets/js/268.91112b5f.js"><link rel="prefetch" href="/my-notebook/assets/js/269.28d10833.js"><link rel="prefetch" href="/my-notebook/assets/js/27.54073d49.js"><link rel="prefetch" href="/my-notebook/assets/js/270.6224ce90.js"><link rel="prefetch" href="/my-notebook/assets/js/271.079bba2b.js"><link rel="prefetch" href="/my-notebook/assets/js/272.357c5d0b.js"><link rel="prefetch" href="/my-notebook/assets/js/273.24d789fe.js"><link rel="prefetch" href="/my-notebook/assets/js/28.dd98fea3.js"><link rel="prefetch" href="/my-notebook/assets/js/29.cb5b6492.js"><link rel="prefetch" href="/my-notebook/assets/js/3.b7f0189a.js"><link rel="prefetch" href="/my-notebook/assets/js/30.7b08b66a.js"><link rel="prefetch" href="/my-notebook/assets/js/31.47dafcd7.js"><link rel="prefetch" href="/my-notebook/assets/js/32.8af803fa.js"><link rel="prefetch" href="/my-notebook/assets/js/33.964a4d8b.js"><link rel="prefetch" href="/my-notebook/assets/js/34.f55769fd.js"><link rel="prefetch" href="/my-notebook/assets/js/35.28df7202.js"><link rel="prefetch" href="/my-notebook/assets/js/36.88757be8.js"><link rel="prefetch" href="/my-notebook/assets/js/37.63e53797.js"><link rel="prefetch" href="/my-notebook/assets/js/38.b48aa0ec.js"><link rel="prefetch" href="/my-notebook/assets/js/39.7c770186.js"><link rel="prefetch" href="/my-notebook/assets/js/4.4969c76a.js"><link rel="prefetch" href="/my-notebook/assets/js/40.f72c291c.js"><link rel="prefetch" href="/my-notebook/assets/js/41.d199e776.js"><link rel="prefetch" href="/my-notebook/assets/js/42.58cad14e.js"><link rel="prefetch" href="/my-notebook/assets/js/43.aa1d6921.js"><link rel="prefetch" href="/my-notebook/assets/js/44.39ae7302.js"><link rel="prefetch" href="/my-notebook/assets/js/45.65b986bf.js"><link rel="prefetch" href="/my-notebook/assets/js/46.d871d141.js"><link rel="prefetch" href="/my-notebook/assets/js/47.c231ee60.js"><link rel="prefetch" href="/my-notebook/assets/js/48.f7500c2e.js"><link rel="prefetch" href="/my-notebook/assets/js/49.f26a97d8.js"><link rel="prefetch" href="/my-notebook/assets/js/5.bc8714e6.js"><link rel="prefetch" href="/my-notebook/assets/js/50.270ca7ef.js"><link rel="prefetch" href="/my-notebook/assets/js/51.ff0c8753.js"><link rel="prefetch" href="/my-notebook/assets/js/52.8479bb15.js"><link rel="prefetch" href="/my-notebook/assets/js/53.00e2aab7.js"><link rel="prefetch" href="/my-notebook/assets/js/54.05a2c4e2.js"><link rel="prefetch" href="/my-notebook/assets/js/55.c6181d0c.js"><link rel="prefetch" href="/my-notebook/assets/js/56.60f96851.js"><link rel="prefetch" href="/my-notebook/assets/js/57.1a3b8be3.js"><link rel="prefetch" href="/my-notebook/assets/js/58.9ded4010.js"><link rel="prefetch" href="/my-notebook/assets/js/59.492ffe13.js"><link rel="prefetch" href="/my-notebook/assets/js/6.81d4bdf1.js"><link rel="prefetch" href="/my-notebook/assets/js/60.d35bde25.js"><link rel="prefetch" href="/my-notebook/assets/js/61.2dbe74ef.js"><link rel="prefetch" href="/my-notebook/assets/js/62.e160c68d.js"><link rel="prefetch" href="/my-notebook/assets/js/63.478ec9e0.js"><link rel="prefetch" href="/my-notebook/assets/js/64.e4b1a72b.js"><link rel="prefetch" href="/my-notebook/assets/js/65.b02d472d.js"><link rel="prefetch" href="/my-notebook/assets/js/66.d151151e.js"><link rel="prefetch" href="/my-notebook/assets/js/67.e87a888c.js"><link rel="prefetch" href="/my-notebook/assets/js/68.d653dd54.js"><link rel="prefetch" href="/my-notebook/assets/js/69.81e97d9d.js"><link rel="prefetch" href="/my-notebook/assets/js/7.d6ae00cd.js"><link rel="prefetch" href="/my-notebook/assets/js/70.e8a39caf.js"><link rel="prefetch" href="/my-notebook/assets/js/71.1db70f58.js"><link rel="prefetch" href="/my-notebook/assets/js/72.d9277d17.js"><link rel="prefetch" href="/my-notebook/assets/js/73.208925c7.js"><link rel="prefetch" href="/my-notebook/assets/js/74.4eb82c8c.js"><link rel="prefetch" href="/my-notebook/assets/js/75.ea7361e7.js"><link rel="prefetch" href="/my-notebook/assets/js/76.16ab58a7.js"><link rel="prefetch" href="/my-notebook/assets/js/77.0ea64496.js"><link rel="prefetch" href="/my-notebook/assets/js/78.92401eed.js"><link rel="prefetch" href="/my-notebook/assets/js/79.d54da862.js"><link rel="prefetch" href="/my-notebook/assets/js/8.f246902d.js"><link rel="prefetch" href="/my-notebook/assets/js/80.9c71d74f.js"><link rel="prefetch" href="/my-notebook/assets/js/81.966e68b5.js"><link rel="prefetch" href="/my-notebook/assets/js/82.93bb3599.js"><link rel="prefetch" href="/my-notebook/assets/js/83.9bec1369.js"><link rel="prefetch" href="/my-notebook/assets/js/84.c36482b7.js"><link rel="prefetch" href="/my-notebook/assets/js/85.87b742b9.js"><link rel="prefetch" href="/my-notebook/assets/js/86.588ec8e0.js"><link rel="prefetch" href="/my-notebook/assets/js/87.45b49c3f.js"><link rel="prefetch" href="/my-notebook/assets/js/88.7222fe38.js"><link rel="prefetch" href="/my-notebook/assets/js/89.1c39b0cf.js"><link rel="prefetch" href="/my-notebook/assets/js/9.f46cb34b.js"><link rel="prefetch" href="/my-notebook/assets/js/90.89912eb7.js"><link rel="prefetch" href="/my-notebook/assets/js/91.df0373ee.js"><link rel="prefetch" href="/my-notebook/assets/js/92.86b972d6.js"><link rel="prefetch" href="/my-notebook/assets/js/93.bfe7ae60.js"><link rel="prefetch" href="/my-notebook/assets/js/94.c375dbd7.js"><link rel="prefetch" href="/my-notebook/assets/js/95.79165826.js"><link rel="prefetch" href="/my-notebook/assets/js/96.3dbad1a6.js"><link rel="prefetch" href="/my-notebook/assets/js/97.3095ad22.js"><link rel="prefetch" href="/my-notebook/assets/js/98.c69b4f33.js"><link rel="prefetch" href="/my-notebook/assets/js/99.79a5656c.js">
    <link rel="stylesheet" href="/my-notebook/assets/css/0.styles.64328b17.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-notebook/" class="home-link router-link-active"><!----> <span class="site-name">Garrik 的笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-notebook/" class="nav-link">主页</a></div><div class="nav-item"><a href="https://github.com/Garrik-Liu/my-notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-notebook/" class="nav-link">主页</a></div><div class="nav-item"><a href="https://github.com/Garrik-Liu/my-notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>应用层</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#应用层协议原理" class="sidebar-link">应用层协议原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#网络应用程序体系结构" class="sidebar-link">网络应用程序体系结构</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#进程通信" class="sidebar-link">进程通信</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#可供应用程序使用的运输服务" class="sidebar-link">可供应用程序使用的运输服务</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#因特网提供的运输服务" class="sidebar-link">因特网提供的运输服务</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#http" class="sidebar-link">HTTP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#http-概述" class="sidebar-link">HTTP 概述</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#非持续连接-持续连接" class="sidebar-link">非持续连接 &amp; 持续连接</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#http-报文格式" class="sidebar-link">HTTP 报文格式</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#cookie" class="sidebar-link">Cookie</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#web-缓存" class="sidebar-link">Web 缓存</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#dns" class="sidebar-link">DNS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#dns-服务概述" class="sidebar-link">DNS 服务概述</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#dns-工作机理" class="sidebar-link">DNS 工作机理</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#dns-记录和报文" class="sidebar-link">DNS 记录和报文</a></li></ul></li><li><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#p2p" class="sidebar-link">P2P</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/%E5%BA%94%E7%94%A8%E5%B1%82.html#p2p-文件分发" class="sidebar-link">P2P 文件分发</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="应用层"><a href="#应用层" class="header-anchor">#</a> 应用层</h1> <p>网络应用可以说是计算机网络存在的意义, 没有应用, 网络也就没什么用了;</p> <p>这一节, 学习有关网络应用通信的原理和实现;</p> <h2 id="应用层协议原理"><a href="#应用层协议原理" class="header-anchor">#</a> 应用层协议原理</h2> <h3 id="网络应用程序体系结构"><a href="#网络应用程序体系结构" class="header-anchor">#</a> 网络应用程序体系结构</h3> <p>应用程序体系结构, 规定了如何在各种端系统上组织应用程序.</p> <p>开发者通常, 会采用两种主流的体系结构:</p> <ul><li><strong>客户 - 服务器体系结构</strong> client-server architecture;</li> <li><strong>P2P 体系结构</strong> P2P architecture:</li></ul> <h4 id="客户-服务器体系结构"><a href="#客户-服务器体系结构" class="header-anchor">#</a> 客户 - 服务器体系结构</h4> <p>有一个打开的主机称为『 <strong>服务器</strong> 』, 它服务来自于许多称为『 <strong>客户</strong> 』的主机的请求.</p> <ul><li>请求会在服务器端进行处理, 然后服务器返回一个对应的响应给客户端;</li> <li>客户 - 服务器体系结构中, <strong>各个客户端之间不直接通信</strong>;</li></ul> <p><strong>缺点</strong>: 随着客户请求的增大, 服务提供商必须不断地升级服务处理能力, 并且负担增加的流量和带宽的费用. <strong>成本较大</strong>;</p> <h4 id="p2p-体系结构"><a href="#p2p-体系结构" class="header-anchor">#</a> P2P 体系结构</h4> <p>应用程序在主机之间直接通信, 这些主机称为『 <strong>对等方</strong> 』, 通信不依赖专有的服务器;</p> <ul><li>🌰 很多『 <strong>流量密集型应用</strong> 』都是 P2P 结构, 文件共享程序 (例如, BitTorrent), 对等方协助下载加速器 (例如, 迅雷), IPTV (例如, 迅雷看看)</li> <li>P2P 体系结构具有『 <strong>自扩展性</strong> self-scalability 』, 随着用户的增多, 有更多的对等方互相之间分发文件, 整个系统的服务能力自发提升, 同时不需要服务器能力和带宽;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-27-08-49-32.png" alt="2020-05-27-08-49-32"></p> <h3 id="进程通信"><a href="#进程通信" class="header-anchor">#</a> 进程通信</h3> <p>程序员编写的应用程序, 最终会在操作系统中, 被创建为『 <strong>进程</strong> process 』进行通信:</p> <ul><li>在一台主机上, 进程间使用操作系统提供的『 <strong>进程间通信机制</strong> 』进行通信;</li> <li>而在不同端系统上, 进程通过计算机网络交换『 <strong>报文</strong> message 』进行通信;</li></ul> <h4 id="客户-服务器进程"><a href="#客户-服务器进程" class="header-anchor">#</a> 客户 &amp; 服务器进程</h4> <blockquote><p>⚠️ 注意, 这里的『 客户 』和『 服务器 』形容的是『 进程 』
与『 客户 - 服务器体系结构 』所指的不是一回事.</p></blockquote> <p>网络应用程序由成对的进程进行通信. 将发起通信的进程标识为『 <strong>客户</strong> 』, 将等待通信的进程称为『 <strong>服务器</strong> 』</p> <ul><li>🌰 在 Web 应用中, 由一个客户浏览器进程与一台 Web 服务器进程交换报文;</li> <li>🌰 在 P2P 文件共享系统中, 下载文件的对等方是客户, 上传文件的对等方是服务器;</li></ul> <h4 id="进程与计算机网络之间的接口"><a href="#进程与计算机网络之间的接口" class="header-anchor">#</a> 进程与计算机网络之间的接口</h4> <p>进程通过『 <strong>套接字</strong> socket 』接口来向网络发送 / 接收报文:</p> <ul><li>套接字, 是主机内 &quot;应用层&quot; 与 &quot;运输层&quot; 之间的通信接口, 也就是运输层提供给应用层的 API;</li> <li>通过套接字, 开发者可以控制应用层想要使用的运输层协议, 相关参数, 以及想要传送给运输层的相关数据;</li> <li>套接字使用了运输层什么协议, 我们就说 &quot;应用程序建立在由该协议提供的运输层服务之上&quot;;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-27-09-16-44.png" alt="2020-05-27-09-16-44"></p> <h4 id="进程寻址"><a href="#进程寻址" class="header-anchor">#</a> 进程寻址</h4> <p>为了正确的向另外一个主机上进程发送分组, 接收进程需要有一个<strong>地址</strong>, 该地址定义了两种信息:</p> <ul><li>主机的地址: 由『 <strong>IP 地址</strong> 』标识;</li> <li>主机中的接收进程: 由主机上的『 <strong>端口号</strong> 』来标识;</li></ul> <h3 id="可供应用程序使用的运输服务"><a href="#可供应用程序使用的运输服务" class="header-anchor">#</a> 可供应用程序使用的运输服务</h3> <p>存在着不止一种的运输层协议, 在开发应用程序时, 我们需要根据自己的需求选择合适的运输层协议;</p> <p>应用程序对运输层协议的需求, 大致可以分为如下四个方面:</p> <p><strong>可靠的数据运输</strong>:</p> <ul><li>分组在网络中传输时可能会造成丢包;</li> <li>如果一个运输层协议能够确保从一端应用程序发来的数据能够准确无误的发送到另外一端的应用程序上, 那么就称此协议提供了『 <strong>可靠数据传输</strong> reliable data transfer 』</li> <li>应用程序可以放心把数据发送给提供可靠数据传输的运输层, 完全相信数据可以准确无误地传递到目的地;</li> <li>对于『 <strong>容忍丢失的应用</strong> loss-tolerant application 』不提供可靠数据传输的运输层协议是可以接收的;
<ul><li>🌰 例如, 音视频应用可以容许稍微的丢包;</li></ul></li></ul> <p><strong>吞吐量</strong>:</p> <ul><li>可用吞吐量就是发送进程能够向接收进程交付数据的速率;</li> <li>具有吞吐量要求的应用程序被称为『 <strong>带宽敏感的应用</strong> bandwidth sensitive application 』</li> <li>对于这种应用, 有的运输层协议提供确保传输速率的服务;</li> <li>对于没有特定的吞吐量需求的应用, 称为『 <strong>弹性应用</strong> elastic application 』</li> <li>但无论如何, 吞吐量越大越好是无疑的;</li></ul> <p><strong>定时</strong>:</p> <ul><li>对于实时交互式应用程序, 它们对于数据交付的时间有严格的要求;</li> <li>有的运输层协议可以提供『 定时保障 』, 保证数据能够以限定的时间内传输到目的地;</li> <li>🌰 对于数据传输时间有严格要求的应用有: 网络游戏, 音视频直播;</li></ul> <p><strong>安全性</strong>:</p> <ul><li>有的运输层协议可以为应用程序提供各种各样的安全性服务;</li> <li>🌰 例如, 提供加密服务的运输层协议, 可以加密由发送进程传输的所有数据, 并且在接收端的运输层里将数据解密, 然后交付给接收进程;</li></ul> <h3 id="因特网提供的运输服务"><a href="#因特网提供的运输服务" class="header-anchor">#</a> 因特网提供的运输服务</h3> <p>开发者需要根据应用的需求, 选择合适的运输层协议. 下图 👇 展示了不同应用的网络需求:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-27-12-39-08.png" alt="2020-05-27-12-39-08"></p> <p>因特网为应用程序提供两个运输层协议:</p> <ul><li>UDP</li> <li>TCP</li></ul> <p><strong>TCP 服务</strong>:</p> <ul><li><strong>面向连接服务</strong>:
<ul><li>在应用层数据报文开始传送之前，TCP 让客户和服务器互相交换运输层控制信息，这被称为『 <strong>握手</strong> 』</li> <li>在握手阶段后，一个『 <strong>TCP 连接</strong> 』就在两个进程的套接字之间建立了;</li> <li>这条链接是『 <strong>全双工</strong> 』的, 即连接双方的进程都可以在此连接之上互相收发报文;</li> <li>当应用程序结束报文传输之后，必须断开该连接;</li></ul></li> <li><strong>可靠度数据传送服务</strong>:
<ul><li>通信进程能够依靠 TCP 无差错，按适当顺序交付所有发送的数据;</li></ul></li></ul> <p><strong>UDP 服务</strong>:</p> <ul><li>UDP 协议提供一种『 <strong>不可靠数据传送服务</strong> 』</li> <li>UDP 是『 <strong>无连接</strong> 』的，因此两个进程通信前没有握手过程;</li> <li>当进程将一个报文发送给 UDP 套接字时, UDP 协议并不保证将这报文能传送到接收进程。</li></ul> <h2 id="http"><a href="#http" class="header-anchor">#</a> HTTP</h2> <h3 id="http-概述"><a href="#http-概述" class="header-anchor">#</a> HTTP 概述</h3> <p>20 世纪 90 年代, <strong>万维网</strong> (World Wide Web, WWW) 作为一个因特网应用程序被开发出来;</p> <ul><li>WWW 中把各种信息按照页面的形式组合;
<ul><li>只包含有文本, 链接的页面称为『 <strong>超文本</strong> 』页面上的链接称为『 <strong>超链接</strong> 』</li> <li>还包含有视频, 音频, 图像等信息的页面称为『 <strong>超媒体</strong> 』</li></ul></li> <li>各种资源之间通过 &quot;超链接&quot; 互相引用;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-14-00-33-04.png" alt="2020-07-14-00-33-04"></p> <p>WWW 中使用『 <strong>统一资源定位符 URL</strong> 』来标识 WWW 中的各种资源.</p> <ul><li>格式为: <strong>&lt;协议&gt;://&lt;主机名&gt;:&lt;端口号&gt;/&lt;路径&gt;</strong></li></ul> <p>WWW 的应用层协议是『 <strong>超文本传输协议</strong> HyperText Transfer Protocol, HTTP 』</p> <p>HTTP 由两个程序实现, 一个客户程序, 一个服务器程序, 它们分别运行在不同的端系统中. 通过交换 HTTP 报文进行会话;</p> <ul><li>客户程序通常指『 Web 浏览器 』;</li> <li>服务器程序通常指『 Web 服务器 』;</li></ul> <p>HTTP 使用 <strong>TCP</strong> 作为它的支撑运输协议:</p> <ul><li>HTTP 客户端，首先发起一个与服务器的 TCP 连接，一旦建立连接，该浏览器与服务器进程就可以通过套接字接口访问 TCP;</li> <li>因为 TCP 连接提供可靠的数据传输服务，所以一个客户进程发出的每个 HTTP 请求，最终报文都能完整的送达服务器。同理, 服务器的响应也能够完整地到达客户端;</li></ul> <p>HTTP 是一个『 <strong>无状态协议</strong> 』，HTTP 服务器并不保存关于客户的任何信息;</p> <h3 id="非持续连接-持续连接"><a href="#非持续连接-持续连接" class="header-anchor">#</a> 非持续连接 &amp; 持续连接</h3> <p>在客户端与服务器建立 TCP 连接时, 有如下两种方式:</p> <ul><li><strong>非持续连接</strong> non-persistent connection:
<ul><li>每个 TCP 连接只传输一个请求报文和一个响应报文;</li> <li>在客户端接收到服务端响应后, TCP 连接就会断开;</li> <li>等下次客户端想要给服务器发请求时, 再重新建立 TCP 连接;</li></ul></li> <li><strong>持续连接</strong> persistent connection:
<ul><li>TCP 连接可以保持, 持续的发送请求和响应;</li> <li>通常会对连接设置一个闲置时间, 如果 TCP 连接空闲超过这个时间, 连接就会断开;</li> <li><strong>HTTP 协议默认使用持续连接</strong>;</li></ul></li></ul> <h3 id="http-报文格式"><a href="#http-报文格式" class="header-anchor">#</a> HTTP 报文格式</h3> <p>HTTP 报文有两种:</p> <ul><li>请求报文;</li> <li>响应报文;</li></ul> <h4 id="请求报文"><a href="#请求报文" class="header-anchor">#</a> 请求报文</h4> <p>下图 👇 是请求报文的组成结构:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-27-18-40-20.png" alt="2020-05-27-18-40-20"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-27-20-42-32.png" alt="2020-05-27-20-42-32"></p> <h4 id="响应报文"><a href="#响应报文" class="header-anchor">#</a> 响应报文</h4> <p>下图 👇 是响应报文的组成结构:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-27-20-43-55.png" alt="2020-05-27-20-43-55"></p> <p>响应报文中会根据请求的结果, 给出一个对应的状态码. 例如:</p> <ul><li>200: 请求成功;</li> <li>301: 请求的对象被永久转移了;</li> <li>400: 请求不被服务器理解;</li> <li>404: 被请求的资源不在服务器上;</li></ul> <h3 id="cookie"><a href="#cookie" class="header-anchor">#</a> Cookie</h3> <ul><li>因为 HTTP 协议是无状态的, 服务器默认不知道请求的客户端是谁;</li> <li>但是很多功能的实现需要依靠对于用户的识别, Cookie 技术可以帮应用实现这个功能;</li></ul> <p>下图 👇 展示了客户端与服务器之间如何使用 Cookie 实现客户识别:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-27-20-50-24.png" alt="2020-05-27-20-50-24"></p> <ul><li>当客户端第一次访问服务器时, 服务器生成关于客户端的唯一识别码 ID, 并把此 ID 作为索引, 用于在数据库中储存和客户端相关的信息;</li> <li>接下来服务器将一个包含 <code>Set-cookie</code> 的首部字段的 HTTP 响应报文发送给客户端, 首部字段的值包含服务器生成的 ID;</li> <li>当客户端接收到响应后, 浏览器检测到报文中的 <code>Set-cookie</code> 首部字段, 它会在浏览器中管理 Cookie 的文件中添加一行, 该行包含服务器的主机名和 <code>Set-cookie</code> 字段的值;</li> <li>当客户端再去向服务器发送请求时, 浏览器会把自身保存的 Cookie 信息放到 HTTP 请求报文的 <code>cookie</code> 首部行中;</li> <li>服务器接收到请求报文, 解析 <code>cookie</code> 字段的值, 把它放到数据库中去检索出和对应客户端相关的信息;</li></ul> <h3 id="web-缓存"><a href="#web-缓存" class="header-anchor">#</a> Web 缓存</h3> <ul><li>『 <strong>Web 缓存器</strong> Web Cache 』也称『 <strong>代理服务器</strong> Proxy Server 』</li> <li>它位于客户端与初始服务器之间。 通过配置浏览器，使客户端的所有 HTTP 请求首先指向 WEB 缓存器;</li> <li>缓存器会先在自身找是否有客户端想要请求的对象的副本。如果有的话就直接返回给客户端;</li> <li>如果没有的话就去向初始服务器进行请求，并会在接收到响应后，现在缓存器中保存一份副本，然后再返回给客户端;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-27-21-09-30.png" alt="2020-05-27-21-09-30"></p> <hr> <p><strong>WEB 缓存器的好处</strong>:</p> <ul><li>WEB 缓存器通常由 ISP 提供;</li> <li>在因特网上部署 WEB 缓存器只要有如下原因:
<ul><li>当客户端与初始服务器之间的瓶颈宽带低于客户端与 WEB 缓存器之间的瓶颈宽带时，<strong>WEB 缓存器可以大大减少客户请求的响应时间</strong>。( 通常客户与 WEB 缓存器之间有一个高速连接 )</li> <li><strong>WEB 缓存器能够大大减少一个机构的接入链路到因特网的通信量</strong>，通过减少通信量可以减少该机构的带宽需求，并因此来降低费用;</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-27-21-17-42.png" alt="2020-05-27-21-17-42"></p> <hr> <p><strong>内容分发网路</strong>:</p> <ul><li>『 内容分发网络 Content Distribution Network, CDN 』是 WEB 缓存器的一个重要应用;</li> <li>CDN 公司在因特网上安装了许多地理上分散的缓存器, 使得大量流量可以实现本地化;</li> <li>可以提高客户端请求远距离服务器时的响应速度;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-27-21-36-22.png" alt="2020-05-27-21-36-22"></p> <h2 id="dns"><a href="#dns" class="header-anchor">#</a> DNS</h2> <h3 id="dns-服务概述"><a href="#dns-服务概述" class="header-anchor">#</a> DNS 服务概述</h3> <ul><li>为了方便人类记忆, 使用『 <strong>主机名</strong> hostname 』对一台主机进行标识;
<ul><li>🌰 <code>www.baidu.com</code>, <code>www.google.com</code></li> <li>然而主机名并没有提供主机在因特网中的位置信息;</li></ul></li> <li>使用『 <strong>IP 地址</strong> 』对主机的位置进行标识;
<ul><li>🌰 <code>121.7.106.83</code></li> <li>每台主机都有一个唯一的 IP 地址;</li></ul></li> <li>IP 地址具有层次结构, 从左至右地扫描它时, 可以一步步地得到关于主机位置越来越具体的信息;</li></ul> <hr> <ul><li>为了得到主机名和 IP 地址的映射, 需要使用『 <strong>域名系统</strong> Domain Name System, DNS 』, <strong>其将主机名解析为 IP 地址</strong>;</li> <li>DNS 协议是一个应用层协议, 运行在 UDP 连接上, 默认在 DNS 服务器上使用 53 号端口;</li> <li>DNS 协议通常服务于其他应用层协议, 例如 HTTP, SMTP 和 FTP;</li></ul> <hr> <ul><li>🌰 为了使用户的主机能够将一个 HTTP 请求发送到指定的 Web 服务器 <code>www.someserver.com</code>, 该用户主机需要先获得 <code>www.someserver.com</code> 的 IP 地址:
<ul><li>先将主机名 <code>www.someserver.com</code> 发送到同一台主机上运行的 DNS 客户端;</li> <li>DNS 客户端向 DNS 服务器发送一个包含主机名的请求;</li> <li>DNS 服务器返回 IP 地址查询结果给 DNS 客户端;</li> <li>用户主机的 DNS 客户端再把 IP 地址发送给浏览器;</li> <li>之后浏览器向 IP 地址对应的主机的 HTTP 服务器发起一个 TCP 连接;</li></ul></li></ul> <h3 id="dns-工作机理"><a href="#dns-工作机理" class="header-anchor">#</a> DNS 工作机理</h3> <ul><li>可以想象最简单的一种 DNS 实现就是整个因特网上只部署一台 DNS 服务器, 这台服务器负责所有的主机名与 IP 地址的查询. 但是很显然在今日的因特网体量下, 这种实现并不可用:</li></ul> <h4 id="分布式-层次性查询"><a href="#分布式-层次性查询" class="header-anchor">#</a> 分布式, 层次性查询</h4> <ul><li><strong>DNS 采用了分布式的设计方案</strong>. 使用了大量的 DNS 服务器以层次的方式组织, 并且分布在全世界范围;</li> <li>在这种分布模型中, 有三种类型的 DNS 服务器:
<ul><li><strong>根 DNS 服务器</strong>;</li> <li><strong>顶级域 DNS 服务器</strong> Top-Level Domain, TLD;</li> <li><strong>权威 DNS 服务器</strong>;</li></ul></li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-28-13-55-54.png" alt="2020-05-28-13-55-54"></p> <p>🌰 假定一个 DNS 客户想要获取主机名 <code>www.amazon.com</code> 的 IP 地址, 大概流程如下:</p> <ul><li>客户首先与根服务器连接, 查询顶级域名 <code>.com</code> 的 TLD 服务器的 IP 地址;</li> <li>客户再与 TLD 服务器连接, 请求 <code>amazon.com</code> 的权威服务器 IP 地址;</li> <li>最后, 客户再与 <code>amazon.com</code> 的权威服务器连接, 请求主机 <code>www.amazon.com</code> 的 IP 地址;</li></ul> <hr> <ul><li>除了上述的 DNS 服务器, 在层次结构之外, 还有一种『 <strong>本地 DNS 服务器</strong> 』</li> <li>基本上每个 ISP 都会部署一台本地 DNS 服务器;</li> <li>当客户主机发出 DNS 请求时, 会先被发往相连的 ISP 的本地 DNS 服务器, 然后再由它去将请求转发到因特网中的 DNS 层次结构;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-28-14-46-56.png" alt="2020-05-28-14-46-56"></p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-28-14-47-23.png" alt="2020-05-28-14-47-23"></p> <ul><li>上面 👆 两张图分别展示了『 <strong>迭代查询</strong> iterative query 』和『 <strong>递归查询</strong> recursive query 』</li> <li>实践中, 查询通常都是用的第一图 (图 2-21) 所示的查询方法, 请求主机到本地 DNS 服务器是 &quot;递归查询&quot;, 本地 DNS 主机与 DNS 层次结构中的服务器是 &quot;迭代查询&quot;;</li></ul> <h4 id="dns-缓存"><a href="#dns-缓存" class="header-anchor">#</a> DNS 缓存</h4> <ul><li>为了提高查询性能, DNS 服务器中存采用『 <strong>DNS 缓存</strong> 』</li> <li>原理就是当某个 DNS 服务器接收到一个 DNS 查询响应时, 会把结果保存在本地的储存器中;</li> <li>这样当再有相同主机名的查询到达此服务器时, 就可以不用再往下查询, 直接返回之前保存的 IP 地址;</li> <li>DNS 缓存都会有一个过期时间, 当缓存超过了设置的时间就会被删除;</li> <li>通过在本地 DNS 服务上使用 DNS 缓存, 可以大大提高用户主机对于 IP 地址的查询效率;</li></ul> <h3 id="dns-记录和报文"><a href="#dns-记录和报文" class="header-anchor">#</a> DNS 记录和报文</h3> <h4 id="dns-记录"><a href="#dns-记录" class="header-anchor">#</a> DNS 记录</h4> <ul><li>DNS 服务器中储存了『 <strong>资源记录</strong> Resource Record, RR 』</li> <li>RR 提供了主机名到 IP 地址的映射;</li> <li>每个 DNS 回答报文包含了一到多条资源记录;</li> <li>资源记录是一个包含了下列字段的 4 元组:
<ul><li>Name;</li> <li>Value;</li> <li>Type;</li> <li>TTL;</li></ul></li></ul> <hr> <ul><li>TTL 全称 Time To Live, 表示该资源记录在 DNS 服务器的缓存中的过期时间;</li> <li>Name 和 Value 的值取决于 Type 类型:
<ul><li><code>Type = A</code>:
<ul><li>Name 是主机名;</li> <li>Value 是主机名对应的 IP 地址;</li> <li>A 类型的资源记录提供了主机名到 IP 地址的映射;</li> <li>🌰 <code>bar.foo.com, 145.37.32.123, A</code></li></ul></li> <li><code>Type = NS</code>:
<ul><li>Name 是个域, 例如 <code>foo.com</code></li> <li>Value 是知道如何获取该域中的主机 IP 地址的权威 DNS 服务器的主机名;</li> <li>NS 类型的资源记录用与沿着查询链条来路由 DNS 查询;</li> <li>🌰 <code>foo.com, dns.foo.com, NS</code></li></ul></li> <li><code>Type = CNAME</code>:
<ul><li>Name 是一个域名;</li> <li>Value 是别名为 Name 值的 &quot;主机&quot; 的 &quot;规范主机名&quot;;</li> <li>CNAME 类型的资源记录能够向查询的主机提供一个主机名对应的规范主机名;</li> <li>🌰 <code>foo.com, bar.foo.com, CNAME</code></li> <li>CNAME 使得可以在一个主机上支持多个 IP 地址, 以此来实现多个服务共同运行在一个主机上;</li></ul></li> <li><code>Type = MX</code>:
<ul><li>Name 是一个域名;</li> <li>Value 是别名为 Name 值的 &quot;邮件服务器&quot; 的 &quot;规范主机名&quot;;</li> <li>MX 记录允许在一台主机上, 邮件服务器和其他服务器具有相同的别名, 例如 <code>foo.com</code>. 通过 DNS 客户请求记录的不同, DNS 服务器返回不同的规范主机名;</li> <li>🌰 <code>foo.com, mail.bar.foo.com, MX</code></li></ul></li></ul></li> <li>如果一台 DNS 服务器是用于某特定主机名的权威 DNS 服务器，那么该 DNS 服务器会有一条包含该主机名的 &quot;类型 A&quot; 记录;</li> <li>如果服务器不是用于查询某主机名的权威服务器，那么该服务器将包含一个 &quot;类型 NS&quot; 记录，该记录对应于包含主机名的 DNS 服务器的域;</li> <li>同时它还将包括一条类型 A 记录，其提供了在 NS 记录的 Value 字段中的域, 对应的 DNS 服务器的 IP 地址;
<ul><li>🌰 例如:
<ul><li><code>umass.edu, dns.umass.edu, NS</code></li> <li><code>dns.umass.edu, 128.119.40.111, A</code></li></ul></li></ul></li></ul> <h4 id="dns-报文"><a href="#dns-报文" class="header-anchor">#</a> DNS 报文</h4> <ul><li>DNS 只有两种报文类型,『 <strong>查询报文</strong> 』和『 <strong>回答报文</strong> 』</li> <li>两种报文有着相同的格式;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-28-15-08-26.png" alt="2020-05-28-15-08-26"></p> <ul><li><strong>首部区域</strong>:
<ul><li>前 12 个字节是首部区域, 第一个字段是『 <strong>标识符</strong> 』, 是一个 16 比特的数, 用以标识该查询. 这个标识符会被复制到查询的回答报文中, 客户可以用它来匹配发出的请求和响应;</li> <li>后面是若干个『 <strong>标志位</strong> 』:
<ul><li>『 查询/回答 』标志位, 指出报文是查询报文, 还是回答报文;</li> <li>『 权威 』标志位, 指出回答是否从权威 DNS 服务器发出;</li> <li>『 希望递归 』标志位, 表示该 DNS 服务器没有某记录, 希望之星递归查询;</li> <li>『 递归可用 』标志位, 表示该 DNS 服务器支持递归查询;</li></ul></li> <li>再之后是 4 个『 <strong>关于数量的字段</strong> 』, 用以指出首部区域后面四个区域中, 分别包含的信息数量;</li></ul></li> <li><strong>问题区域</strong>:
<ul><li>包含正在进行的查询信息, 内容有:
<ul><li>名字字段: 指出正在被查询的主机名;</li> <li>类型字段: 指出关于该主机名要询问的问题类型;</li></ul></li></ul></li> <li><strong>回答区域</strong>:
<ul><li>包含了对最初请求的名字的资源记录;</li> <li>回答区域中可以包含多条资源记录;</li> <li>因此一个主机名也能有对个 IP 地址;</li></ul></li> <li><strong>权威区域</strong>:
<ul><li>包含了其他权威服务器的记录;</li></ul></li> <li><strong>附加信息区域</strong>:
<ul><li>包含了其他有帮助的记录;</li> <li>🌰 例如:
<ul><li>对于一个 MX 请求的回答报文中的回答区域里包含一个资源记录, 该记录提供了邮件服务器的规范主机名;</li> <li>该附加区域包含一个类型 A 的记录, 其提供了用于该邮件服务器的规范主机名的 IP 地址;</li></ul></li></ul></li></ul> <hr> <p>下图 👇 展示了使用 <code>nslookup</code> 程序向 IP 地址为 <code>8.8.8.8</code> 的 DNS 服务器查询 <code>www.baidu.com</code> 主机名的结果:</p> <ul><li><code>8.8.8.8</code> 是谷歌提供的公用 DNS 服务器;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-28-17-46-19.png" alt="2020-05-28-17-46-19"></p> <h4 id="在-dns-数据库中插入记录"><a href="#在-dns-数据库中插入记录" class="header-anchor">#</a> 在 DNS 数据库中插入记录</h4> <p>假如你有一个主机, 上面运行着一个 Web 服务器, 你想要给它弄一个域名:</p> <ul><li>第一步, 先去『 <strong>注册登记机构</strong> register 』注册一个想要的域名. 注册登记机构是一个商业实体, 其能帮你创建域名;
<ul><li>🌰 例如 <code>garrik.com</code></li></ul></li> <li>市面上有很多的注册登记机构, 它们都在『 <strong>因特网名字和地址分配机构</strong> ICANN 』获得了授权;</li> <li>当你向注册登记机构注册域名时, 需要向该机构提供你的基本和辅助『 <strong>权威 DNS 服务器</strong> 』的主机名和 IP 地址;
<ul><li>🌰 例如, <code>dns1.garrik.com, 212.212.212.1</code> 和 <code>dns2.garrik.com, 212.212.212.2</code></li></ul></li> <li>注册登记机构会为这两个权威 DNS 服务器生成对应的『 <strong>类型 NS</strong> 』和『 <strong>类型 A</strong> 』记录, 并且写入 <code>.com</code> 的中『 <strong>顶级域 DNS 服务器</strong>, TLD 』</li> <li>同时, 你还要将用于 Web 服务器 <code>www.garrik.com</code> 的『 <strong>类型 A</strong> 』记录写入你的『 <strong>权威 DNS 服务器</strong> 』中;</li></ul> <h2 id="p2p"><a href="#p2p" class="header-anchor">#</a> P2P</h2> <p>上面 👆 所讲述的应用都采用的 &quot;客户 - 服务器&quot; 架构, 这种应用极大地依赖于服务提供商的服务器;</p> <p>前面说过采用 P2P 体系架构的应用, 成对的间歇连接的主机 (对等方) 彼此间直接连接. 对于服务提供商的服务器依赖最小;</p> <p>下面 👇 介绍两种采用 P2P 架构设计的应用:</p> <h3 id="p2p-文件分发"><a href="#p2p-文件分发" class="header-anchor">#</a> P2P 文件分发</h3> <ul><li>『 <strong>文件分发应用</strong> 』, 即是从一个单独的服务器开始, 向大量的主机分发一个文件;</li> <li>对于『 <strong>客户 - 服务器架构</strong> 』的文件分发应用, 该服务器必须向每个主机单独发送该文件的一个副本;</li> <li>对于『 <strong>P2P 架构</strong> 』的文件分发应用, 每个接收到了文件数据的对等方能够协助服务器, 向其他对等方分发该接收到的文件部分;</li></ul> <p>下面 👇 我们就来通过比较这两种架构下, 分发文件所花费的时间, 来展示一下 P2P 应用的扩展性.</p> <h4 id="p2p-的扩展性"><a href="#p2p-的扩展性" class="header-anchor">#</a> P2P 的扩展性</h4> <p>🤔 <strong>假设</strong>:</p> <ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">u_s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 表示服务器接入链路的上传速度;</li> <li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 表示第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span> 对等方接入链路的上传速度;</li> <li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 表示第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span> 对等方接入链路的下载速度;</li> <li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span> 表示被分发的文件比特长度;</li> <li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> 表示对等方的数量;</li> <li>『 <strong>分发时间</strong> distribution time 』指的是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> 个对等方, 都接收到了要分发的文件副本所花的时间;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-28-18-26-22.png" alt="2020-05-28-18-26-22"></p> <hr> <p><strong>客户 - 服务器架构</strong>:</p> <ul><li>服务器必须向 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> 个对等方分别传输此文件的一个副本, 所以总共需要传输 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">NF</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span> 个比特. 服务器的上传速率为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">u_s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>, 所以分发时间至少为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>u</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">NF/u_s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathrm">/</span><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li> <li>令 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{min}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 为具有最小下载速度的对等方, 即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo>{</mo><msub><mi>d</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>d</mi><mi>n</mi></msub><mo>}</mo></mrow><annotation encoding="application/x-tex">d_{min} = min\{d_1, d_2, ... , d_n\}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mopen">{</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">}</span></span></span></span></li> <li>具有最小下载速度的对等方需要不少于 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F/d_{min}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathrm">/</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> 秒的时间去获得整个文件. 因此最小分发时间至少为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F/d_{min}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathrm">/</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li> <li>因此得到, 总共分发时间:</li></ul> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>c</mi><mi>s</mi></mrow></msub><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo fence="true">{</mo><mfrac><mrow><mi>N</mi><mi>F</mi></mrow><mrow><msub><mi>u</mi><mi>s</mi></msub></mrow></mfrac><mo separator="true">,</mo><mfrac><mrow><mi>F</mi></mrow><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow></mfrac><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">D_{cs} = max\left\{\frac{NF}{u_s},\frac{F}{d_{min}}\right\}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">c</span><span class="mord mathit">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">}</span></span></span></span></span></span></span></p> <hr> <p><strong>P2P 架构</strong>:</p> <ul><li>在分发开始时只有服务器具有文件. 服务器经其他链路至少分发该文件每个比特一次. 因此最小分发时间至少为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>u</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">F/u_s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathrm">/</span><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li> <li>具有最小下载速度的对等方获取完所有的文件数据至少需要 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F/d_{min}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathrm">/</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>, 如果其时间大于 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>u</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">F/u_s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathrm">/</span><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>, 则最小分发时间为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F/d_{min}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathrm">/</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li> <li>在 P2P 架构中, 对等方之间可以互相分发他们获得的数据的. 则整个系统的总上传能力等于服务器上传速度, 加上每个对等方的上传速度, 即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><msub><mi>u</mi><mi>s</mi></msub><mo>+</mo><msub><mi>u</mi><mn>1</mn></msub><mo>+</mo><msub><mi>u</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>u</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">u_{total} = u_s + u_1 + u_2 + ... + u_n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mord mathit">o</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li> <li>系统总共要向 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> 个对等方分别上传 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span> 比特的数据, 总共 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">NF</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span> 个比特. 所需时间至少为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>u</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">NF/u_{total}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathrm">/</span><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mord mathit">o</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></li> <li>上面的三种时间进行比较, 因此得到总共分发时间:</li></ul> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>p</mi><mn>2</mn><mi>p</mi></mrow></msub><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo fence="true">{</mo><mfrac><mrow><mi>F</mi></mrow><mrow><msub><mi>u</mi><mi>s</mi></msub></mrow></mfrac><mo separator="true">,</mo><mfrac><mrow><mi>F</mi></mrow><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi>N</mi><mi>F</mi></mrow><mrow><msub><mi>u</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow></mfrac><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">D_{p2p} =max\left\{\frac{F}{u_s},\frac{F}{d_{min}}\frac{NF}{u_{total}}\right\}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">p</span><span class="mord mathrm">2</span><span class="mord mathit">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mord mathit">o</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">}</span></span></span></span></span></span></span></p> <hr> <p>下图 👇 表示出了随着 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> 的增大, 两种架构分发时间的涨势:</p> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-28-19-26-41.png" alt="2020-05-28-19-26-41"></p> <p>可以看出, <strong>随着对等方数量的增大, P2P 架构的分发系统, 所花的时间并没有增长很多, 它的服务能力是自扩展的</strong>. 原因是, <strong>对等方即使消费者, 也是服务器提供者</strong>.</p> <h4 id="bittorrent-协议"><a href="#bittorrent-协议" class="header-anchor">#</a> BitTorrent 协议</h4> <ul><li>BitTorrent 是目前流行的文件分发 P2P 协议;</li> <li>在 BitTorrent 术语中, 参与一个特定文件分发的所有对等方的集合，被称为一个『 <strong>洪流</strong> torrent 』</li> <li>在一个洪流中对等方彼此下载和上传等长度的『 <strong>文件块</strong> chunk 』</li> <li>每个洪流中有一个基础设施节点称为『 追<strong>踪器</strong> tracker 』</li> <li>当有新的对等方加入洪流时，他向追踪器注册自己并周期性的通知追踪器他仍在洪流中。通过这种方式，追踪器跟踪洪流中的所有对等方;</li> <li>同时, 当有新的对等方加入洪流时, 追踪器随机分配对等方集合的自己给这个新加入对等方，新加入对等方尝试与这个子集上的对等方机建立并行的 TCP 连接;</li> <li>成功创建 TCP 连接的对等方称为『 <strong>临近对等方</strong> 』, 整个洪流中的对等方可以随时加入或退出，所以一个对等方的临近对等方将随时间而改变;</li> <li>对等方会周期性的询问他的临近对等方他们所具有的文件块，并向他们请求自己没有的文件块;</li></ul> <p><img src="https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-05-28-19-44-53.png" alt="2020-05-28-19-44-53"></p> <ul><li>在对等方决定该向他的邻居请求哪些块时，采用了『 <strong>最稀缺优先</strong> rarest first 』技术;
<ul><li>核心思想是, 针对他没有的块，向他的邻居中请求最稀缺的 块，也就是那<strong>些在他的邻居中副本数量最少的文件块</strong>;</li> <li>通过这种方式，最稀缺文件块得到更为迅速的重新分发，<strong>可以均衡每个块在洪流中的副本数量</strong>;</li></ul></li> <li>在对等方决定响应哪些邻居的请求时, 采用了『 <strong>对换算法</strong> 』
<ul><li>核心思想是, 对等方根据当前能够以最高速率向他提供数据的邻居给出其优先权;</li> <li>对等方持续性的测量从每个邻居那里接收到的比特速率，并确定以最高速率流入的一个邻居集合. 这些对等方式被称为『 <strong>疏通</strong> unchoked 』</li> <li>而其他的相邻对等方被称为『 <strong>阻塞</strong> 』即当前对等方不会向其他的阻塞对等方发送任何块;</li> <li>每过一段时间当前对等方随机地向它另外一个邻居发送文件块。我们称当前对等方为 A，随机选择的对等方为 B;</li> <li>如果 A 的传输速度比 B 当前的疏通对等方的速度要快，A 就可能成为 B 的疏通. 同时从之前 B 的疏通集合中剔除掉一个最慢的对等方;</li> <li>B 这个时候也会向 A 发送文件块，如果 B 的传输速度足够快，B 也有可能成为 A 的疏通。这被称为『 <strong>对换</strong> 』</li> <li>每隔一段时间，他们还会向新的随机对等方发送文件块，并重复上面的过程;</li> <li><strong>通过对换, 能够让所有对等方找到彼此互相协调的上传/下载速率</strong>;</li></ul></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">7/14/2020, 8:59:47 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my-notebook/assets/js/app.7f26aa6e.js" defer></script><script src="/my-notebook/assets/js/2.86213550.js" defer></script><script src="/my-notebook/assets/js/253.30f1dd88.js" defer></script>
  </body>
</html>
