<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Test Prep | Garrik 的笔记</title>
    <meta name="description" content="这里是 Garrik 的前端笔记本">
    
    
    <link rel="preload" href="/front-end-notebook/assets/css/91.styles.47d3d5b1.css" as="style"><link rel="preload" href="/front-end-notebook/assets/js/app.645ef008.js" as="script"><link rel="preload" href="/front-end-notebook/assets/js/15.359570c3.js" as="script"><link rel="prefetch" href="/front-end-notebook/assets/js/46.dda514c3.js"><link rel="prefetch" href="/front-end-notebook/assets/js/1.733b703b.js"><link rel="prefetch" href="/front-end-notebook/assets/js/2.b829433d.js"><link rel="prefetch" href="/front-end-notebook/assets/js/3.0411eb14.js"><link rel="prefetch" href="/front-end-notebook/assets/js/4.f7249c89.js"><link rel="prefetch" href="/front-end-notebook/assets/js/5.246b5224.js"><link rel="prefetch" href="/front-end-notebook/assets/js/6.df1084cb.js"><link rel="prefetch" href="/front-end-notebook/assets/js/7.4be9c6bc.js"><link rel="prefetch" href="/front-end-notebook/assets/js/8.a8940947.js"><link rel="prefetch" href="/front-end-notebook/assets/js/9.4111fe4e.js"><link rel="prefetch" href="/front-end-notebook/assets/js/10.d65209ff.js"><link rel="prefetch" href="/front-end-notebook/assets/js/11.83d8b845.js"><link rel="prefetch" href="/front-end-notebook/assets/js/12.ae38492e.js"><link rel="prefetch" href="/front-end-notebook/assets/js/13.6e7f66df.js"><link rel="prefetch" href="/front-end-notebook/assets/js/14.64073a76.js"><link rel="prefetch" href="/front-end-notebook/assets/js/16.60a17392.js"><link rel="prefetch" href="/front-end-notebook/assets/js/17.dfe0d9de.js"><link rel="prefetch" href="/front-end-notebook/assets/js/18.1df33b61.js"><link rel="prefetch" href="/front-end-notebook/assets/js/19.858e6a9e.js"><link rel="prefetch" href="/front-end-notebook/assets/js/20.ab0c59f3.js"><link rel="prefetch" href="/front-end-notebook/assets/js/21.628950f1.js"><link rel="prefetch" href="/front-end-notebook/assets/js/22.72dd63d7.js"><link rel="prefetch" href="/front-end-notebook/assets/js/23.fecb62ba.js"><link rel="prefetch" href="/front-end-notebook/assets/js/24.b3d99cb0.js"><link rel="prefetch" href="/front-end-notebook/assets/js/25.3426bd60.js"><link rel="prefetch" href="/front-end-notebook/assets/js/26.dbf8ae77.js"><link rel="prefetch" href="/front-end-notebook/assets/js/27.b6236e22.js"><link rel="prefetch" href="/front-end-notebook/assets/js/28.6059568e.js"><link rel="prefetch" href="/front-end-notebook/assets/js/29.59f8953c.js"><link rel="prefetch" href="/front-end-notebook/assets/js/30.5c0d9ff0.js"><link rel="prefetch" href="/front-end-notebook/assets/js/31.4c8ac838.js"><link rel="prefetch" href="/front-end-notebook/assets/js/32.f35c6276.js"><link rel="prefetch" href="/front-end-notebook/assets/js/33.c4ff2ab3.js"><link rel="prefetch" href="/front-end-notebook/assets/js/34.95b90568.js"><link rel="prefetch" href="/front-end-notebook/assets/js/35.6fd17b12.js"><link rel="prefetch" href="/front-end-notebook/assets/js/36.dd9f887c.js"><link rel="prefetch" href="/front-end-notebook/assets/js/37.c66530dc.js"><link rel="prefetch" href="/front-end-notebook/assets/js/38.060b98cc.js"><link rel="prefetch" href="/front-end-notebook/assets/js/39.37740108.js"><link rel="prefetch" href="/front-end-notebook/assets/js/40.6ce56d3a.js"><link rel="prefetch" href="/front-end-notebook/assets/js/41.bb017cb5.js"><link rel="prefetch" href="/front-end-notebook/assets/js/42.0e41bd10.js"><link rel="prefetch" href="/front-end-notebook/assets/js/43.333c55d9.js"><link rel="prefetch" href="/front-end-notebook/assets/js/44.d5041cc8.js"><link rel="prefetch" href="/front-end-notebook/assets/js/45.02530921.js"><link rel="prefetch" href="/front-end-notebook/assets/js/0.cab4fd7b.js"><link rel="prefetch" href="/front-end-notebook/assets/js/47.b0f4bbbd.js"><link rel="prefetch" href="/front-end-notebook/assets/js/48.58e11b3d.js"><link rel="prefetch" href="/front-end-notebook/assets/js/49.7e039343.js"><link rel="prefetch" href="/front-end-notebook/assets/js/50.f007e3f6.js"><link rel="prefetch" href="/front-end-notebook/assets/js/51.46af1cbe.js"><link rel="prefetch" href="/front-end-notebook/assets/js/52.c42da945.js"><link rel="prefetch" href="/front-end-notebook/assets/js/53.0cf9f169.js"><link rel="prefetch" href="/front-end-notebook/assets/js/54.a615d3de.js"><link rel="prefetch" href="/front-end-notebook/assets/js/55.eb471972.js"><link rel="prefetch" href="/front-end-notebook/assets/js/56.75da6d28.js"><link rel="prefetch" href="/front-end-notebook/assets/js/57.f326e0bf.js"><link rel="prefetch" href="/front-end-notebook/assets/js/58.815005bc.js"><link rel="prefetch" href="/front-end-notebook/assets/js/59.fe81f217.js"><link rel="prefetch" href="/front-end-notebook/assets/js/60.0682325f.js"><link rel="prefetch" href="/front-end-notebook/assets/js/61.1c11de0f.js"><link rel="prefetch" href="/front-end-notebook/assets/js/62.a5849b1e.js"><link rel="prefetch" href="/front-end-notebook/assets/js/63.71d81490.js"><link rel="prefetch" href="/front-end-notebook/assets/js/64.77d43118.js"><link rel="prefetch" href="/front-end-notebook/assets/js/65.69de9684.js"><link rel="prefetch" href="/front-end-notebook/assets/js/66.fafea3b6.js"><link rel="prefetch" href="/front-end-notebook/assets/js/67.fa197cd5.js"><link rel="prefetch" href="/front-end-notebook/assets/js/68.ebd7913d.js"><link rel="prefetch" href="/front-end-notebook/assets/js/69.7ad32a14.js"><link rel="prefetch" href="/front-end-notebook/assets/js/70.3452409d.js"><link rel="prefetch" href="/front-end-notebook/assets/js/71.76b51544.js"><link rel="prefetch" href="/front-end-notebook/assets/js/72.4f7bbfdd.js"><link rel="prefetch" href="/front-end-notebook/assets/js/73.1683e7a5.js"><link rel="prefetch" href="/front-end-notebook/assets/js/74.7a14fd49.js"><link rel="prefetch" href="/front-end-notebook/assets/js/75.8fdd8dee.js"><link rel="prefetch" href="/front-end-notebook/assets/js/76.5e47dcda.js"><link rel="prefetch" href="/front-end-notebook/assets/js/77.660b545f.js"><link rel="prefetch" href="/front-end-notebook/assets/js/78.05e10363.js"><link rel="prefetch" href="/front-end-notebook/assets/js/79.e2b89cb2.js"><link rel="prefetch" href="/front-end-notebook/assets/js/80.0214ee66.js"><link rel="prefetch" href="/front-end-notebook/assets/js/81.d353f6fd.js"><link rel="prefetch" href="/front-end-notebook/assets/js/82.006b683a.js"><link rel="prefetch" href="/front-end-notebook/assets/js/83.9aea4b23.js"><link rel="prefetch" href="/front-end-notebook/assets/js/84.f485f726.js"><link rel="prefetch" href="/front-end-notebook/assets/js/85.570acf12.js"><link rel="prefetch" href="/front-end-notebook/assets/js/86.95ca4c10.js"><link rel="prefetch" href="/front-end-notebook/assets/js/87.62f5d181.js"><link rel="prefetch" href="/front-end-notebook/assets/js/88.315368b0.js"><link rel="prefetch" href="/front-end-notebook/assets/js/89.e7db1568.js"><link rel="prefetch" href="/front-end-notebook/assets/js/90.bcfced8b.js">
    <link rel="stylesheet" href="/front-end-notebook/assets/css/91.styles.47d3d5b1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/front-end-notebook/" class="home-link router-link-active"><!----><span class="site-name">
      Garrik 的笔记
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/front-end-notebook/" class="nav-link">主页</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front-end-notebook/" class="nav-link">主页</a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Test Prep</span><!----></p><ul class="sidebar-group-items"><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#sql-tutorial" class="sidebar-link">SQL Tutorial</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-single-row-functions" class="sidebar-link">Using Single-Row Functions</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-aggregate-group-functions" class="sidebar-link">Using Aggregate / Group Functions</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-from-where-group-by-having-order-by-distinct" class="sidebar-link">Using FROM, WHERE, GROUP BY, HAVING, ORDER BY, Distinct</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#joins-inner-join-outer-joins-left-join-and-right-join" class="sidebar-link">Joins: Inner-Join, Outer Joins (Left Join and Right Join)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#joins-non-equi-join-multiple-table-joins-self-joins" class="sidebar-link">Joins: Non-equi Join, Multiple Table Joins, Self Joins</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-set-operators-union-union-all-intersect-minus" class="sidebar-link">Using SET operators (UNION, UNION ALL, INTERSECT, MINUS)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#subqueries" class="sidebar-link">Subqueries</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-subqueries-with-in-not-in" class="sidebar-link">Using Subqueries with IN, NOT IN</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#nested-subqueries" class="sidebar-link">Nested Subqueries</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#correlated-subqueries" class="sidebar-link">Correlated Subqueries</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#subquery-virtual-columns" class="sidebar-link">Subquery Virtual Columns</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#subquery-virtual-tables" class="sidebar-link">Subquery Virtual Tables</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-subqueries-with-insert-update-and-delete" class="sidebar-link">Using Subqueries with INSERT, UPDATE, and DELETE</a></li></ul></li><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#views" class="sidebar-link">Views</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#create-views" class="sidebar-link">Create Views</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-views" class="sidebar-link">Using Views</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#modifying-data-behind-a-view" class="sidebar-link">Modifying Data behind a view</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#modifying-data-through-a-view" class="sidebar-link">Modifying Data through a view</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#restriction-when-updating-through-a-view" class="sidebar-link">Restriction when updating through a view</a></li></ul></li><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#privileges" class="sidebar-link">Privileges</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#granting-privileges" class="sidebar-link">Granting Privileges</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#revoking-privileges" class="sidebar-link">Revoking Privileges</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#creating-roles" class="sidebar-link">Creating Roles</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-roles" class="sidebar-link">Using Roles</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#granting-and-revoking-privliges-on-database-objects" class="sidebar-link">Granting and Revoking Privliges on Database Objects</a></li></ul></li><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#pl-sql" class="sidebar-link">PL/SQL</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#asp-net" class="sidebar-link">ASP.NET</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-data-access-objects" class="sidebar-link">Using Data Access Objects</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-gridview-drop-down-list-detailview-components-including-binding" class="sidebar-link">Using GridView, Drop Down List, DetailView components (including binding)</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-gridview-rowcommand-events" class="sidebar-link">Using GridView RowCommand events</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-the-ispostback-property-in-the-pageload-event" class="sidebar-link">Using the IsPostBack property in the PageLoad event</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-validators-and-the-isvalid-property" class="sidebar-link">Using Validators and the IsValid property</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-url-encoded-parameters" class="sidebar-link">Using URL-encoded parameters</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#page-transfers-server-transfer" class="sidebar-link">Page Transfers (Server.Transfer)</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#page-redirection-response-redirect" class="sidebar-link">Page Redirection (Response.Redirect)</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#retrieving-data-from-previous-page-controls" class="sidebar-link">Retrieving Data From Previous Page Controls</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#creating-using-master-detail-pages" class="sidebar-link">Creating/Using master-detail pages</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-login-authentication-scheme-with-basepage" class="sidebar-link">Using login authentication scheme (with BasePage)</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#using-command-parameters" class="sidebar-link">Using Command Parameters</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#executing-insert-update-and-delete-statements-from-asp-net" class="sidebar-link">Executing INSERT, UPDATE, and DELETE statements from ASP.NET</a></li><li class="sidebar-sub-header"><a href="/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/test_prep.html#sequences" class="sidebar-link">Sequences</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="test-prep"><a href="#test-prep" aria-hidden="true" class="header-anchor">#</a> Test Prep</h1><h2 id="sql-tutorial"><a href="#sql-tutorial" aria-hidden="true" class="header-anchor">#</a> SQL Tutorial</h2><p><a href="https://www.w3schools.com/sql/default.asp" target="_blank" rel="noopener noreferrer">SQL Tutorial<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h2 id="using-single-row-functions"><a href="#using-single-row-functions" aria-hidden="true" class="header-anchor">#</a> Using Single-Row Functions</h2><p><a href="https://www.w3schools.com/sql/sql_ref_oracle.asp" target="_blank" rel="noopener noreferrer">Oracle Functions List<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h2 id="using-aggregate-group-functions"><a href="#using-aggregate-group-functions" aria-hidden="true" class="header-anchor">#</a> Using Aggregate / Group Functions</h2><p>Grouping allows several rows in a table to be grouped together and for a single value to be computed based on the group of rows.</p><ul><li><a href="https://www.w3schools.com/sql/sql_min_max.asp" target="_blank" rel="noopener noreferrer">MIN(), MAX()<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://www.w3schools.com/sql/sql_count_avg_sum.asp" target="_blank" rel="noopener noreferrer">COUNT(), AVG(), SUM()<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>Price<span class="token punctuation">)</span> <span class="token keyword">AS</span> SmallestPrice
<span class="token keyword">FROM</span> Products<span class="token punctuation">;</span>
</code></pre></div><h2 id="using-from-where-group-by-having-order-by-distinct"><a href="#using-from-where-group-by-having-order-by-distinct" aria-hidden="true" class="header-anchor">#</a> Using FROM, WHERE, GROUP BY, HAVING, ORDER BY, Distinct</h2><h4 id="from"><a href="#from" aria-hidden="true" class="header-anchor">#</a> FROM</h4><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
</code></pre></div><h4 id="where"><a href="#where" aria-hidden="true" class="header-anchor">#</a> WHERE</h4><p><code>WHERE</code> clause is used to filter records.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Customers <span class="token keyword">WHERE</span> Country<span class="token operator">=</span><span class="token string">'Mexico'</span><span class="token punctuation">;</span> 
</code></pre></div><h4 id="group-by"><a href="#group-by" aria-hidden="true" class="header-anchor">#</a> Group By</h4><p><code>GROUP BY</code> statement is often used with aggregate functions (COUNT, MAX, MIN, SUM, AVG) to group the result-set by one or more columns.</p><p>The <code>GROUP BY</code> clause tells the database server to group rows <strong>based on the distinct values</strong> that exist for the specified columns.</p><p>Syntax:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><p>E.g: Display the average salary per job type:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_sal <span class="token keyword">FROM</span> emp <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job<span class="token punctuation">;</span>
</code></pre></div><p>E.g: Lists the number of customers in each country, sorted high to low:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>CustomerID<span class="token punctuation">)</span><span class="token punctuation">,</span> Country
<span class="token keyword">FROM</span> Customers
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Country
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>CustomerID<span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="having"><a href="#having" aria-hidden="true" class="header-anchor">#</a> HAVING</h4><p><code>HAVING</code> clause was added to SQL because the <code>WHERE</code> keyword could not be used with aggregate functions.
<code>HAVING</code> clause can impose a further condition based on an aggregate or group condition.</p><p>Syntax:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">HAVING</span> condition
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>E.g: Lists the number of customers in each country. Only include countries with more than 5 customers:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>CustomerID<span class="token punctuation">)</span><span class="token punctuation">,</span> Country
<span class="token keyword">FROM</span> Customers
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Country
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>CustomerID<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="order-by"><a href="#order-by" aria-hidden="true" class="header-anchor">#</a> Order By</h4><p><code>ORDER BY</code> keyword is used to sort the result-set in ascending or descending order.</p><p>E.g: Selects all customers from the &quot;Customers&quot; table, sorted DESCENDING by the &quot;Country&quot; column:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Customers
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Country <span class="token keyword">DESC</span><span class="token punctuation">;</span> 
</code></pre></div><h4 id="distinct"><a href="#distinct" aria-hidden="true" class="header-anchor">#</a> Distinct</h4><p><code>SELECT DISTINCT</code> statement is used to return only distinct (different) values.</p><p>E.g: Selects only the DISTINCT values from the &quot;Country&quot; column in the &quot;Customers&quot; table:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> Country <span class="token keyword">FROM</span> Customers<span class="token punctuation">;</span>
</code></pre></div><p>E.g: Lists the number of different (distinct) customer countries:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> Country<span class="token punctuation">)</span> <span class="token keyword">FROM</span> Customers<span class="token punctuation">;</span>
</code></pre></div><h2 id="joins-inner-join-outer-joins-left-join-and-right-join"><a href="#joins-inner-join-outer-joins-left-join-and-right-join" aria-hidden="true" class="header-anchor">#</a> Joins: Inner-Join, Outer Joins (Left Join and Right Join)</h2><p>A <code>JOIN</code> clause is used to combine rows from two or more tables, based on a related column between them.</p><ul><li>INNER JOIN: Returns records that have matching values in both tables</li><li>LEFT JOIN: Return all records from the left table, and the matched records from the right table</li><li>RIGHT JOIN: Return all records from the right table, and the matched records from the left table</li><li>FULL (OUTER) JOIN: Return all records when there is a match in either left or right table</li></ul><p><img src="https://i.imgur.com/JAWya3N.png" alt="Screen Shot 2018-08-06 at 11.11.45 PM"></p><h4 id="inner-join"><a href="#inner-join" aria-hidden="true" class="header-anchor">#</a> Inner Join</h4><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Orders<span class="token punctuation">.</span>OrderID<span class="token punctuation">,</span> Customers<span class="token punctuation">.</span>CustomerName
<span class="token keyword">FROM</span> Orders <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Customers 
<span class="token keyword">ON</span> Orders<span class="token punctuation">.</span>CustomerID <span class="token operator">=</span> Customers<span class="token punctuation">.</span>CustomerID<span class="token punctuation">;</span> 
</code></pre></div><p>E.g: Display the employee number, name, job, salary, and salary grade for each employee</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> job<span class="token punctuation">,</span> sal<span class="token punctuation">,</span> grade 
<span class="token keyword">FROM</span> emp <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> salgrade 
<span class="token keyword">ON</span> sal <span class="token operator">BETWEEN</span> losal <span class="token operator">and</span> hisal 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sal <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="left-join"><a href="#left-join" aria-hidden="true" class="header-anchor">#</a> Left Join</h4><p>E.g: select all customers, and any orders they might have:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Customers<span class="token punctuation">.</span>CustomerName<span class="token punctuation">,</span> Orders<span class="token punctuation">.</span>OrderID
<span class="token keyword">FROM</span> Customers <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Orders 
<span class="token keyword">ON</span> Customers<span class="token punctuation">.</span>CustomerID <span class="token operator">=</span> Orders<span class="token punctuation">.</span>CustomerID
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Customers<span class="token punctuation">.</span>CustomerName<span class="token punctuation">;</span>
</code></pre></div><h4 id="right-join"><a href="#right-join" aria-hidden="true" class="header-anchor">#</a> Right Join</h4><p>E,g: Return all employees, and any orders they might have placed:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Orders<span class="token punctuation">.</span>OrderID<span class="token punctuation">,</span> Employees<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> Employees<span class="token punctuation">.</span>FirstName
<span class="token keyword">FROM</span> Orders <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> Employees 
<span class="token keyword">ON</span> Orders<span class="token punctuation">.</span>EmployeeID <span class="token operator">=</span> Employees<span class="token punctuation">.</span>EmployeeID
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Orders<span class="token punctuation">.</span>OrderID<span class="token punctuation">;</span> 
</code></pre></div><h2 id="joins-non-equi-join-multiple-table-joins-self-joins"><a href="#joins-non-equi-join-multiple-table-joins-self-joins" aria-hidden="true" class="header-anchor">#</a> Joins: Non-equi Join, Multiple Table Joins, Self Joins</h2><h2 id="using-set-operators-union-union-all-intersect-minus"><a href="#using-set-operators-union-union-all-intersect-minus" aria-hidden="true" class="header-anchor">#</a> Using SET operators (UNION, UNION ALL, INTERSECT, MINUS)</h2><h4 id="union"><a href="#union" aria-hidden="true" class="header-anchor">#</a> UNION</h4><p><code>UNION</code> operator combines the two sets of rows (from two SELECT statements) into a single row set.</p><p>E.g: Display the employee number, name, salary and/or commission for each employee</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> <span class="token string">'SAL'</span> <span class="token keyword">AS</span> <span class="token keyword">type</span><span class="token punctuation">,</span> sal <span class="token keyword">AS</span> amount <span class="token keyword">FROM</span> emp
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> <span class="token string">'COMM'</span><span class="token punctuation">,</span> comm <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> comm <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://i.imgur.com/SH2MqSS.png" alt="Screen Shot 2018-08-06 at 11.50.58 PM"></p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> <span class="token string">'SAL'</span> <span class="token keyword">AS</span> <span class="token keyword">type</span><span class="token punctuation">,</span> sal <span class="token keyword">AS</span> amount <span class="token keyword">FROM</span> emp
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> <span class="token string">'COMM'</span><span class="token punctuation">,</span> comm <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> comm <span class="token operator">&gt;</span> <span class="token number">0</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://i.imgur.com/EQlNFyL.png" alt="Screen Shot 2018-08-06 at 11.53.48 PM"></p><h4 id="union-all"><a href="#union-all" aria-hidden="true" class="header-anchor">#</a> UNION ALL</h4><p>When two sets of rows are UNIONed together, the <code>UNION</code> operator eliminates duplicate rows. To keep the duplicate rows, use the <code>UNION ALL</code> operator instead of the <code>UNION</code> operator.</p><p>E.g: Display all of the different salary and commission amounts
(This example has duplicate rows eliminated:)</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> sal <span class="token keyword">AS</span> amount <span class="token keyword">FROM</span> emp
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> comm <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> comm <span class="token operator">&gt;</span> <span class="token number">0</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> amount
</code></pre></div><p><img src="https://i.imgur.com/ni69CBy.png" alt="Screen Shot 2018-08-06 at 11.56.10 PM"></p><p>E.g: Display all of the salary and commission amounts
(This example keeps duplicate rows:)</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> sal <span class="token keyword">AS</span> amount <span class="token keyword">FROM</span> emp
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> comm <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> comm <span class="token operator">&gt;</span> <span class="token number">0</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> amount
</code></pre></div><p><img src="https://i.imgur.com/rp9LWQS.png" alt="Screen Shot 2018-08-06 at 11.55.55 PM"></p><h4 id="intersect"><a href="#intersect" aria-hidden="true" class="header-anchor">#</a> INTERSECT</h4><p>The <code>INTERSECT</code> operator returns the rows that are common between two sets of rows.</p><p>E.g: Display the employee number of all of the employees who earn 3000 or less and are managers</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> mgr <span class="token keyword">FROM</span> emp
<span class="token keyword">INTERSECT</span>
<span class="token keyword">SELECT</span> empno <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> sal <span class="token operator">&lt;=</span> <span class="token number">3000</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> mgr<span class="token punctuation">;</span>
</code></pre></div><p><img src="https://i.imgur.com/HRUk8bv.png" alt="Screen Shot 2018-08-06 at 11.58.48 PM"></p><h4 id="minus"><a href="#minus" aria-hidden="true" class="header-anchor">#</a> MINUS</h4><p>The <code>MINUS</code> operator returns the rows in the first set of rows that do not exist in the second set of rows. The MINUS operator is sometimes called the difference operator.</p><p>E.g: Display the employee number of all employees who are not managers</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> empno <span class="token keyword">FROM</span> emp
MINUS
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> mgr <span class="token keyword">FROM</span> emp
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="subqueries"><a href="#subqueries" aria-hidden="true" class="header-anchor">#</a> Subqueries</h2><p>A subquery allows the results of one SELECT statement to be used in another DML statement.</p><p>When used in a DML statement, a subquery must be enclosed in parentheses. The number of rows returned by a subquery must match the number of values that the function or operator expects. The <code>ORDER BY</code> clause cannot used within a subquery</p><p>E.g: get the employee number, name, job, and salary of all employees that make more than the lowest paid salesman.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> job<span class="token punctuation">,</span> sal <span class="token keyword">FROM</span> emp
<span class="token keyword">WHERE</span> sal <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> job <span class="token operator">=</span> <span class="token string">'SALESMAN'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="using-subqueries-with-in-not-in"><a href="#using-subqueries-with-in-not-in" aria-hidden="true" class="header-anchor">#</a> Using Subqueries with IN, NOT IN</h3><p>Using <code>IN</code> in a subquery allows a column or expression to be compared to a set of values returned from the subquery.</p><p>E.g:  Get employee numbers of all of the managers of the clerks and analysts.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> mgr <span class="token keyword">FROM</span> emp <span class="token keyword">where</span> job <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token string">'ANALYST'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="nested-subqueries"><a href="#nested-subqueries" aria-hidden="true" class="header-anchor">#</a> Nested Subqueries</h3><p>A nested subquery is a subquery within a subquery.</p><p>E.g: get the employee information for the managers with the most employees.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> job <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> empno <span class="token operator">IN</span>
<span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> mgr <span class="token keyword">FROM</span> emp <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> mgr <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=</span>
   <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> emp <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> mgr
   <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="correlated-subqueries"><a href="#correlated-subqueries" aria-hidden="true" class="header-anchor">#</a> Correlated Subqueries</h3><p>Correlated subqueries reference information from the main query. Since a correlated subquery is dependent on row data from the main query, this subquery must be re-evaluated for each row of the main query.</p><p>E.g: lists the employee number, name, job, and department name of all employees who do not work in the same department as their managers (but do have managers!)</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> job<span class="token punctuation">,</span> dname 
<span class="token keyword">FROM</span> emp employees <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> dept 
<span class="token keyword">ON</span> employees<span class="token punctuation">.</span>deptno <span class="token operator">=</span> dept<span class="token punctuation">.</span>deptno
<span class="token keyword">WHERE</span> mgr <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token operator">AND</span> employees<span class="token punctuation">.</span>deptno <span class="token operator">!=</span>
<span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> deptno <span class="token keyword">FROM</span> emp managers <span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span>mgr <span class="token operator">=</span> managers<span class="token punctuation">.</span>empno
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="subquery-virtual-columns"><a href="#subquery-virtual-columns" aria-hidden="true" class="header-anchor">#</a> Subquery Virtual Columns</h3><p>A subquery can appear as a virtual column expression. This is a form of correlated subquery; that is, the subquery must execute for every row of the query. The subquery must return a single row and column.</p><p>E.g: list each employee along with the name of the employee's department.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ename<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> dname <span class="token keyword">FROM</span> dept <span class="token keyword">WHERE</span> dept<span class="token punctuation">.</span>deptno <span class="token operator">=</span> emp<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span> <span class="token keyword">AS</span> dname <span class="token keyword">FROM</span> emp<span class="token punctuation">;</span>
</code></pre></div><p>E.g:  list the name and the number of employees in each department.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> dname<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> dept<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span> <span class="token keyword">AS</span> num_emps <span class="token keyword">FROM</span> dept<span class="token punctuation">;</span>
</code></pre></div><h3 id="subquery-virtual-tables"><a href="#subquery-virtual-tables" aria-hidden="true" class="header-anchor">#</a> Subquery Virtual Tables</h3><p>A subquery can appear as a virtual table in the <code>FROM</code> clause of a <code>SELECT</code> statement. The virtual table can appear as part of a table join. The columns produced by the virtual table become valid columns to SELECT in the query.</p><p>E.g: list the employee name, salary, and salary grade for each employee that is salary grade 3 or higher.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ename<span class="token punctuation">,</span> sal<span class="token punctuation">,</span> grade 
<span class="token keyword">FROM</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> emp <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> salgrade 
<span class="token keyword">ON</span> sal <span class="token operator">BETWEEN</span> losal <span class="token operator">AND</span> hisal<span class="token punctuation">)</span> empsalgrade 
<span class="token keyword">WHERE</span> grade <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre></div><p>E.g: list the name of all employees along with the number of employees in the department in which the employee resides ordered from the departments with the most employees to the department with the least employees, sub sorted alphabetically by employee name.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ename<span class="token punctuation">,</span> num_emps
<span class="token keyword">FROM</span> emp <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> deptno<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> emp emp2 
<span class="token keyword">WHERE</span> emp2<span class="token punctuation">.</span>deptno <span class="token operator">=</span> dept<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span> <span class="token keyword">AS</span> num_emps <span class="token keyword">FROM</span> dept<span class="token punctuation">)</span> empcount 
<span class="token keyword">ON</span> emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> empcount<span class="token punctuation">.</span>deptno
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> num_emps <span class="token keyword">DESC</span><span class="token punctuation">,</span> ename <span class="token keyword">ASC</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="using-subqueries-with-insert-update-and-delete"><a href="#using-subqueries-with-insert-update-and-delete" aria-hidden="true" class="header-anchor">#</a> Using Subqueries with INSERT, UPDATE, and DELETE</h3><p><a href="https://garrik-liu.github.io/front-end-notebook/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E7%94%A8/ols/files/Modifying_a_Table_with_DML_Statements.html#insert" target="_blank" rel="noopener noreferrer">My Note<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h4 id="insert"><a href="#insert" aria-hidden="true" class="header-anchor">#</a> Insert</h4><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> donations <span class="token punctuation">(</span>receipt_no<span class="token punctuation">,</span> first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> amount<span class="token punctuation">)</span> 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1280</span><span class="token punctuation">,</span> <span class="token string">'Kevin'</span><span class="token punctuation">,</span> <span class="token string">'Dunn'</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Insert Date:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> card_accounts <span class="token punctuation">(</span>card_number<span class="token punctuation">,</span> first_name<span class="token punctuation">,</span> middle_initial<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> valid_date<span class="token punctuation">,</span> expiry_date<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">55555555</span><span class="token punctuation">,</span> <span class="token string">'Cathy'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'Puck'</span><span class="token punctuation">,</span> TO_DATE<span class="token punctuation">(</span><span class="token string">'11-NOV-2005'</span><span class="token punctuation">,</span> <span class="token string">'DD-MON-YYYY'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> TO_DATE<span class="token punctuation">(</span><span class="token string">'10-NOV-2006'</span><span class="token punctuation">,</span> <span class="token string">'DD-MON-YYYY'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Insert Internal:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> events <span class="token punctuation">(</span>duration<span class="token punctuation">,</span> next_event<span class="token punctuation">)</span> 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span>TO_DSINTERVAL<span class="token punctuation">(</span><span class="token string">'0 02:30:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> TO_YMINTERVAL<span class="token punctuation">(</span><span class="token string">'1-6'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="update"><a href="#update" aria-hidden="true" class="header-anchor">#</a> Update</h4><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> donations <span class="token keyword">SET</span> last_name <span class="token operator">=</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> amount <span class="token operator">=</span> <span class="token number">880</span> <span class="token keyword">WHERE</span> receipt_no <span class="token operator">=</span> <span class="token number">1280</span><span class="token punctuation">;</span>

<span class="token keyword">UPDATE</span> donations <span class="token keyword">SET</span> last_name <span class="token operator">=</span> <span class="token string">'Dunn'</span><span class="token punctuation">,</span> amount <span class="token operator">=</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">WHERE</span> receipt_no <span class="token operator">=</span> <span class="token number">1280</span><span class="token punctuation">;</span>

<span class="token keyword">UPDATE</span> donations <span class="token keyword">SET</span> last_name <span class="token operator">=</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> amount <span class="token operator">=</span> <span class="token number">880</span> 
<span class="token keyword">WHERE</span> receipt_no <span class="token operator">=</span> <span class="token number">1280</span> <span class="token operator">AND</span> last_name <span class="token operator">=</span> <span class="token string">'Dunn'</span> <span class="token operator">AND</span> amount <span class="token operator">=</span> <span class="token number">800</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="delete"><a href="#delete" aria-hidden="true" class="header-anchor">#</a> Delete</h4><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> donations <span class="token keyword">WHERE</span> receipt_no <span class="token operator">=</span> <span class="token number">1280</span><span class="token punctuation">;</span>
</code></pre></div><p>Note that a row with a primary key cannot be deleted while a foreign key still refers to that primary key.</p><p>If it is desireable that any related foreign keys are automatically removed as well or that foreign keys are set to NULL, the foreign key can be defined with the phrase <code>ON DELETE CASCADE</code> or <code>ON DELETE SET NULL</code>.</p><div class="language-sql extra-class"><pre class="language-sql"><code>receipt_no NUMBER<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token keyword">CONSTRAINT</span> receipt_no_fk <span class="token keyword">REFERENCES</span> donations<span class="token punctuation">(</span>receipt_no<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span>

receipt_no NUMBER<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token keyword">CONSTRAINT</span> receipt_no_fk <span class="token keyword">REFERENCES</span> donations<span class="token punctuation">(</span>receipt_no<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">SET</span> <span class="token boolean">NULL</span>
</code></pre></div><h2 id="views"><a href="#views" aria-hidden="true" class="header-anchor">#</a> Views</h2><p>a view is a virtual table based on the result-set of an SQL statement.</p><h3 id="create-views"><a href="#create-views" aria-hidden="true" class="header-anchor">#</a> Create Views</h3><p>The syntax for creating a view is :</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token punctuation">[</span><span class="token operator">OR</span> <span class="token keyword">REPLACE</span><span class="token punctuation">]</span> <span class="token keyword">VIEW</span> view_name <span class="token punctuation">[</span><span class="token punctuation">(</span>column1<span class="token punctuation">,</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">,</span> columnN<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">AS</span> select_statement<span class="token punctuation">.</span> 
</code></pre></div><p>Use the <code>OR REPLACE</code> option to recreate a view.</p><p>E.g:  Construct a view that lists the name of all clerks along with their employee number and salary.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> clerks_analysts <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> sal<span class="token punctuation">,</span> job <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> job <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token string">'ANALYST'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>E.g: Construct a view that lists all employees who have at least one other employee in the same department with the same manager they have AND who earn more than their managers.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> same_dept_big_money <span class="token punctuation">(</span>empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> job<span class="token punctuation">,</span> mgr<span class="token punctuation">)</span> <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> job<span class="token punctuation">,</span> mgr <span class="token keyword">FROM</span> emp
<span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span>
<span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> emp empcompare
   <span class="token keyword">WHERE</span> emp<span class="token punctuation">.</span>mgr <span class="token operator">=</span> empcompare<span class="token punctuation">.</span>mgr <span class="token operator">AND</span>
   emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> empcompare<span class="token punctuation">.</span>deptno <span class="token operator">AND</span>
   emp<span class="token punctuation">.</span>empno <span class="token operator">!=</span> empcompare<span class="token punctuation">.</span>empno
<span class="token punctuation">)</span>
<span class="token keyword">INTERSECT</span>
<span class="token keyword">SELECT</span> e1<span class="token punctuation">.</span>empno<span class="token punctuation">,</span> e1<span class="token punctuation">.</span>ename<span class="token punctuation">,</span> e1<span class="token punctuation">.</span>job<span class="token punctuation">,</span> e1<span class="token punctuation">.</span>mgr
<span class="token keyword">FROM</span> emp e1<span class="token punctuation">,</span> emp e2
<span class="token keyword">WHERE</span> e2<span class="token punctuation">.</span>empno <span class="token operator">=</span> e1<span class="token punctuation">.</span>mgr <span class="token operator">AND</span> e1<span class="token punctuation">.</span>sal <span class="token operator">&gt;</span> e2<span class="token punctuation">.</span>sal<span class="token punctuation">;</span>
</code></pre></div><h3 id="using-views"><a href="#using-views" aria-hidden="true" class="header-anchor">#</a> Using Views</h3><h4 id="delete-2"><a href="#delete-2" aria-hidden="true" class="header-anchor">#</a> Delete</h4><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> view_name<span class="token punctuation">.</span>
</code></pre></div><h3 id="modifying-data-behind-a-view"><a href="#modifying-data-behind-a-view" aria-hidden="true" class="header-anchor">#</a> Modifying Data behind a view</h3><p>Creating a view differs from creating a table from a subquery in that a table is static and will not reflect changes in the tables on which it is based. A view will always reflect the current data.</p><h3 id="modifying-data-through-a-view"><a href="#modifying-data-through-a-view" aria-hidden="true" class="header-anchor">#</a> Modifying Data through a view</h3><p>Data can be modified through a view under three conditions.</p><ul><li>The view is based on a single table (or more precisely, the modification only affects a single key-preserved table).</li><li>The select statement does not have a <code>DISTINCT</code> clause, aggregates, or a <code>GROUP BY</code> clause.</li><li>The columns to be updated are not virtual columns — that is, they are based on real columns, not expressions.</li></ul><h3 id="restriction-when-updating-through-a-view"><a href="#restriction-when-updating-through-a-view" aria-hidden="true" class="header-anchor">#</a> Restriction when updating through a view</h3><h4 id="creating-a-read-only-view"><a href="#creating-a-read-only-view" aria-hidden="true" class="header-anchor">#</a> Creating a Read-Only View</h4><p>A view that would otherwise be updatable can be made non-updatable by adding the clause <code>WITH READ ONLY</code> to its create statement.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> clerks_analysts <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> sal<span class="token punctuation">,</span> job <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> job <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token string">'ANALYST'</span><span class="token punctuation">)</span>
<span class="token keyword">WITH</span> <span class="token keyword">READ</span> ONLY<span class="token punctuation">;</span>
</code></pre></div><h4 id="using-the-with-check-option"><a href="#using-the-with-check-option" aria-hidden="true" class="header-anchor">#</a> Using the WITH CHECK OPTION</h4><p>A view that includes a filter condition can prevent any updates to a row that will result in the row being excluded from the view.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> clerks_analysts <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> ename<span class="token punctuation">,</span> sal<span class="token punctuation">,</span> job <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> job <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'CLERK'</span><span class="token punctuation">,</span> <span class="token string">'ANALYST'</span><span class="token punctuation">)</span>
<span class="token keyword">WITH</span> <span class="token keyword">CHECK</span> <span class="token keyword">OPTION</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="privileges"><a href="#privileges" aria-hidden="true" class="header-anchor">#</a> Privileges</h2><p>Privileges allow a user to grant another user authority to access and/or create, modify, or delete database objects within the user's workspace.</p><p>There are two types of privileges:</p><ul><li><strong>System privileges</strong> allow the user to grant to another user the ability to create or destroy database objects in the user's workspace. E.g. CREATE TABLE privilege, DROP TABLE privilege. System privileges also include database administrator privileges such as CREATE USER privilege. A user must be database administrator to grant a database administration privilege to another user.</li><li><strong>Object privileges</strong> allow the user to grant to another user the ability to access or modify a database object in the user's workspace. E.g. SELECT privilege, INSERT privilege, ALTER privilege. Object privileges must specify the object on which the privileges are being granted.</li></ul><p><img src="https://i.imgur.com/DBdRD4w.png" alt="Screen Shot 2018-08-07 at 4.14.32 AM"></p><h3 id="granting-privileges"><a href="#granting-privileges" aria-hidden="true" class="header-anchor">#</a> Granting Privileges</h3><p>Done By DBA</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">GRANT</span> <span class="token keyword">CREATE</span> <span class="token keyword">SESSION</span><span class="token punctuation">,</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">TO</span> username<span class="token punctuation">;</span>
</code></pre></div><p>Grant System Privileges:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">GRANT</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">TO</span> username <span class="token keyword">WITH</span> ADMIN <span class="token keyword">OPTION</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="revoking-privileges"><a href="#revoking-privileges" aria-hidden="true" class="header-anchor">#</a> Revoking Privileges</h3><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">REVOKE</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">FROM</span> username<span class="token punctuation">;</span>
</code></pre></div><h3 id="creating-roles"><a href="#creating-roles" aria-hidden="true" class="header-anchor">#</a> Creating Roles</h3><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> ROLE role_name<span class="token punctuation">;</span>
</code></pre></div><h3 id="using-roles"><a href="#using-roles" aria-hidden="true" class="header-anchor">#</a> Using Roles</h3><p>Assign a role to a user</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">GRANT</span> role_name <span class="token keyword">TO</span> user_name
</code></pre></div><h3 id="granting-and-revoking-privliges-on-database-objects"><a href="#granting-and-revoking-privliges-on-database-objects" aria-hidden="true" class="header-anchor">#</a> Granting and Revoking Privliges on Database Objects</h3><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">GRANT</span> privilege1<span class="token punctuation">,</span> privilege2<span class="token punctuation">,</span> …
<span class="token keyword">ON</span> object_name
<span class="token keyword">TO</span> user1<span class="token punctuation">,</span> <span class="token keyword">user</span> <span class="token number">2</span><span class="token punctuation">,</span> …<span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">REVOKE</span> privilege1<span class="token punctuation">,</span> privilege2<span class="token punctuation">,</span> …
<span class="token keyword">ON</span> object_name
<span class="token keyword">FROM</span> user1<span class="token punctuation">,</span> <span class="token keyword">user</span> <span class="token number">2</span><span class="token punctuation">,</span> …<span class="token punctuation">;</span>
</code></pre></div><h2 id="pl-sql"><a href="#pl-sql" aria-hidden="true" class="header-anchor">#</a> PL/SQL</h2><h2 id="asp-net"><a href="#asp-net" aria-hidden="true" class="header-anchor">#</a> ASP.NET</h2><h3 id="using-data-access-objects"><a href="#using-data-access-objects" aria-hidden="true" class="header-anchor">#</a> Using Data Access Objects</h3><p>A <strong>Employee</strong> class is created to represent one employee. The constructor for the class takes parameters representing the employee's data. The <strong>EmployeeDAO</strong> class is used to get a List<Employee> object representing all of the employees. This object is suitable to use as a data source for our GridView.</Employee></p><div class="language-c extra-class"><pre class="language-c"><code>EmployeeDAO employeeDAO <span class="token operator">=</span> new <span class="token function">EmployeeDAO</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
List<span class="token operator">&lt;</span>Employee<span class="token operator">&gt;</span> employees<span class="token punctuation">;</span>
employees <span class="token operator">=</span> employeeDAO<span class="token punctuation">.</span><span class="token function">LoadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gvEmp<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> employees<span class="token punctuation">;</span>
gvEmp<span class="token punctuation">.</span><span class="token function">DataBind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="using-gridview-drop-down-list-detailview-components-including-binding"><a href="#using-gridview-drop-down-list-detailview-components-including-binding" aria-hidden="true" class="header-anchor">#</a> Using GridView, Drop Down List, DetailView components (including binding)</h3><p><strong>GridView</strong> can used to display database data.</p><p>To populate the GridView, create a data table and fill it with the results of a SELECT statement. Then set the data table as the DataSource for the GridView and bind it.</p><div class="language-c extra-class"><pre class="language-c"><code>OracleConnection conn <span class="token operator">=</span> new <span class="token function">OracleConnection</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">&quot;Data Source=Neptune; User Id={0}; Password={1}&quot;</span><span class="token punctuation">,</span> txtUsername<span class="token punctuation">.</span>Text<span class="token punctuation">,</span> txtPassword<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
OracleCommand cmd <span class="token operator">=</span> new <span class="token function">OracleCommand</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT empno, ename, job, sal, comm, deptno FROM emp&quot;</span><span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
OracleDataAdapter da <span class="token operator">=</span> new <span class="token function">OracleDataAdapter</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
DataTable dt <span class="token operator">=</span> new <span class="token function">DataTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
da<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span>dt<span class="token punctuation">)</span><span class="token punctuation">;</span>
gvEmp<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> dt<span class="token punctuation">;</span>
gvEmp<span class="token punctuation">.</span><span class="token function">DataBind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="using-gridview-rowcommand-events"><a href="#using-gridview-rowcommand-events" aria-hidden="true" class="header-anchor">#</a> Using GridView RowCommand events</h3><p>The grid view's <strong>RowCommand</strong> event is invoked when the grid view's Edit button is clicked. The GridView can have more than one button. To distinguish which button is being pressed, check the event's CommandName property (from the <strong>GridViewCommandEventArgs</strong> object). The property value will match the CommandName property set for the button.
E.g.</p><div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;EDIT&quot;</span> <span class="token operator">==</span> e<span class="token punctuation">.</span>CommandName<span class="token punctuation">)</span>
</code></pre></div><p>When the user clicks the Edit button, the row corresponding to which edit button was clicked is sent to the event in the <strong>GridViewCommandEventArgs</strong> object's <strong>CommandArgument</strong> property.</p><h3 id="using-the-ispostback-property-in-the-pageload-event"><a href="#using-the-ispostback-property-in-the-pageload-event" aria-hidden="true" class="header-anchor">#</a> Using the IsPostBack property in the PageLoad event</h3><p>All events occur only when the form is sent back to the server (called <strong>Posting Back</strong> to the server).</p><p>Once all of the event code has run, the response page is constructed and sent back to the browser. This cycle is called a <strong>round trip</strong></p><p>.Initialization code is often added to the page's <strong>Load</strong> event. that the page's Load event occurs each time the page loads</p><p>If the initialization should only occur when the page first loads but not during user post back events, use the form's IsPostBack property to test for this.</p><div class="language-c extra-class"><pre class="language-c"><code>protected <span class="token keyword">void</span> <span class="token function">Page_Load</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span><span class="token punctuation">{</span>    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>IsPostBack<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="using-validators-and-the-isvalid-property"><a href="#using-validators-and-the-isvalid-property" aria-hidden="true" class="header-anchor">#</a> Using Validators and the IsValid property</h3><p>You can add a <strong>validator</strong> to the web form from the Validation section of the toolbox</p><p>Tie the validator to a web control using its <strong>ConstrolToValidate</strong> property.</p><p>Note that when using validators with a .NET 4.5 web application project you may get the error message:s</p><blockquote><p>WebForms UnobtrusiveValidationMode requires a ScriptResourceMapping for 'jquery'. Please add a ScriptResourceMapping named jquery(case-sensitive).</p></blockquote><p>To resolve the problem, open your Web.config file and add the code</p><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appSettings</span><span class="token punctuation">&gt;</span></span>    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ValidationSettings:UnobtrusiveValidationMode<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>None<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appSettings</span><span class="token punctuation">&gt;</span></span> 
</code></pre></div><p>just before the <code>&lt;/configuration&gt;</code> element.</p><p>If event code should only run if the validation was successful, the use the form's <strong>IsValid</strong> property to test the validation results. The function returns True only if all form validations were successful.</p><div class="language-c extra-class"><pre class="language-c"><code>
protected <span class="token keyword">void</span> <span class="token function">btnSubmit_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>IsValid<span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="using-url-encoded-parameters"><a href="#using-url-encoded-parameters" aria-hidden="true" class="header-anchor">#</a> Using URL-encoded parameters</h3><p>URL-encoded can used to pass data from previous page. To add a URL-encoded parameter, append <code>?name=value</code> to the URL of the desired page</p><div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> receiptNo<span class="token punctuation">;</span>
<span class="token comment">// 解析 url query</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">TryParse</span><span class="token punctuation">(</span>Request<span class="token punctuation">.</span>Params<span class="token punctuation">[</span><span class="token string">&quot;receiptno&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> out receiptNo<span class="token punctuation">)</span>
</code></pre></div><h3 id="page-transfers-server-transfer"><a href="#page-transfers-server-transfer" aria-hidden="true" class="header-anchor">#</a> Page Transfers (Server.Transfer)</h3><p><code>Server.Transfer(url)</code> is used to make an internal transfer to the desired page. The browser is unaware of the transfer and does not display the new URL in its address bar. This could be a bit confusing for the user in some instances but often is desirable.</p><div class="language-c extra-class"><pre class="language-c"><code>Server<span class="token punctuation">.</span><span class="token function">Transfer</span><span class="token punctuation">(</span><span class="token string">&quot;~/Birthday.aspx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="page-redirection-response-redirect"><a href="#page-redirection-response-redirect" aria-hidden="true" class="header-anchor">#</a> Page Redirection (Response.Redirect)</h3><p><code>Response.Redirect(url)</code> is used to send back a special redirection response to the browser. The browser will then send a new request for the new URL. This URL will then appear in the browser's address bar.</p><div class="language-c extra-class"><pre class="language-c"><code>Response<span class="token punctuation">.</span><span class="token function">Transfer</span><span class="token punctuation">(</span><span class="token string">&quot;~/Birthday.aspx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="retrieving-data-from-previous-page-controls"><a href="#retrieving-data-from-previous-page-controls" aria-hidden="true" class="header-anchor">#</a> Retrieving Data From Previous Page Controls</h3><p>After navigating to a new page using either server transfer or cross-page posting,
the controls of the previous page can still be accessed using the page's <strong>PreviousPage</strong> object.
Simply check first that this object is not null. Then any control from the previous page can be found using the <code>PreviousPage.FindControl</code> method.</p><div class="language-c extra-class"><pre class="language-c"><code>Calendar calBirthdate <span class="token operator">=</span> <span class="token punctuation">(</span>Calendar<span class="token punctuation">)</span>PreviousPage<span class="token punctuation">.</span><span class="token function">FindControl</span><span class="token punctuation">(</span><span class="token string">&quot;calBirthdate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
TextBox txtName <span class="token operator">=</span> <span class="token punctuation">(</span>TextBox<span class="token punctuation">)</span>PreviousPage<span class="token punctuation">.</span><span class="token function">FindControl</span><span class="token punctuation">(</span><span class="token string">&quot;txtName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>To retrieve public properties defined in the web form page, include the line</p><div class="language-html extra-class"><pre class="language-html"><code>&lt;%@ PreviousPageType VirtualPath=&quot;previous page name.aspx&quot;%&gt;
</code></pre></div><p>E.g:</p><div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- PREVIOUS PAGE IS HOME --&gt;</span>
&lt;%@ PreviousPageType VirtualPath=&quot;Home.aspx&quot;%&gt;
</code></pre></div><h3 id="creating-using-master-detail-pages"><a href="#creating-using-master-detail-pages" aria-hidden="true" class="header-anchor">#</a> Creating/Using master-detail pages</h3><p>A master/detail page allows a record to be selected in one data control and then have detail data related to the selected record displayed in another data control.</p><p>For example, selecting a department in one data control and then seeing a list of employees in that department in the other data control.</p><p>The master/detail page uses two data sources:</p><ul><li>one for the master records</li><li>one for the related detail records.</li></ul><p>Add a Drop Down List to the web form. Select the data source created above for its data source. Specify the DataTextField as DNAME and the DataValueField as DEPTNO.</p><p>Important! The DropDownList's <strong>AutoPostBack</strong> property is set to <code>True</code> so that the selection is sent to the server immediately when the selection is made.</p><div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>IsPostBack<span class="token punctuation">)</span> <span class="token comment">// Only populate the drop down if the request is not a postback request</span>
<span class="token punctuation">{</span>
    LoginInfo login <span class="token operator">=</span> <span class="token punctuation">(</span>LoginInfo<span class="token punctuation">)</span>Session<span class="token punctuation">[</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    DepartmentDAO departmentDAO <span class="token operator">=</span> new <span class="token function">DepartmentDAO</span><span class="token punctuation">(</span>login<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> login<span class="token punctuation">.</span>Password<span class="token punctuation">)</span><span class="token punctuation">;</span>

    ddlDept<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> departmentDAO<span class="token punctuation">.</span><span class="token function">LoadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ddlDept<span class="token punctuation">.</span>DataTextField <span class="token operator">=</span> <span class="token string">&quot;Dname&quot;</span><span class="token punctuation">;</span>
    ddlDept<span class="token punctuation">.</span>DataValueField <span class="token operator">=</span> <span class="token string">&quot;DeptNo&quot;</span><span class="token punctuation">;</span>
    ddlDept<span class="token punctuation">.</span><span class="token function">DataBind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Also, the first entry in the list is an invalid entry prompting the user to select a department. The property <code>AppendDataBoundItems</code> is set to <code>True</code> to allow the data bound items to be added after this item. It is, therefore, important to not add more items every time the page loads. So the page load event includes a condition to only populate the list if the request is not a postback request (a postback request occurs when you respond to the page by clicking on a button, or selecting an item in a list, etc.</p><p>When the <code>SelectedIndexChanged</code> event occurs, the value is retrieved and used to look up data corresponding to the master data selection and display it.</p><div class="language-C extra-class"><pre class="language-c"><code>protected <span class="token keyword">void</span> <span class="token function">ddlDept_SelectedIndexChanged</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    LoginInfo login <span class="token operator">=</span> <span class="token punctuation">(</span>LoginInfo<span class="token punctuation">)</span>Session<span class="token punctuation">[</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    EmployeeDAO employeeDAO <span class="token operator">=</span> new <span class="token function">EmployeeDAO</span><span class="token punctuation">(</span>login<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> login<span class="token punctuation">.</span>Password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> deptNo <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>ddlDept<span class="token punctuation">.</span>SelectedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span>Employee<span class="token operator">&gt;</span> employees <span class="token operator">=</span> employeeDAO<span class="token punctuation">.</span><span class="token function">FindByDepartmentNo</span><span class="token punctuation">(</span>deptNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    gvEmp<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> employees<span class="token punctuation">;</span>
    gvEmp<span class="token punctuation">.</span><span class="token function">DataBind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> employees<span class="token punctuation">.</span>Count<span class="token punctuation">)</span>
        lblNoEmployees<span class="token punctuation">.</span>Visible <span class="token operator">=</span> deptNo <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        lblNoEmployees<span class="token punctuation">.</span>Visible <span class="token operator">=</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Add a GridView control to the web form. Set its data source to the second (detail) data source.</p><h3 id="using-login-authentication-scheme-with-basepage"><a href="#using-login-authentication-scheme-with-basepage" aria-hidden="true" class="header-anchor">#</a> Using login authentication scheme (with BasePage)</h3><p>We want to force the user to log in before being able to view any pages.  To do that we can use inheritance: a base Web Form page is created from which all other pages that need authentication can inherit.</p><p>That is, in all future pages, change the clause:</p><div class="language-c# extra-class"><pre class="language-text"><code>public partial class Home : BasePage
</code></pre></div><p>assuming <strong>BasePage</strong> is the name of the WebForm used as the base page.</p><p>In the code of this base page, add</p><div class="language-c extra-class"><pre class="language-c"><code>protected override <span class="token keyword">void</span> <span class="token function">OnInit</span><span class="token punctuation">(</span>EventArgs e<span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
    base<span class="token punctuation">.</span><span class="token function">OnInit</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Context <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> Context<span class="token punctuation">.</span>Session <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> null <span class="token operator">==</span> Session<span class="token punctuation">[</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
       Response<span class="token punctuation">.</span><span class="token function">Redirect</span><span class="token punctuation">(</span><span class="token string">&quot;~/Login.aspx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre></div><p><img src="https://i.imgur.com/8D04AUB.jpg" alt="Capture"></p><p>The session item &quot;login&quot; will contain a <code>LoginInfo</code> object that is created by the <strong>login page</strong>.</p><p>To login, we will simply try to connect to the database using the given username and password. If the connection is successful, the user is authenticated. If the connection fails, we assume that either the username or password is invalid.</p><p>Login Page Code:</p><div class="language-c extra-class"><pre class="language-c"><code>protected <span class="token keyword">void</span> <span class="token function">btnLogin_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>IsValid<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        try
        <span class="token punctuation">{</span>
            LoginInfo loginInfo <span class="token operator">=</span> DatabaseHelper<span class="token punctuation">.</span><span class="token function">Login</span><span class="token punctuation">(</span>txtUserName<span class="token punctuation">.</span>Text<span class="token punctuation">,</span> txtPassword<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Session<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span> loginInfo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Save login information into session</span>
            Response<span class="token punctuation">.</span><span class="token function">Redirect</span><span class="token punctuation">(</span><span class="token string">&quot;~/Home.aspx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        catch <span class="token punctuation">(</span>Exception<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            lblInvalid<span class="token punctuation">.</span>Visible <span class="token operator">=</span> true<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Home Page Code:</p><div class="language-c extra-class"><pre class="language-c"><code>protected <span class="token keyword">void</span> <span class="token function">Page_Load</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    LoginInfo login <span class="token operator">=</span> <span class="token punctuation">(</span>LoginInfo<span class="token punctuation">)</span>Session<span class="token punctuation">[</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    EmployeeDAO employeeDAO <span class="token operator">=</span> new <span class="token function">EmployeeDAO</span><span class="token punctuation">(</span>login<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> login<span class="token punctuation">.</span>Password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    gvEmp<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> employeeDAO<span class="token punctuation">.</span><span class="token function">LoadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    gvEmp<span class="token punctuation">.</span><span class="token function">DataBind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

 protected <span class="token keyword">void</span> <span class="token function">btnLogout_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Session<span class="token punctuation">.</span><span class="token function">Abandon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Response<span class="token punctuation">.</span><span class="token function">Redirect</span><span class="token punctuation">(</span><span class="token string">&quot;~/Home.aspx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="using-command-parameters"><a href="#using-command-parameters" aria-hidden="true" class="header-anchor">#</a> Using Command Parameters</h3><div class="language-c extra-class"><pre class="language-c"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
OracleCommand cmd <span class="token operator">=</span> new <span class="token function">OracleCommand</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT first_name, last_name, amount FROM donations WHERE receipt_no = :receiptNo&quot;</span><span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
cmd<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">&quot;:receiptNo&quot;</span><span class="token punctuation">,</span> receiptNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="executing-insert-update-and-delete-statements-from-asp-net"><a href="#executing-insert-update-and-delete-statements-from-asp-net" aria-hidden="true" class="header-anchor">#</a> Executing INSERT, UPDATE, and DELETE statements from ASP.NET</h3><p>直接去看代码吧.</p><h3 id="sequences"><a href="#sequences" aria-hidden="true" class="header-anchor">#</a> Sequences</h3><h4 id="creating-sequences"><a href="#creating-sequences" aria-hidden="true" class="header-anchor">#</a> Creating Sequences:</h4><p>A sequence is a database object that can be used to create unique surrogate key values.  A sequence can be created using the <code>CREATE SEQUENCE</code> statement.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> SEQUENCE receipt_no_sequence
   <span class="token keyword">START</span> <span class="token keyword">WITH</span> <span class="token number">1290</span>
   INCREMENT <span class="token keyword">BY</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><p>If START WITH is not specified, the default is 1. If INCREMENT BY is not specified, the default is 1.</p><h4 id="using-sequences"><a href="#using-sequences" aria-hidden="true" class="header-anchor">#</a> Using Sequences</h4><p>To retrieve the next value in a sequence, reference the <code>NEXTVAL</code> pseudocolumn</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> donations <span class="token punctuation">(</span>receipt_no<span class="token punctuation">,</span> first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> amount<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>receipt_no_sequence<span class="token punctuation">.</span>NEXTVAL<span class="token punctuation">,</span> <span class="token string">'Kevin'</span><span class="token punctuation">,</span> <span class="token string">'Dunn'</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>the <code>CURRVAL</code> pseudocolumn to get the last generated sequence value on the connection. This is useful when inserting foreign key values when the primary key value was generated with the sequence.
E.g.:</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> SEQUENCE make_id_sequence
   <span class="token keyword">START</span> <span class="token keyword">WITH</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> makes <span class="token punctuation">(</span>make_id<span class="token punctuation">,</span> make<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>make_id_sequence<span class="token punctuation">.</span>NEXTVAL<span class="token punctuation">,</span> <span class="token string">'Infinity'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> models <span class="token punctuation">(</span>make_id<span class="token punctuation">,</span> model<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>make_id_sequence<span class="token punctuation">.</span>CURRVAL<span class="token punctuation">,</span> <span class="token string">'G35 Sedan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> makes <span class="token punctuation">(</span>make_id<span class="token punctuation">,</span> make<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>make_id_sequence<span class="token punctuation">.</span>NEXTVAL<span class="token punctuation">,</span> <span class="token string">'Jaguar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> models <span class="token punctuation">(</span>make_id<span class="token punctuation">,</span> model<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>make_id_sequence<span class="token punctuation">.</span>CURRVAL<span class="token punctuation">,</span> <span class="token string">'2005 XJR'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> makes <span class="token punctuation">(</span>make_id<span class="token punctuation">,</span> make<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>make_id_sequence<span class="token punctuation">.</span>NEXTVAL<span class="token punctuation">,</span> <span class="token string">'Lexus'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> models <span class="token punctuation">(</span>make_id<span class="token punctuation">,</span> model<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>make_id_sequence<span class="token punctuation">.</span>CURRVAL<span class="token punctuation">,</span> <span class="token string">'GS 300 AWD'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> models <span class="token punctuation">(</span>make_id<span class="token punctuation">,</span> model<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>make_id_sequence<span class="token punctuation">.</span>CURRVAL<span class="token punctuation">,</span> <span class="token string">'LS 430'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> makes <span class="token punctuation">(</span>make_id<span class="token punctuation">,</span> make<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>make_id_sequence<span class="token punctuation">.</span>NEXTVAL<span class="token punctuation">,</span> <span class="token string">'Mercedes Benz'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="deleting-sequences"><a href="#deleting-sequences" aria-hidden="true" class="header-anchor">#</a> Deleting Sequences</h4><p>To delete a sequence object, use the <code>DROP SEQUENCE</code> statement.</p><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> SEQUENCE receipt_no_sequence<span class="token punctuation">;</span>
</code></pre></div></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/front-end-notebook/assets/js/15.359570c3.js" defer></script><script src="/front-end-notebook/assets/js/app.645ef008.js" defer></script>
  </body>
</html>
