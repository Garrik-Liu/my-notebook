<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用 MongoDB 数据库 | Garrik 的笔记</title>
    <meta name="description" content="这里是 Garrik 的前端笔记本">
    
    
    <link rel="preload" href="/my-notebook/assets/css/0.styles.150b63c7.css" as="style"><link rel="preload" href="/my-notebook/assets/js/app.56630d74.js" as="script"><link rel="preload" href="/my-notebook/assets/js/2.a47e0c14.js" as="script"><link rel="preload" href="/my-notebook/assets/js/13.81ec0ed6.js" as="script"><link rel="prefetch" href="/my-notebook/assets/js/10.b6f0f8ff.js"><link rel="prefetch" href="/my-notebook/assets/js/100.bc1cdd8d.js"><link rel="prefetch" href="/my-notebook/assets/js/101.609018cd.js"><link rel="prefetch" href="/my-notebook/assets/js/102.4250a92a.js"><link rel="prefetch" href="/my-notebook/assets/js/103.fd8e3897.js"><link rel="prefetch" href="/my-notebook/assets/js/104.11caeff6.js"><link rel="prefetch" href="/my-notebook/assets/js/105.27477e59.js"><link rel="prefetch" href="/my-notebook/assets/js/106.be2a28a8.js"><link rel="prefetch" href="/my-notebook/assets/js/107.f44f8a04.js"><link rel="prefetch" href="/my-notebook/assets/js/108.7801414a.js"><link rel="prefetch" href="/my-notebook/assets/js/109.d9e5a443.js"><link rel="prefetch" href="/my-notebook/assets/js/11.46afa721.js"><link rel="prefetch" href="/my-notebook/assets/js/110.586e454e.js"><link rel="prefetch" href="/my-notebook/assets/js/111.7b9b6e3b.js"><link rel="prefetch" href="/my-notebook/assets/js/112.abe68a77.js"><link rel="prefetch" href="/my-notebook/assets/js/113.88535132.js"><link rel="prefetch" href="/my-notebook/assets/js/114.bfb4b547.js"><link rel="prefetch" href="/my-notebook/assets/js/115.9227e4b1.js"><link rel="prefetch" href="/my-notebook/assets/js/116.3a878076.js"><link rel="prefetch" href="/my-notebook/assets/js/117.ff2a34e6.js"><link rel="prefetch" href="/my-notebook/assets/js/118.8425d334.js"><link rel="prefetch" href="/my-notebook/assets/js/119.ff0a16ee.js"><link rel="prefetch" href="/my-notebook/assets/js/12.2016419f.js"><link rel="prefetch" href="/my-notebook/assets/js/120.02d3b634.js"><link rel="prefetch" href="/my-notebook/assets/js/121.72f38d01.js"><link rel="prefetch" href="/my-notebook/assets/js/122.4d56d16e.js"><link rel="prefetch" href="/my-notebook/assets/js/123.f34b99f8.js"><link rel="prefetch" href="/my-notebook/assets/js/124.bf7a5567.js"><link rel="prefetch" href="/my-notebook/assets/js/125.1e6bbeba.js"><link rel="prefetch" href="/my-notebook/assets/js/126.8e2f13ae.js"><link rel="prefetch" href="/my-notebook/assets/js/127.2ae5e5cf.js"><link rel="prefetch" href="/my-notebook/assets/js/128.10702778.js"><link rel="prefetch" href="/my-notebook/assets/js/129.edd38d14.js"><link rel="prefetch" href="/my-notebook/assets/js/130.1c755c89.js"><link rel="prefetch" href="/my-notebook/assets/js/131.dc85b9b4.js"><link rel="prefetch" href="/my-notebook/assets/js/132.be8bca4e.js"><link rel="prefetch" href="/my-notebook/assets/js/133.7e49eca1.js"><link rel="prefetch" href="/my-notebook/assets/js/134.5adbb70b.js"><link rel="prefetch" href="/my-notebook/assets/js/135.ba99a3da.js"><link rel="prefetch" href="/my-notebook/assets/js/136.390be14f.js"><link rel="prefetch" href="/my-notebook/assets/js/137.81da6208.js"><link rel="prefetch" href="/my-notebook/assets/js/138.603b5643.js"><link rel="prefetch" href="/my-notebook/assets/js/139.2de5811f.js"><link rel="prefetch" href="/my-notebook/assets/js/14.fbf1f207.js"><link rel="prefetch" href="/my-notebook/assets/js/140.47f8ee8f.js"><link rel="prefetch" href="/my-notebook/assets/js/141.981862de.js"><link rel="prefetch" href="/my-notebook/assets/js/142.a0fadd22.js"><link rel="prefetch" href="/my-notebook/assets/js/143.182b53e0.js"><link rel="prefetch" href="/my-notebook/assets/js/144.9ea5ee42.js"><link rel="prefetch" href="/my-notebook/assets/js/145.31ed0f17.js"><link rel="prefetch" href="/my-notebook/assets/js/146.16d31ef7.js"><link rel="prefetch" href="/my-notebook/assets/js/147.05dc046c.js"><link rel="prefetch" href="/my-notebook/assets/js/148.d2a50c83.js"><link rel="prefetch" href="/my-notebook/assets/js/149.81748c70.js"><link rel="prefetch" href="/my-notebook/assets/js/15.77c9d8b1.js"><link rel="prefetch" href="/my-notebook/assets/js/150.6ba54ccd.js"><link rel="prefetch" href="/my-notebook/assets/js/151.15193456.js"><link rel="prefetch" href="/my-notebook/assets/js/152.358624fe.js"><link rel="prefetch" href="/my-notebook/assets/js/153.c29ac1de.js"><link rel="prefetch" href="/my-notebook/assets/js/154.38504b18.js"><link rel="prefetch" href="/my-notebook/assets/js/155.a0725dd5.js"><link rel="prefetch" href="/my-notebook/assets/js/156.e4a98ec9.js"><link rel="prefetch" href="/my-notebook/assets/js/157.40c551d9.js"><link rel="prefetch" href="/my-notebook/assets/js/158.ee678526.js"><link rel="prefetch" href="/my-notebook/assets/js/159.4217cdbd.js"><link rel="prefetch" href="/my-notebook/assets/js/16.6a015e2e.js"><link rel="prefetch" href="/my-notebook/assets/js/160.f5269748.js"><link rel="prefetch" href="/my-notebook/assets/js/161.bd5ab3bd.js"><link rel="prefetch" href="/my-notebook/assets/js/162.429df4b7.js"><link rel="prefetch" href="/my-notebook/assets/js/163.c3332a4f.js"><link rel="prefetch" href="/my-notebook/assets/js/164.e6f5060e.js"><link rel="prefetch" href="/my-notebook/assets/js/165.326235b0.js"><link rel="prefetch" href="/my-notebook/assets/js/166.893df272.js"><link rel="prefetch" href="/my-notebook/assets/js/167.00a994cf.js"><link rel="prefetch" href="/my-notebook/assets/js/168.df61cd27.js"><link rel="prefetch" href="/my-notebook/assets/js/169.75dc1328.js"><link rel="prefetch" href="/my-notebook/assets/js/17.3ed1ef48.js"><link rel="prefetch" href="/my-notebook/assets/js/170.4aa0a8da.js"><link rel="prefetch" href="/my-notebook/assets/js/171.34032db7.js"><link rel="prefetch" href="/my-notebook/assets/js/172.8f871018.js"><link rel="prefetch" href="/my-notebook/assets/js/173.b6829480.js"><link rel="prefetch" href="/my-notebook/assets/js/174.ffd7d583.js"><link rel="prefetch" href="/my-notebook/assets/js/175.8f8cd415.js"><link rel="prefetch" href="/my-notebook/assets/js/176.ba16e9b2.js"><link rel="prefetch" href="/my-notebook/assets/js/177.ce052b1b.js"><link rel="prefetch" href="/my-notebook/assets/js/178.d255d8df.js"><link rel="prefetch" href="/my-notebook/assets/js/179.5233addb.js"><link rel="prefetch" href="/my-notebook/assets/js/18.482dad08.js"><link rel="prefetch" href="/my-notebook/assets/js/180.1aa42048.js"><link rel="prefetch" href="/my-notebook/assets/js/181.3d70a417.js"><link rel="prefetch" href="/my-notebook/assets/js/182.cfc7fc33.js"><link rel="prefetch" href="/my-notebook/assets/js/183.7ab0d847.js"><link rel="prefetch" href="/my-notebook/assets/js/184.06c9433d.js"><link rel="prefetch" href="/my-notebook/assets/js/185.185b550d.js"><link rel="prefetch" href="/my-notebook/assets/js/186.56b5421c.js"><link rel="prefetch" href="/my-notebook/assets/js/187.c7a1a1f6.js"><link rel="prefetch" href="/my-notebook/assets/js/188.1f8f710f.js"><link rel="prefetch" href="/my-notebook/assets/js/189.f06487aa.js"><link rel="prefetch" href="/my-notebook/assets/js/19.c0cfe5c3.js"><link rel="prefetch" href="/my-notebook/assets/js/190.8733dc1b.js"><link rel="prefetch" href="/my-notebook/assets/js/191.6857a469.js"><link rel="prefetch" href="/my-notebook/assets/js/192.c0cf9966.js"><link rel="prefetch" href="/my-notebook/assets/js/193.e92cf89d.js"><link rel="prefetch" href="/my-notebook/assets/js/194.47a3f97d.js"><link rel="prefetch" href="/my-notebook/assets/js/195.a88224c2.js"><link rel="prefetch" href="/my-notebook/assets/js/196.11f229bc.js"><link rel="prefetch" href="/my-notebook/assets/js/197.165e5d93.js"><link rel="prefetch" href="/my-notebook/assets/js/198.d5466657.js"><link rel="prefetch" href="/my-notebook/assets/js/199.566b6f2d.js"><link rel="prefetch" href="/my-notebook/assets/js/20.4298c4a2.js"><link rel="prefetch" href="/my-notebook/assets/js/200.0a793668.js"><link rel="prefetch" href="/my-notebook/assets/js/201.ea60cd5b.js"><link rel="prefetch" href="/my-notebook/assets/js/202.4077492a.js"><link rel="prefetch" href="/my-notebook/assets/js/203.5473c9a0.js"><link rel="prefetch" href="/my-notebook/assets/js/204.d2cdb2ad.js"><link rel="prefetch" href="/my-notebook/assets/js/205.e65c36b9.js"><link rel="prefetch" href="/my-notebook/assets/js/206.402c73a5.js"><link rel="prefetch" href="/my-notebook/assets/js/207.5c18d40b.js"><link rel="prefetch" href="/my-notebook/assets/js/208.c25f3be7.js"><link rel="prefetch" href="/my-notebook/assets/js/209.e5f1a1a2.js"><link rel="prefetch" href="/my-notebook/assets/js/21.30975311.js"><link rel="prefetch" href="/my-notebook/assets/js/210.f62b46c7.js"><link rel="prefetch" href="/my-notebook/assets/js/211.2d679940.js"><link rel="prefetch" href="/my-notebook/assets/js/212.99bf58f1.js"><link rel="prefetch" href="/my-notebook/assets/js/213.cbc7587b.js"><link rel="prefetch" href="/my-notebook/assets/js/214.a734434e.js"><link rel="prefetch" href="/my-notebook/assets/js/215.d77b548d.js"><link rel="prefetch" href="/my-notebook/assets/js/216.f4980445.js"><link rel="prefetch" href="/my-notebook/assets/js/217.598a8a57.js"><link rel="prefetch" href="/my-notebook/assets/js/218.8f0fafb9.js"><link rel="prefetch" href="/my-notebook/assets/js/219.c8367d6c.js"><link rel="prefetch" href="/my-notebook/assets/js/22.1a72dd24.js"><link rel="prefetch" href="/my-notebook/assets/js/220.19e66b2b.js"><link rel="prefetch" href="/my-notebook/assets/js/221.c63a4d42.js"><link rel="prefetch" href="/my-notebook/assets/js/222.39eeb0e8.js"><link rel="prefetch" href="/my-notebook/assets/js/223.c16d9688.js"><link rel="prefetch" href="/my-notebook/assets/js/224.3020ff0d.js"><link rel="prefetch" href="/my-notebook/assets/js/225.345d0d6c.js"><link rel="prefetch" href="/my-notebook/assets/js/226.21136b31.js"><link rel="prefetch" href="/my-notebook/assets/js/227.a116429b.js"><link rel="prefetch" href="/my-notebook/assets/js/228.d2148bf3.js"><link rel="prefetch" href="/my-notebook/assets/js/229.f5a78400.js"><link rel="prefetch" href="/my-notebook/assets/js/23.df9031dd.js"><link rel="prefetch" href="/my-notebook/assets/js/230.a6b58383.js"><link rel="prefetch" href="/my-notebook/assets/js/231.0b124c8d.js"><link rel="prefetch" href="/my-notebook/assets/js/232.d635ec44.js"><link rel="prefetch" href="/my-notebook/assets/js/233.c6f2dea5.js"><link rel="prefetch" href="/my-notebook/assets/js/234.56db351c.js"><link rel="prefetch" href="/my-notebook/assets/js/235.81dc9a2a.js"><link rel="prefetch" href="/my-notebook/assets/js/236.ef52804d.js"><link rel="prefetch" href="/my-notebook/assets/js/237.5a4245a9.js"><link rel="prefetch" href="/my-notebook/assets/js/238.bebb1624.js"><link rel="prefetch" href="/my-notebook/assets/js/239.09a2a061.js"><link rel="prefetch" href="/my-notebook/assets/js/24.37a9e322.js"><link rel="prefetch" href="/my-notebook/assets/js/240.d75e53e7.js"><link rel="prefetch" href="/my-notebook/assets/js/241.4e0da60a.js"><link rel="prefetch" href="/my-notebook/assets/js/242.14ea4fe4.js"><link rel="prefetch" href="/my-notebook/assets/js/243.b28eab94.js"><link rel="prefetch" href="/my-notebook/assets/js/244.7b1e0f7f.js"><link rel="prefetch" href="/my-notebook/assets/js/245.18687193.js"><link rel="prefetch" href="/my-notebook/assets/js/246.8202b7f5.js"><link rel="prefetch" href="/my-notebook/assets/js/247.3ddfac13.js"><link rel="prefetch" href="/my-notebook/assets/js/248.75c33eef.js"><link rel="prefetch" href="/my-notebook/assets/js/249.611fd232.js"><link rel="prefetch" href="/my-notebook/assets/js/25.0b3340b0.js"><link rel="prefetch" href="/my-notebook/assets/js/250.c118656e.js"><link rel="prefetch" href="/my-notebook/assets/js/251.2dfc994b.js"><link rel="prefetch" href="/my-notebook/assets/js/252.3633fb9a.js"><link rel="prefetch" href="/my-notebook/assets/js/253.688eb234.js"><link rel="prefetch" href="/my-notebook/assets/js/254.ed06cbd1.js"><link rel="prefetch" href="/my-notebook/assets/js/255.b9861558.js"><link rel="prefetch" href="/my-notebook/assets/js/256.4e17d47b.js"><link rel="prefetch" href="/my-notebook/assets/js/257.b57b7e5a.js"><link rel="prefetch" href="/my-notebook/assets/js/258.39735145.js"><link rel="prefetch" href="/my-notebook/assets/js/259.2f493d0b.js"><link rel="prefetch" href="/my-notebook/assets/js/26.99ef3965.js"><link rel="prefetch" href="/my-notebook/assets/js/260.8529f476.js"><link rel="prefetch" href="/my-notebook/assets/js/261.9af84351.js"><link rel="prefetch" href="/my-notebook/assets/js/262.b4354521.js"><link rel="prefetch" href="/my-notebook/assets/js/263.4235431c.js"><link rel="prefetch" href="/my-notebook/assets/js/264.7c2e314a.js"><link rel="prefetch" href="/my-notebook/assets/js/265.e4101e22.js"><link rel="prefetch" href="/my-notebook/assets/js/266.d60232d3.js"><link rel="prefetch" href="/my-notebook/assets/js/267.95af1e2f.js"><link rel="prefetch" href="/my-notebook/assets/js/268.0ba276ba.js"><link rel="prefetch" href="/my-notebook/assets/js/269.d4fddbb7.js"><link rel="prefetch" href="/my-notebook/assets/js/27.4c6405ff.js"><link rel="prefetch" href="/my-notebook/assets/js/270.97b22754.js"><link rel="prefetch" href="/my-notebook/assets/js/271.4ee0bff6.js"><link rel="prefetch" href="/my-notebook/assets/js/272.b42bb668.js"><link rel="prefetch" href="/my-notebook/assets/js/28.c8612ab7.js"><link rel="prefetch" href="/my-notebook/assets/js/29.c7732f28.js"><link rel="prefetch" href="/my-notebook/assets/js/3.db75fba4.js"><link rel="prefetch" href="/my-notebook/assets/js/30.0d2b8590.js"><link rel="prefetch" href="/my-notebook/assets/js/31.82573e3a.js"><link rel="prefetch" href="/my-notebook/assets/js/32.5f8c7b02.js"><link rel="prefetch" href="/my-notebook/assets/js/33.b9f2814f.js"><link rel="prefetch" href="/my-notebook/assets/js/34.d255e38e.js"><link rel="prefetch" href="/my-notebook/assets/js/35.96c580ef.js"><link rel="prefetch" href="/my-notebook/assets/js/36.3bf3a2e9.js"><link rel="prefetch" href="/my-notebook/assets/js/37.e4bdabe1.js"><link rel="prefetch" href="/my-notebook/assets/js/38.f106b4e6.js"><link rel="prefetch" href="/my-notebook/assets/js/39.ab338408.js"><link rel="prefetch" href="/my-notebook/assets/js/4.7f75b373.js"><link rel="prefetch" href="/my-notebook/assets/js/40.103825ba.js"><link rel="prefetch" href="/my-notebook/assets/js/41.ceeb8092.js"><link rel="prefetch" href="/my-notebook/assets/js/42.d6d5275a.js"><link rel="prefetch" href="/my-notebook/assets/js/43.3117608e.js"><link rel="prefetch" href="/my-notebook/assets/js/44.00e7f729.js"><link rel="prefetch" href="/my-notebook/assets/js/45.475c0bd0.js"><link rel="prefetch" href="/my-notebook/assets/js/46.3534582c.js"><link rel="prefetch" href="/my-notebook/assets/js/47.0acd6690.js"><link rel="prefetch" href="/my-notebook/assets/js/48.a93a1ce1.js"><link rel="prefetch" href="/my-notebook/assets/js/49.f6fbc621.js"><link rel="prefetch" href="/my-notebook/assets/js/5.977f0fd9.js"><link rel="prefetch" href="/my-notebook/assets/js/50.35ec8de9.js"><link rel="prefetch" href="/my-notebook/assets/js/51.0371f0be.js"><link rel="prefetch" href="/my-notebook/assets/js/52.6f6953e8.js"><link rel="prefetch" href="/my-notebook/assets/js/53.6f4facb8.js"><link rel="prefetch" href="/my-notebook/assets/js/54.7dda1381.js"><link rel="prefetch" href="/my-notebook/assets/js/55.a0300b14.js"><link rel="prefetch" href="/my-notebook/assets/js/56.dc0f627c.js"><link rel="prefetch" href="/my-notebook/assets/js/57.6ed85acd.js"><link rel="prefetch" href="/my-notebook/assets/js/58.ef15188e.js"><link rel="prefetch" href="/my-notebook/assets/js/59.a7841683.js"><link rel="prefetch" href="/my-notebook/assets/js/6.fb3af5c1.js"><link rel="prefetch" href="/my-notebook/assets/js/60.a66bc438.js"><link rel="prefetch" href="/my-notebook/assets/js/61.9f8bcc2d.js"><link rel="prefetch" href="/my-notebook/assets/js/62.e4ff68fa.js"><link rel="prefetch" href="/my-notebook/assets/js/63.4912153b.js"><link rel="prefetch" href="/my-notebook/assets/js/64.7768eacc.js"><link rel="prefetch" href="/my-notebook/assets/js/65.aac52d82.js"><link rel="prefetch" href="/my-notebook/assets/js/66.8bc5fa28.js"><link rel="prefetch" href="/my-notebook/assets/js/67.58955c29.js"><link rel="prefetch" href="/my-notebook/assets/js/68.0a0aaa93.js"><link rel="prefetch" href="/my-notebook/assets/js/69.8494ecd0.js"><link rel="prefetch" href="/my-notebook/assets/js/7.e710c845.js"><link rel="prefetch" href="/my-notebook/assets/js/70.59415303.js"><link rel="prefetch" href="/my-notebook/assets/js/71.139c0916.js"><link rel="prefetch" href="/my-notebook/assets/js/72.d30b2a1e.js"><link rel="prefetch" href="/my-notebook/assets/js/73.37151e92.js"><link rel="prefetch" href="/my-notebook/assets/js/74.c958147a.js"><link rel="prefetch" href="/my-notebook/assets/js/75.09a28e19.js"><link rel="prefetch" href="/my-notebook/assets/js/76.ca1fd2a9.js"><link rel="prefetch" href="/my-notebook/assets/js/77.4668a7ee.js"><link rel="prefetch" href="/my-notebook/assets/js/78.3262a71f.js"><link rel="prefetch" href="/my-notebook/assets/js/79.e1ccd0a6.js"><link rel="prefetch" href="/my-notebook/assets/js/8.6fb90ebe.js"><link rel="prefetch" href="/my-notebook/assets/js/80.dfce9e28.js"><link rel="prefetch" href="/my-notebook/assets/js/81.007f9b65.js"><link rel="prefetch" href="/my-notebook/assets/js/82.52a6e4c1.js"><link rel="prefetch" href="/my-notebook/assets/js/83.ac285611.js"><link rel="prefetch" href="/my-notebook/assets/js/84.2a928956.js"><link rel="prefetch" href="/my-notebook/assets/js/85.2331bc95.js"><link rel="prefetch" href="/my-notebook/assets/js/86.8b5ebe40.js"><link rel="prefetch" href="/my-notebook/assets/js/87.e215beee.js"><link rel="prefetch" href="/my-notebook/assets/js/88.03957820.js"><link rel="prefetch" href="/my-notebook/assets/js/89.66162f61.js"><link rel="prefetch" href="/my-notebook/assets/js/9.d495ab91.js"><link rel="prefetch" href="/my-notebook/assets/js/90.bc83eb83.js"><link rel="prefetch" href="/my-notebook/assets/js/91.371a8688.js"><link rel="prefetch" href="/my-notebook/assets/js/92.90bbc707.js"><link rel="prefetch" href="/my-notebook/assets/js/93.775d5d97.js"><link rel="prefetch" href="/my-notebook/assets/js/94.18f233ca.js"><link rel="prefetch" href="/my-notebook/assets/js/95.a0d75e25.js"><link rel="prefetch" href="/my-notebook/assets/js/96.4c59cbd8.js"><link rel="prefetch" href="/my-notebook/assets/js/97.35d938d8.js"><link rel="prefetch" href="/my-notebook/assets/js/98.997e16e3.js"><link rel="prefetch" href="/my-notebook/assets/js/99.8e7a3f7e.js">
    <link rel="stylesheet" href="/my-notebook/assets/css/0.styles.150b63c7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-notebook/" class="home-link router-link-active"><!----> <span class="site-name">Garrik 的笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-notebook/" class="nav-link">主页</a></div><div class="nav-item"><a href="https://github.com/Garrik-Liu/my-notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-notebook/" class="nav-link">主页</a></div><div class="nav-item"><a href="https://github.com/Garrik-Liu/my-notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>使用 MongoDB 数据库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#什么是-mongodb" class="sidebar-link">什么是 MongoDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#关系型数据库-非关系型数据库" class="sidebar-link">关系型数据库 &amp; 非关系型数据库</a></li></ul></li><li><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#mongodb-基础概念" class="sidebar-link">MongoDB 基础概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#文档-document" class="sidebar-link">文档 (document)</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#集合-collection" class="sidebar-link">集合 (collection)</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#数据库-database" class="sidebar-link">数据库 (database)</a></li></ul></li><li><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#安装-mongodb-可视化工具" class="sidebar-link">安装 MongoDB &amp; 可视化工具</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#在-node-js-中使用-mongodb" class="sidebar-link">在 Node.js 中使用 MongoDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#连接数据库" class="sidebar-link">连接数据库</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#插入文档" class="sidebar-link">插入文档</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#查询全部文档" class="sidebar-link">查询全部文档</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#查询特定文档" class="sidebar-link">查询特定文档</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#更新文档" class="sidebar-link">更新文档</a></li><li class="sidebar-sub-header"><a href="/my-notebook/%E4%B8%AA%E4%BA%BA%E5%BF%83%E5%BE%97/%E5%89%8D%E7%AB%AF%E6%95%99%E7%A8%8B/NodeJs/%E5%85%A5%E9%97%A8%E7%AF%87/%E4%BD%BF%E7%94%A8MongoDB%E6%95%B0%E6%8D%AE%E5%BA%93.html#删除文档" class="sidebar-link">删除文档</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="使用-mongodb-数据库"><a href="#使用-mongodb-数据库" class="header-anchor">#</a> 使用 MongoDB 数据库</h1> <p>在这一节让我们开始学着在 Node.js 中使用 MongoDB 数据库.</p> <h2 id="什么是-mongodb"><a href="#什么是-mongodb" class="header-anchor">#</a> 什么是 MongoDB</h2> <p>『 MongoDB 』 是由 C++ 语言编写的, 基于分布式文件存储的数据库. 属于 NoSql (非关系型数据库) 的一种, 旨在为 WEB 应用提供可扩展的高性能数据存储解决方案.</p> <p>MongoDB 将数据存储为一个文档，<strong>数据结构由键值对 <code>key:value</code> 组成.  MongoDB 文档类似于 JSON 对象.</strong>  字段值可以包含其他文档，数组及文档数组.</p> <p>下面就是一个 MongoDB 文档 (document) 示例:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Garrik&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>
    <span class="token property">&quot;gender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Male&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;job&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Frontend Developer&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="关系型数据库-非关系型数据库"><a href="#关系型数据库-非关系型数据库" class="header-anchor">#</a> 关系型数据库 &amp; 非关系型数据库</h3> <p>前面说到 MongoDB 是属于非关系型数据库的一种, 那么什么是关系型? 什么是非关系型?</p> <p>『 <strong>关系型数据库</strong> 』以 &quot;行&quot; 和 &quot;列&quot; 组成的 &quot;二维表格&quot; 形式来存储数据, 二维表格简称为称为表, 表又组成了数据库.  之所以称之为关系型数据库, 因为表与表之间采用了现实世界中实体 (entitiy) 与实体 (entitiy) 之间的关系模型.  表中存储格式化结构的数据，每个 &quot;元组&quot;（可以理解为二维表中的一行）的字段组成都是一样的.  即使不是每个元组都需要所有的字段，但数据库会为每个元组都分配所有的字段，这样的结构可以便于表与表之间进行连接等操作.  比较常见的关系型数据库有 Oracle, MySQL 等.</p> <p>『 <strong>非关系数据库</strong> 』以 &quot;键值对&quot; 存储，它的结构不固定，每一个元组可以有不一样的字段，可以根据需要增加或减少一些自己的键值对，不会局限于固定的结构.  数据之间的关联性不强制, 使用起来要比关系型数据库更加灵活, 性能也有提升.  比较常见的非关系型数据库有  MongoDB, Redis 等</p> <h2 id="mongodb-基础概念"><a href="#mongodb-基础概念" class="header-anchor">#</a> MongoDB 基础概念</h2> <p>在具体讲如何使用 MongoDB 之前, 我要先介绍一些基本概念.</p> <h3 id="文档-document"><a href="#文档-document" class="header-anchor">#</a> 文档 (document)</h3> <p>『 <strong>文档</strong> 』是一组 &quot;键值对&quot; 的有序集合.  是 MongoDB 的核心概念.  文档的数据结构被称为 BSON, 是一种类似于 JSON 的二进制形式的存储格式.  下面是一个文档示例:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Garrik&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">21</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>&quot;name&quot;</code> 和 <code>&quot;age&quot;</code> 是这个文档的 &quot;键&quot; (key), <code>&quot;Garrik&quot;</code> 和 <code>21</code> 是 &quot;值&quot; (value)</p> <p>文档中的值可以是多种不同的数据类型. 在一个集合中各个文档不需要设置相同的字段，并且相同的字段不需要相同的数据类型.</p> <p>MongoDB 区分类型和大小写. 例如，下面的两个文档是不同的：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;foo&quot;</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;Foo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>在给文档的 &quot;键&quot; 命名时还需要注意:</p> <ul><li>文档的键必须是字符串</li> <li>键不能含有 <code>\0</code> (空字符)。这个字符用来表示键的结尾</li> <li><code>.</code> 和 <code>$</code> 有特别的意义，只有在特定环境下才能使用</li> <li>以下划线 <code>_</code>开头的键是保留的 (不是严格要求的)</li> <li>一个文档内不能有重复的键</li></ul> <h3 id="集合-collection"><a href="#集合-collection" class="header-anchor">#</a> 集合 (collection)</h3> <p>『 <strong>集合</strong> 』就是一组文档，如果将 MongoDB 中的一个文档比喻为关系型数据库中的一行，那么一个集合就相当于一张表.  集合存在于数据库中，当第一个文档插入时，集合就会被创建.  集合没有固定的结构，一个集合里面的文档可以是各式各样的，这被称为 『 动态模式 』</p> <p>下面是一个集合示例:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;site&quot;</span><span class="token operator">:</span> <span class="token string">&quot;www.baidu.com&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;百度&quot;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;site&quot;</span><span class="token operator">:</span> <span class="token string">&quot;www.google.com&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Google&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;search&quot;</span><span class="token operator">:</span> <span class="token string">&quot;前端开发&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;site&quot;</span><span class="token operator">:</span> <span class="token string">&quot;www.zhihu.com&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;知乎&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;罐装汽水_Garrik&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>虽然 MongoDB 对集合中的文档类型没有要求, 但通常情况下我们插入集合的数据都会有一定的关联性.  这样会降低查询特定文档的复杂度, 并且提升查询速度.</p> <p>集合命名时需要注意:</p> <ul><li>集合名不能是空字符串。</li> <li>集合名不能含有 <code>\0</code>（空字符)，这个字符表示集合名的结尾。</li> <li>集合名不能以 <code>system.</code> 开头，这是为系统集合保留的前缀。</li> <li>用户创建的集合名字不能含有保留字符 <code>$</code>。</li></ul> <h3 id="数据库-database"><a href="#数据库-database" class="header-anchor">#</a> 数据库 (database)</h3> <p>『 <strong>数据库</strong> 』由多个集合组成.  在 MongoDB 中可以建立多个数据库。每个数据库都有独立的权限，即便是在磁盘上，不同的数据库也放置在不同的文件中。按照经验，我们将有关一个应用程序的所有数据都存储在同一个数据库中。要想在同一个 MongoDB 服务器上存放多个应用程序或者用户的数据，就需要使用不同的数据库。</p> <p>MongoDB 的默认数据库为 <code>&quot;db&quot;</code>，该数据库存储在 <code>data</code> 目录中。</p> <p>数据库名可以是满足以下条件的任意 UTF-8 字符串:</p> <ul><li>不是空字符串</li> <li>不得含有 <code>空格</code>、<code>.</code>、<code>$</code>、<code>/</code>、<code>\</code> 和 <code>\0</code> (空字符)</li> <li>数据库名区分大小写, 推荐全部小写</li> <li>最多 64 字节</li></ul> <p>数据库最终会变成文件系统里的文件，而数据库名就是相应的文件名</p> <p>文档, 表单, 数据库之间的关系如下图:</p> <p><img src="https://i.imgur.com/LhMQBtL.png" alt="Screen Shot 2018-10-14 at 5.48.11 PM"></p> <h2 id="安装-mongodb-可视化工具"><a href="#安装-mongodb-可视化工具" class="header-anchor">#</a> 安装 MongoDB &amp; 可视化工具</h2> <p>这篇文章我不想过多讲安装步骤, 大家可以自行去查阅方法.</p> <p><a href="http://www.runoob.com/mongodb/mongodb-window-install.html" target="_blank" rel="noopener noreferrer">Windows 平台安装 MongoDB - 菜鸟教程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="http://www.runoob.com/mongodb/mongodb-osx-install.html" target="_blank" rel="noopener noreferrer">Mac 平台安装 MongoDB - 菜鸟教程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>为了更方便的管理 MongoDB 数据库, 我推荐使用 Studio 3T 可视化工具.</p> <p><a href="https://studio3t.com/" target="_blank" rel="noopener noreferrer">Studio 3T - 官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>使用方法可参照下面链接内容:</p> <p><a href="https://blog.csdn.net/weixin_39999535/article/details/81383196" target="_blank" rel="noopener noreferrer">Studio 3T 使用方法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="在-node-js-中使用-mongodb"><a href="#在-node-js-中使用-mongodb" class="header-anchor">#</a> 在 Node.js 中使用 MongoDB</h2> <p><a href="http://mongodb.github.io/node-mongodb-native/3.1/api/index.html" target="_blank" rel="noopener noreferrer">mongodb 模块 - 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>想要在 Node.js 中使用 MongoDB, 要先安装 <a href="https://www.npmjs.com/package/mongodb" target="_blank" rel="noopener noreferrer">mongodb 模块<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, 具体步骤不赘述.  在 Node.js 中使用之前, 还需要先在命令行中用 <code>mongod</code> 指令运行 MongoDB 服务器.</p> <blockquote><p>以下代码适用于 mongodb 模块 3.x 版本</p></blockquote> <h3 id="连接数据库"><a href="#连接数据库" class="header-anchor">#</a> 连接数据库</h3> <p>要想连接 MongoDB 数据库, 我们要先创建一个 MongoDB 客户端并且连接上 MongoDB 服务器.  之后在此连接之上创建数据库实例.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入模块</span>
<span class="token keyword">const</span> MongoClient <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>MongoClient<span class="token punctuation">;</span>

<span class="token comment">// MongoDB 服务器的地址</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">'mongodb://localhost:27017'</span><span class="token punctuation">;</span>

<span class="token comment">// 目标数据库的名字</span>
<span class="token keyword">const</span> dbname <span class="token operator">=</span> <span class="token string">'mydb'</span><span class="token punctuation">;</span>

<span class="token comment">// 创建 MongoDB 客户端</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MongoClient</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 让客户端连接上服务器</span>
client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;成功连接到 MongoDB 服务器!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 创建数据库实例</span>
    <span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span>dbname<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 断开连接 </span>
    client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="插入文档"><a href="#插入文档" class="header-anchor">#</a> 插入文档</h3> <p>要想向一个特定的集合插入文档, 首先我们用 <code>db.collection</code> 方法去获取目标集合的实例对象.  该方法第一个参数为集合的名字.  如果用这个名字的集合之前不存在, 它会自动帮你创建.</p> <p>之后我们用刚刚获得的集合实例的 <code>insertMany</code> 或 <code>insertOne</code> 方法来向集合插入文档.</p> <p>区别是:</p> <ul><li><code>insertOne</code> 用以插入单个文档, 第一个参数为文档对象</li> <li><code>insertMany</code> 用以插入多个文档, 第一个参数为由文档对象组成的数组</li></ul> <p>这两个方法的最后一个参数都为回调函数.  回调函数的第一个参数为错误信息, 第二个为处理结果</p> <p>假如说我们现在要向 <code>usersInfo</code> 集合插入用户信息, 代码如下:</p> <div class="language-js extra-class"><pre class="language-js"><code>client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

    <span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span>dbname<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 获取 'usersInfo' 集合的实例对象.</span>
    <span class="token keyword">const</span> collection <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'usersInfo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 插入单个用户的信息</span>
    collection<span class="token punctuation">.</span><span class="token function">insertOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">&quot;Garrik&quot;</span><span class="token punctuation">,</span>
        date_of_birth<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">&quot;1997-06-04&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
        
        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="查询全部文档"><a href="#查询全部文档" class="header-anchor">#</a> 查询全部文档</h3> <p>如果我们想查询一个集合下的全部文档, 我们可以使用集合实例的 <code>find</code> 方法.  该方法的第一个参数为查询条件对象, 如果传入一个空对象 <code>{}</code> 则表示查询全部文档.</p> <div class="language-js extra-class"><pre class="language-js"><code>client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

    <span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span>dbname<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 获取 'usersInfo' 集合的实例对象.</span>
    <span class="token keyword">const</span> collection <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'usersInfo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 查询集合下的所有文档, 然后用 toArray 转换成数组</span>
    collection<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>

        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="查询特定文档"><a href="#查询特定文档" class="header-anchor">#</a> 查询特定文档</h3> <p>前面说集合实例的 <code>find</code> 方法的第一个参数为查询条件对象.  想要查找特定文档的前提是知道怎么写查询条件对象.</p> <p>首先, 平时最常用的查询是找到有特定 &quot;键值对&quot; 的文档.  比如找到 &quot;文档中有 <code>name</code> 键, 且它的值为 <code>小明</code>&quot;.  这个查询写成查询条件对象是: <code>{'name':'小明'}</code>.  假如要查询的文档在 <code>usersInfo</code> 集合下, 在 Node.js 的代码就为:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 客户端连接上服务器</span>
client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;成功连接到 MongoDB 服务器!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 创建数据库实例</span>
    <span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span>dbname<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//查询 'name' 等于 '小明' 的文档</span>
    db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'usersInfo'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'小明'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

        <span class="token comment">// 打印出匹配到的文档</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 关闭客户端</span>
        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果再想加一条 <code>gender</code> 键的值 等于 <code>male</code>.  那查询条件对象就为 <code>{'name':'小明', 'gender':'male'}</code>  查询条件对象中各个条件是 AND 的关系.  也就是只匹配 <code>name</code> 键的值等于 <code>小明</code>, 且 <code>gender</code> 键的值为 <code>male</code> 的文档.</p> <p>假如集合中的文档有如下:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span> <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> ObjectId(<span class="token string">&quot;5bd1e7df8a5c0550f4722b01&quot;</span>)<span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;小明&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;gender&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;male&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> ObjectId(<span class="token string">&quot;5bd1e7e28a5c0550f4722b02&quot;</span>)<span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;小明&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;gender&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;female&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> ObjectId(<span class="token string">&quot;5bd1e7e88a5c0550f4722b03&quot;</span>)<span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;小红&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;gender&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;female&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> ObjectId(<span class="token string">&quot;5bd1e7f48a5c0550f4722b04&quot;</span>)<span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;小王&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;gender&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;male&quot;</span> <span class="token punctuation">}</span>
</code></pre></div><p>那么执行上面代码匹配到的为:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span> <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> ObjectId(<span class="token string">&quot;5bd1e7df8a5c0550f4722b01&quot;</span>)<span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;小明&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;gender&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;male&quot;</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="数值比较"><a href="#数值比较" class="header-anchor">#</a> 数值比较</h4> <p>上面的查询条件都是精确匹配, 也就是匹配文档中某个键的值是否等于多少.  平时常用的另一个查询是范围比较.  也就是 <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>!=</code>.  它们对应的 MongoDB 关键字为 <code>$lt</code>, <code>$gt</code>, <code>$lte</code>, <code>$gte</code>.</p> <p>比如要匹配 <code>age</code> 键的值小于 60, 那么查询条件对象为 <code>{'age': {$lt:60}}</code>.</p> <p>如果在小于 60 的同时还要大于 18, 那就是 <code>{'age': {$lt:60, $gt:18}}</code>.</p> <h4 id="or-查询"><a href="#or-查询" class="header-anchor">#</a> OR 查询</h4> <p>MongoDB 中有两种方式进行 OR 查询:</p> <ul><li><code>$in</code> 关键字可以查询一个键的多个值</li> <li><code>$or</code> 可以用于多个键值对.</li></ul> <p>比如我们要查 <code>name</code> 键的值为 <code>小明</code> 或者 <code>小红</code> 的文档. 用 <code>$in</code> 的话, 文档查询对象为 <code>{'name': {$in: ['小明', '小红']}}</code>;  用 <code>$or</code> 的话, 文档查询对象为 <code>{$or:[{'name':'小明'}, {'name':'小红'}]}</code></p> <p>但如果我们要查 <code>name</code> 键的值为 <code>小明</code> 或 <code>小红</code>, 或者 <code>gender</code> 键的值为 <code>male</code> 的文档的话, <code>$in</code> 和 <code>$or</code> 结合使用会很方便.  其文档查询对象为 <code>{$or:[{'name':{$in:['小明','小红']}}, {'gender':'male'}]}</code></p> <h3 id="更新文档"><a href="#更新文档" class="header-anchor">#</a> 更新文档</h3> <p>使用集合实例的 <code>updateOne</code> 和 <code>updateMany</code> 方法可以更新文档.  它们的第一个参数为查询对象, 用来匹配到需要更新的文档.  第二个参数为更新对象, 也就是要应用于文档上的更新内容.  最后一个参数为回调函数, 回调函数第一个参数为错误信息, 第二个为操作结果.  这两个方法的区别是 <code>updateOne</code> 只更新匹配到的第一个文档, <code>updateMany</code> 更新所有匹配到的文档.</p> <p>比如我们要更新 <code>name</code> 键的值为 <code>小明</code> 的文档的 <code>age</code> 键为 22.  Node.js 代码如下: (注意更新对象里面的 <code>$set</code> 关键字)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 客户端连接上服务器</span>
client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;成功连接到 MongoDB 服务器!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 创建数据库实例</span>
    <span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span>dbname<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//查询 'name' 等于 '小明' 的文档, 然后更新 `age` 键</span>
    db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'usersInfo'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">updateOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'小明'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> $<span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">22</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 关闭客户端</span>
        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="删除文档"><a href="#删除文档" class="header-anchor">#</a> 删除文档</h3> <p>想要删除一个文档可以用 <code>deleteOne</code> 和 <code>deleteMany</code> 方法.  第一参数为查询对象, 最后一个参数为回调函数.</p> <p>比如我们要删除 <code>name</code> 为 <code>小明</code> 的第一个文档. Node.js 代码如下:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 客户端连接上服务器</span>
client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;成功连接到 MongoDB 服务器!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 创建数据库实例</span>
    <span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span>dbname<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//删除 'name' 等于 '小明' 的第一条文档</span>
    db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'usersInfo'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'小明'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 关闭客户端</span>
        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">12/18/2018, 7:48:52 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my-notebook/assets/js/app.56630d74.js" defer></script><script src="/my-notebook/assets/js/2.a47e0c14.js" defer></script><script src="/my-notebook/assets/js/13.81ec0ed6.js" defer></script>
  </body>
</html>
