# 搭建路由 和 处理表单提交

之前, 我们搭建了静态文件服务器.  用户通过在浏览器搜索栏输入 URL 来请求保存在服务器的指定文件.  但是除了提供静态文件, 服务器能做的还有很多很多.  

## 学习目标

在这一篇, 我们要学会用 Node.js 处理从前端页面的 HTML 表单中提交的信息.

## 搭建路由

为了让服务器实现更多的功能, 我们需要为其搭建路由.

『 路由 』 (Routing) 简单来说就是 **请求和请求处理函数之间的映射关系**.  当服务器为一个特定 URL 挂在了请求处理函数时, 所有客户端发来的对于这个特定 URL 的请求都会其请求处理函数处理.

假设我们要做一个用于自我介绍的个人网页, 上面分为: 主页. 项目介绍页面, 关于我页面.  那么我们可以像下面代码中那样来搭建路由规则.

``` js
// 引入相关模块
var http = require('http');
var url = require('url');

// 搭建 HTTP 服务器
var server = http.createServer(function(req, res) {
    // 获取请求 URL, 根据 URL 中的 pathname 来匹配对应的处理方法.
    var urlObj = url.parse(req.url);
    var urlPathname = urlObj.pathname;

    switch (urlPathname) {
        case "/main":
            // 因为返回内容中有中文, 所以别忘了指定编码方式
            res.writeHead(200, { "Content-Type": "text/plain; charset=utf-8" });
            res.write("主页页面");
            res.end();
            break;
        case "/aboutme":
            res.writeHead(200, { "Content-Type": "text/plain; charset=utf-8" });
            res.write("关于我页面");
            res.end();
            break;
        case "/prjects":
            res.writeHead(200, { "Content-Type": "text/plain; charset=utf-8" });
            res.write("项目介绍页面");
            res.end();
            break;
        // 如果都不匹配就返回 404 
        default:
            res.writeHead(404, { "Content-Type": "text/plain; charset=utf-8" });
            res.write("404 - Not Found");
            res.end();
            break;
    }
});

// 在 3000 端口监听请求
server.listen(3000, function() {
    console.log("服务器运行中.");
    console.log("正在监听 3000 端口:")
})
```

好啦, 你可以尝试运行服务器, 然后用浏览器去请求相应的 URL, 来看看得到的响应是什么.

![Screen Shot 2018-10-07 at 5.05.53 PM](https://i.imgur.com/KdYISvt.png)

## 获取 GET 表单提交

在学习了路由相关知识之后, 我们再来了解一下如何获取从客户端发过来的**表单提交**.  我们先介绍用 GET 方法提交的表单.  

通过 GET 提交的表单内容会组装成『 查询字符串 』嵌入在请求 URL 里.  例如下面这段:

``` 
https://www.zhihu.com/search?type=content&q=罐装汽水Garrik
```

从 `?` 问号开始就是这段 URL 的查询字符串; 参数之间用 `&` 分开; `=` 等号前面的是参数名, 后面的是参数值.

上面这段 URL 的查询字符串如何解析成 JSON 的话就是:

``` json
{
    "type": "content",
    "q": "罐装汽水Garrik"
}
```

---

那么再简单了解了基础知识之后呢, 就让我们赶快来写代码吧!

首先让我们来写一个有 HTML 表单的页面, 然后命名为 login.html.  以下是我的代码 (当然你也可以按照你的想法写代码和命名) :

``` html
<body>
    <form action="/login" method="get">
        账户: <input type="text" name="username" />
        <br /> 
        密码: <input type="text" name="password" />
        <br />
        <input type="submit" value="提交">
    </form>
</body>
```

之后再让我们来写服务器代码:




## 获取 POST 表单提交