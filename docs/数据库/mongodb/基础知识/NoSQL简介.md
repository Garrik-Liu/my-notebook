# NoSQL 简介

NoSQL = Not Only SQL 意即"不仅仅是SQL"。泛指非关系型的数据库.

## 关系型 & 非关系型

**关系型**数据库以 行和列 的 二维表格 形式来存储数据, 一系列的行和列被称为表, 表又组成了数据库.

表与表之间存在着关系，这种关系采用现实世界中实体( entitiy )与实体( entitiy )之间的关系模型. 关系型数据库中，表都是存储格式化结构的数据，每个元组（可以理解为二维表中的一行，在数据库中经常被称为记录）字段的组成都是一样的，即使不是每个元组都需要所有的字段，但数据库会为每个元组都分配所有的字段，这样的结构可以便于表与表之间进行连接等操作，但从另一个角度来说它也是关系数据库性能瓶颈的一个因素。

现在流行的大型关系型数据库有Oracle、Microsoft SQL Server、MySQL等等。

**非关系**数据库以键值对存储，它的结构不固定，每一个元组可以有不一样的字段，每个元组可以根据需要增加或减少一些自己的键值对，这样就不会局限于固定的结构，可以减少一些时间和空间的开销。

### 关系型数据库遵循ACID规则

#### 1、A (Atomicity) 原子性

原子性很容易理解，也就是说事务里的所有操作要么全部做完，要么都不做，事务成功的条件是事务里的所有操作都成功，只要有一个操作失败，整个事务就失败，需要回滚。

比如银行转账，从A账户转100元至B账户，分为两个步骤：1）从A账户取100元；2）存入100元至B账户。这两步要么一起完成，要么一起不完成，如果只完成第一步，第二步失败，钱会莫名其妙少了100元。

#### 2、C (Consistency) 一致性

一致性也比较容易理解，也就是说数据库要一直处于一致的状态，事务的运行不会改变数据库原本的一致性约束。

例如现有完整性约束 a+b=10，如果一个事务改变了 a，那么必须得改变 b，使得事务结束后依然满足 a+b=10，否则事务失败。

#### 3、I (Isolation) 独立性

所谓的独立性是指并发的事务之间不会互相影响，如果一个事务要访问的数据正在被另外一个事务修改，只要另外一个事务未提交，它所访问的数据就不受未提交事务的影响。

比如现在有个交易是从A账户转100元至B账户，在这个交易还未完成的情况下，如果此时B查询自己的账户，是看不到新增加的100元的。

#### 4、D (Durability) 持久性

持久性是指一旦事务提交后，它所做的修改将会永久的保存在数据库上，即使出现宕机也不会丢失。

### 关系型 & 非关系型 对比

特性 | 优点 | 缺点
--- | --- | ---
关系型数据库 | 1.采用关系模型来组织数据 <br> 2.事务的一致性 <br> 3. 一个关系型数据库是由关系模型（即二维表格模型）及其之间的关联关系组成的一个数据组织 | 1.容易理解。二维表结构是非常贴近逻辑世界的一个概念，关系模型相对网状、层次等其他模型来说更易理解<br>2.使用方便。标准的sql语言使得操作关系数据库非常方便<br>3.易于维护。丰富的完整性（实体完整性、参照完整性和用户定义的完整性）大大降低了数据冗余和数据不一致的概率。<br>4.支持Sql及事务处理。可以进行复杂查询，事务支持使得其能保证数据一致性 | 1.读写性能差。为了维护数据一致性所付出的巨大代价就是其读写性能比较差<br>2.高并发读写需求<br>3.海量数据高效率读写<br>4.固定的表结构。不擅长为有数据的表做索引或表结构的变更
非关系型(NoSql)|1.以键值对存储<br>2.分布式<br>3.一般不支持ACID特性（即数据库事务特性：原子性、一致性、隔离性、持久性）<br>4.NoSql严格上讲不是一种数据库，应该是一种数据结构化存储方法的集合 | 1.灵活的数据存储模型。数据结构不固定<br>2.易扩展。数据之间无耦合，非常容易扩展<br>3. 高性能。能够适应现代网络对数据库高并发读写请求以及对海量数据的高速访问能力，得益于它的无关系性<br>4.高可用。在不太影响性能的情况，就可以方便的实现高可用的架构。比如Cassandra，HBase模型，通过复制模型也能实现高可用。| 1. 不提供对SQL的支持。Sql是工业标准，不支持sql将对用户产生一定的学习和迁移成本<br>2. 应用局限性。大多数NoSql数据库都不支持事务，现有产品功能不够完善，附加功能如Bi和报表等也不支持<br>3.现有产品不成熟。缺乏类似关系型数据库所具有的强有力的理论、技术、标准规范（如sql）等支持。

## NoSQL 分类 

NoSql又分为四大类数据库：
* 键值(Key-Value)存储数据库、
* 列存储数据库、
* 文档型数据库、
* 图形(Graph)数据库。

它们的对比分析如下：

分类  |典型应用场景 |数据模型 |优点 |缺点
---| --- | --- | --- | ---
键值（key-value）|内容缓存，主要用于处理大量数据的高访问负载，也用于一些日志系统等等。 |Key 指向 Value 的键值对，通常用hash table来实现|查找速度快|数据无结构化，通常只被当作字符串或者二进制数据
列存储数据库|分布式的文件系统|以列簇式存储，将同一列数据存在一起|查找速度快，可扩展性强，更容易进行分布式扩展|功能相对局限
文档型数据库|Web应用（与Key-Value类似，Value是结构化的，不同的是数据库能够了解Value的内容）|Key-Value对应的键值对，Value为结构化数据|数据结构要求不严格，表结构可变，不需要像关系型数据库一样需要预先定义表结构|查询性能不高，而且缺乏统一的查询语法。
图形(Graph)数据库|社交网络，推荐系统等。专注于构建关系图谱|图结构|利用图结构相关算法。比如最短路径寻址，N度关系查找等|很多时候需要对整个图做计算才能得出需要的信息，而且这种结构不太好做分布式的集群方案。



## 参考

* [MongoDB学习（一）初识NoSql及MongoDB](https://blog.csdn.net/qq_16313365/article/details/52232623)
* [NoSQL 简介](http://www.runoob.com/mongodb/nosql.html)