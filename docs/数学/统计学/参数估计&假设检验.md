# 参数估计 & 假设检验

前面已经介绍了很多随机变量的概率分布，和关于样本统计量的抽样分布。根据 "中心极限定理" 可知，无论总体是怎样分布的，它的样本的统计量的抽样分布都是正态的。

这一章介绍，如何去估计总体的 "参数"。

---

推断统计关心的就是如何去得到一个总体的 "参数"，也就描述总体特性的数值描述性度量。

主要有两种方式去进行推断：

- **参数估计** Estimation：根据样本的信息去估计出总体的参数。
- **假设检验** Hypothesis Testing：先自己估计出一个可能的参数值，然后再去判断正确性。

## 参数估计

『 **估计量** estimator 』是指基于样本的观测数据计算出总体参数的 "估计值 estimate" 的法则 ( 公式 )

估计量可以通过两种方式得到：点估计 & 区间估计。

### 点估计

『 **点估计** point estimation 』基于样本数据，计算出"一个" 数值作为总体参数的估计值。

- 用于计算的公式，称为『 点估计量 point estimator 』样本统计量的抽样分布就是一个 "点估计量"。
- 计算出的估计值，称为『 点估计值 point estimate 』从一个样本计算出的统计量就是 "点估计值"。

如果一个参数的估计量的分布的均值与真正的参数值相同，则该估计量被称为是『 **无偏的** unbiased 』。否则称为『 **有偏的** biased 』

![2020-08-06-16-13-07](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-08-06-16-13-07.png)

一个估计量的分布的方差应该是越小越好。越小的方差意味着真正的参数值接近于分布均值的可能性越大。

![2020-08-06-16-15-19](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-08-06-16-15-19.png)

估计值与真正参数值之间的差被称为『 **误差** error of estimation 』

假设样本的容量足够到，得到的估计量都是无偏的，估计量的分布都近似正态分布。根据中心极限定理可以计算出，一个估计量有 $95\%$ 的可能性，落入估计量分布中的均值左右各 $1.96$ 个标准误 SE 的范围内。

- 对于无偏的估计量，这就意味着一个估计值有 $95\%$ 的可能性与参数的误差在 $1.96$ 个标准误之内。
- 估计量均值左右各 $1.96$ 个标准误的区间称为『 **95% margin of error** 』简称 "margin of error"。

![2020-08-06-16-53-37](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-08-06-16-53-37.png)

> 你可能发现了，估计量的 "标准误" 计算是要用到总体的标准差 $\sigma$ 的。但是我们并不知道总体的参数。所以只能用从样本中计算出的参数值 $s$ 估计为总体的标准差。虽然不是很准确，但也只好如此。

::: details-open 🌰 例子：

电视台想知道每个人每周平均看多长时间电视。它们随机抽出了 50 个人作为样本，计算得出平均观看时长为 $11.5$ 小时每周。标准差为 $3.5$ 小时。

首先，将样本的标准差作为总体的标准差，计算得出估计量的标准误，并且将它乘上 $1.96$：

$$1.96 \mathrm{SE}=1.96\left(\frac{s}{\sqrt{n}}\right)=1.96\left(\frac{3.5}{\sqrt{50}}\right)=0.97 \approx 1$$

我可以认为 $11.5$ 有 $95\%$ 的可能性与总体均值的距离在 $1$ 小时以内。
:::

### 区间估计

『 **区间估计** interval estimation 』基于样本数据，计算出 "两个" 数值去构建一个区间，总体参数的估计值可能落于其中。

- 用于计算的公式，称为『 区间估计量 interval estimator 』
- 计算出的两个数值，称为『 区间估计值 interval estimate 』根据位置又可以分别称为『 **置信下限** Lower Control Limit, LCL 』和『 **置信上限** Upper Control Limit, UCL 』
- 两个数值构成的区间，称为『 **置信区间** confidence interval 』
- 这个区间包含被估参数的概率称为『 **置信系数** confidence coefficient 』一个置信区间的置信系数为 0.95, 则称其为是 95% 的置信区间. 意思是有 95% 的可能性被估计参数落入这个区间中。

#### 均值的置信区间估计 ( 大样本容量 $n>30$ )

现在，假设我们知道总体的标准差 $\sigma$。或者直接用样本的标准差作为总体标准差的估计 ( 样本容量大时 $n>30$ )

通过前面我们知道，从一个样本计算出的估计量，有 $95\%$ 的几率在估计量均值左右各 $1.96$ 个 "标准误 SE" 之内。

那么反过来说，我从总体中随机抽样，然后计算出样本的均值，在均值左右两边各 $1.96$ 个 "标准误 SE" 位置划出一个区间。这个区间有 $95\%$ 的几率包含 "总体的均值"。

这个区间可以称为称为置信度为 $95\%$ 的置信区间。

![2020-08-06-20-42-16](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-08-06-20-42-16.png)

可以将统计量分布转换成标准正态分布：

![2020-08-06-20-44-23](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-08-06-20-44-23.png)

- 置信度用 $(1-\alpha)*100\%$ 表示。$\alpha$ 为总体均值不在区间内的槪率。
- 分布的上尾和下尾面分别都是 $\alpha/2$
- 置信区间为 $\bar{X}-Z (\sigma/\sqrt{n})<\mu \leqslant \bar{X} + Z (\sigma/\sqrt{n})$
- $Z$ = 标准正态分布中对应于曲线面枳为 $1 - \alpha/2$ 的值。在置信区间中，$Z$ 值又称为『 **临界值** critical value 』
  - 🌰 $95\%$ 的置信度对应于 $\alpha$ 为 $0.05$。对应于曲线面积 $0.975$ 的 $Z$ 值，也就是临界值为 $1.96$。

置信度可以通过增大区间范围来提高，但这也造成了区间精度的下降。

![2020-08-06-20-56-46](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-08-06-20-56-46.png)

::: details-open 🌰 例子：

造纸厂对于每张纸的长度的期望均值是 11 英寸，标准差为 0.02 英寸。请通过抽样检验来判断产品生产是否符合预期。

现在，从成品中随机抽取 100 张纸，然后计算出样本均值 10.998 英寸。计算 95% 置信度的总体均值区间估计。

计算得到，

$$\begin{array}{l}\bar{X} \pm Z \frac{\sigma}{\sqrt{n}}=10.998 \pm 1.96 \times \frac{0.02}{\sqrt{100}}=10.998 \pm 0.00392 \\\\10.99408 \leqslant \mu \leqslant11.00192\end{array}$$

这个区间中包含了 11，所以证明生产流程还在正常运作。
:::

#### 均值的置信区间估计 ( 小样本容量 $n<30$ )

#### 比例的置信区间估计

::: warning
⚠️ 建设中...
:::

### 确定样本容量

在实际进行抽样分析之前，就需要确定好样本的容量。确定样本容量是个很复 杂的过程，受到金钱、时间、可接受误差的限制。

#### 确定 "均值估计" 的样本容量

在总体均值估计的样本容量的确定中，我们先不管金钱和时间的限制。首先要确定好：

- 可以接受多大的 "抽样误差"。
- 区间估计中的 "罝信度水平"。

抽样误差，指的是在置信区间中加在样本均值两边的量，用符号 $e$ 表示。

$$e = Z_{\alpha/2}\frac{\sigma}{\sqrt{n}}$$

通过上面 👆 的公式我们可以得出 "样本容量" 的计算公式：

$$n = \frac{Z_{\alpha/2}^2\sigma^2}{e^2}$$

这个公式中设计 3 个变量，置信度决定了 $Z$ 值，可接受的抽样误差 $e$，总体的标准差 $\sigma$。

我们一般很难事先知道总体的标准差 $\sigma$。

- 在有些情况，可以根据以往的数据来估计标准差。
- 在其他情况下，可以用数值分布范围和变量的分布情况来估算。如果总体是正态分布，那么数值分布的范围就近似等于 $6\sigma$。可以用取值范围除以 $6$ 来求 $\sigma$ 值。
- 还可以进行小规模调査，根据调査数据来估算标准差。

::: details-open 🌰 例子：

一家公司想要知道所有的销售发票上金额的均值是多少。决定抽样误差小于 $5$ 美元，置信度为 $95\%$，以往的记录显示标准差大约为 $25$ 美元。

计算合适的抽样容量：

$$n = \frac{Z_{\alpha/2}^2\sigma^2}{e^2} = \frac{(1.96)^2(25)^2}{5^2} = 96.04$$

取一个大于计算值的整数，所以样本容量为 97。公司可能为了使用起来方便，选取 100 这个数字。
:::

## 假设检验
