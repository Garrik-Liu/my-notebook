# 统计学 (02)

## 二元概率分布

### 二元离散随机变量的概率分布

如果样本空间中的每个简单事件都可以指定两个数值, 一个对应于离散随机变量 $X$ 的值. 一个对应于离散随机变量 $Y$ 的值;

- $X$ 和 $Y$ 的具体取值可以对应到两个数值事件. 两个事件交的概率为:

![2020-06-01-10-32-09](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-10-32-09.png)

![2020-06-01-10-32-51](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-10-32-51.png)

![2020-06-01-10-33-37](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-10-33-37.png)

::: details-open 🌰 例子：

![2020-06-01-10-36-04](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-10-36-04.png)
![2020-06-01-10-36-12](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-10-36-12.png)

:::

![2020-06-01-10-36-31](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-10-36-31.png)
![2020-06-01-10-37-04](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-10-37-04.png)

::: details-open 🌰 例子：

![2020-06-01-10-38-19](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-10-38-19.png)

:::

![2020-06-01-10-38-29](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-10-38-29.png)

---

二元联合概率分布的概念可以推广到任意个随机变量. 两个或更多个随机变量的联合概率分布称为『 **多元概率分布** 』

### 二元连续随机变量的概率分布

![2020-06-01-11-12-22](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-12-22.png)
![2020-06-01-11-12-39](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-12-39.png)

::: details-open 🌰 例子：

![2020-06-01-11-13-39](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-13-39.png)
![2020-06-01-11-13-50](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-13-50.png)

:::

### 两个随机变量的函数的期望值

![2020-06-01-11-14-40](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-14-40.png)
![2020-06-01-11-14-54](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-14-54.png)

### 两个随机变量的独立性

![2020-06-01-11-15-38](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-15-38.png)

::: details-open 🌰 例子：

![2020-06-01-11-16-14](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-16-14.png)

:::

![2020-06-01-11-16-36](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-16-36.png)

### 两个随机变量的协方差 & 相关性

当认为两个随机变量 X 和 Y 有关系时, 通常倾向于设想它们之间具有『 **线性关系** 』, 即随 X 增大 Y 也增大, 或随 X 增大 Y 减小

假设现在收集了一个有 $n$ 对 $(x, y)$ 值的样本. 在坐标系上画出这些点:

- 如果这些点散布得像一条直线, 我们就认为 $x$ 和 $y$ 之间的线性关系**强**;
- 如果这些点散布得不像一条直线, 我们就认为 $x$ 和 $y$ 之间的线性关系**弱**;

![2020-07-23-09-47-47](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-09-47-47.png)

---

度量线性关系强度的一种方法是计算每一个数据点的『 **离差叉积** 』, 公式为:

$$(x-μ_x)(y-μ_y)$$

![2020-07-23-09-52-45](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-09-52-45.png)

对于数据点在图中的位置:

- 如果所有点位于直线附近, 且有正斜率, 则所有的叉积为正, 它们的平均值相对大且为正. 如图 a 所示;
- 如果所有点位于直线附近, 且有负斜率, 则所有的叉积为负, 它们的平均值相对大且为负. 如图 b 所示;
- 对于点在各个象限都有, 一些叉积为正, 一些叉积为负, 则它们的均值相对小, 可能接近于 0. 如图 c 所示;

---

这引出了另一个度量两个随机变量之间线性关系强度的值, 『 **协方差** 』

![2020-06-01-11-44-58](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-44-58.png)
![2020-06-01-11-45-16](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-45-16.png)

::: details-open 🌰 例子：

![2020-06-01-11-45-42](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-45-42.png)

:::

- 如果两个随机变量的协方差是正的, 则 X 增大 Y 增大;
- 如果两个随机变量的协方差是负的, 则 X 增大 Y 减小;
- 如果两个随机变量的协方差是 0, 则 X 和 Y 没有线性关系;

---

我们知道协方差为 0 时, 代表随机变量之间没有线性关系. 但是对于非 0 的数值该如何理解呢?

对于协方差的具体数值, 其依赖于 X 和 Y 的度量单位, 为了消除单位的影响, 定义了协方差的标准形式, 称为『 **相对系数** 』

![2020-06-01-11-49-35](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-49-35.png)

### 随机变量函数的的概率分布 & 期望值

可以用『 **累积分布函数法** 』求随机变量函数的密度函数

假设 $W$ 是一个或多个随机变量的函数，累计分布函数法是通过先求概率 $P(W \leq w)$, 它等于 $F(w)$ 然后对 $F(w)$ 关于 $w$ 求导，得到密度函数 $f(w)$.

::: details-open 🌰 例子：

![2020-06-01-11-52-27](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-52-27.png)

:::

![2020-07-23-10-25-26](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-10-25-26.png)
![2020-06-01-11-54-05](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-54-05.png)

::: details-open 🌰 例子：

![2020-06-01-11-54-30](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-54-30.png)

:::

![2020-06-01-11-54-41](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-54-41.png)
![2020-06-01-11-54-51](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-54-51.png)

::: details-open 🌰 例子：

![2020-06-01-11-55-12](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-55-12.png)
![2020-06-01-11-55-42](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-55-42.png)

:::

## 抽样分布

### 什么是抽样分布

样本中 $n$ 个测量值可以看作是 $n$ 个随机变量的具体取值. 样本的均值, 方差, 和其他统计量都可以看作是有关随机变量的函数. 通过这些函数可以推断总体参数;

统计量的概率分布称为统计量的『 **抽样分布** 』

- 它的均值是统计量的**期望值**;
- 它的标准差称为统计量的**标准误**;

对于求一个统计量的抽样分布:

- 可以用上一节讲的数学技巧求统计量的抽样分布, 也可以用计算机模拟抽样分布,
- 即使不能得到统计量抽样分布的精准数学形式, 也不能用模拟方法近似. 我们还可以求出它的均值和方差, 然后用经验法则得到抽样分布的一个近似描述;

### 蒙特卡罗模拟

如果用数学方法求统计量的抽样分布很麻烦, 我们可以用随机数发生器，通过重复产生统计量 $W$ 的观测值，找到概率分布函数 $f(W)$ 的近似. 这种方法称为『 **蒙特卡罗模拟** 』

::: details-open 🌰 例子：

![2020-06-01-11-33-38](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-33-38.png)

:::

### 均值 & 方差的抽样分布

『 **中心极限定理** 』

![2020-06-01-11-56-57](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-56-57.png)

中心极限定理和定义 6.15 的意义是, 只总体的均值和方差有限，且样本的观测个数 $n$ 足够大，那么我们就可以用正态分布近似样本均值的抽样分布.

事实上，可以证明正态分布随机变量的任意线性函数的抽样分布都是正态分布.

![2020-07-23-10-51-46](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-10-51-46.png)

::: details-open 🌰 例子：

![2020-06-01-11-58-31](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-58-31.png)
![2020-06-01-11-58-44](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-58-44.png)

:::

### 二项分布的正态逼近

![2020-06-01-12-00-42](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-00-42.png)

::: details-open 🌰 例子：

![2020-06-01-12-01-05](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-01-05.png)

:::

![2020-06-01-12-01-24](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-01-24.png)

### 与正态分布有关的抽样分析

下面 👇 给出基于正态总体观测值的随机样本的几个著名统计量的分布. 可以用这些统计量估计某些总体参数值.

![2020-07-23-11-01-34](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-11-01-34.png)

::: details-open 🌰 例子：

![2020-06-01-12-03-36](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-03-36.png)
![2020-06-01-12-04-05](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-04-05.png)
![2020-06-01-12-04-12](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-04-12.png)

:::

## 置信区间

推断总体参数有两种方法:

- 估计参数值;
  - 🌰 估计一个工业机器人完成一项任务的平均时间 $μ$
- 对假设的参数值进行判断;
  - 🌰 判断平均时间 $μ$ 是否超过某个值 ( 例如, 3 分钟 )

在这一章先研究如何去估计参数值.

### 点估计 & 区间估计

假设我们需要估计某个总体参数，记作 $θ$.

『 **点估计** 』是说明如何利用样本观测值计算一个数（ 一个点 ）作为 $θ$ 的估计值的规则或公式. 记作 $\hat{θ}$

- 🌰 例如，设 $y_1, y_2, ... , y_n$ 是随机变量 $Y$ 的 $n$ 个观测值的随机样本. 样本均值 $\bar{y}$ 就是总体均值 $E(Y) = μ$ 的一个点估计, 即 $\hat{μ} = \bar{y}$

因为点估计由样本计算得到，所以它有抽样分布.

- 均值为 $μ$, 标准差为 $\sigma / \sqrt{n}$

![2020-07-23-11-25-57](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-11-25-57.png)

『 **区间估计** 』是一种由样本数据计算用于估计总体参数的区间的公式.

- 🌰 例如，如果我们估计机器人完成一项任务的平均时间 $μ$ 在 2.7 - 3.1 分钟之间，那么区间 2.7 - 3.1 就是 $μ$ 的一个区间估计.

---

如果估计量 $\hat{θ}$ 的抽样分布的均值等于被估计参数 $θ$ 则这个估计量称作『 **无偏的** 』否则，估计量称作『 **有偏的** 』.

![2020-07-23-11-29-27](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-11-29-27.png)

我们还希望估计量的抽样分布具有『 **最小方差** 』即我们希望抽样分布的离散程度尽可能小，使估计值趋于落在 $θ$ 附近.

- 所有无偏估计中方差最小的无偏估计称作『 **最小方差无偏估计**, MVUE 』

有时对同一个估计量，不能同时达到无偏性和最小方差. 在这种情况下，选用使『 **均方误差** 』最小的估计量.

- 均方误差, 是指 $\hat{θ}$ 与 $θ$ 间偏差平方的平均, 为 $E[(\hat{θ} - θ)^2]$

$$E[(\hat{θ} - θ)^2] = V(\hat{θ}) + b^2(\hat{θ})$$

![2020-07-23-13-19-01](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-19-01.png)

::: details-open 🌰 例子：

![2020-07-23-13-25-26](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-25-26.png)
![2020-07-23-13-25-35](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-25-35.png)

:::

### 求点估计：经典估计方法

求参数的点估计有许多不同的方法.

#### 矩法

![2020-07-23-13-31-07](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-31-07.png)
![2020-07-23-13-32-02](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-32-02.png)

![2020-07-23-13-32-48](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-32-48.png)

::: details-open 🌰 例子：

![2020-07-23-13-34-40](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-34-40.png)

:::

::: details-open 🌰 例子：

![2020-07-24-16-07-53](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-07-53.png)
![2020-07-24-16-08-02](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-08-02.png)

:::

#### 极大似然法

::: details-open 🌰 例子：

![2020-07-24-16-15-07](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-15-07.png)

:::

### 求区间估计: 枢轴法

通过样本观测值我们可以计算出来一个随机区间 ( 随机是因为用于计算区间端点的样本观测值是随机变量 ) 被估计的参数有很大的可能性落入这个区间中. 这个区间称为『 **置信区间** 』

包含被估参数的概率称为『 **置信系数** 』

- 一个置信区间的置信系数为 0.95, 则称其为是 95% 的置信区间. 意思是有 95% 的可能性被估计参数落入这个区间中.

一种求参数 $θ$ 的置信区间的方法是求出一个『 **数轴统计量** 』这个统计量是样本值和单个参数 $θ$ 的函数.

- 因为当样本容量 $n$ 很大时，很多统计量近似正态分布（ 中心极限定理 ），所以可以利用标准正态随机变量 $Z$ 作为枢轴统计量来构造期望值的置信区间.

![2020-07-24-16-41-16](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-41-16.png)

因此, 由『 **置信下限**, Lower Control Limit, LCL 』$\hat{θ} - z_{α/2}\sigma_{\hat{θ}}$ 到『 **置信上限**, Upper Control Limit, UCL 』$\hat{θ} + z_{α/2}\sigma_{\hat{θ}}$ 形成的区间包含参数 $θ$ 的概率 ( 置信系数 ) 为 $1 - α$

![2020-07-24-16-21-49](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-21-49.png)

![2020-07-24-16-29-01](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-29-01.png)
![2020-07-24-16-29-22](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-29-22.png)

::: details-open 🌰 例子：

![2020-07-24-16-26-43](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-26-43.png)
![2020-07-24-16-28-12](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-28-12.png)
![2020-07-24-16-28-29](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-28-29.png)

:::

### 总体均值的估计

![2020-07-24-16-47-09](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-47-09.png)

::: details-open 🌰 例子：

![2020-07-24-16-47-30](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-47-30.png)
![2020-07-24-16-47-57](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-47-57.png)

:::

---

![2020-07-24-16-48-47](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-48-47.png)

如果可以假定选取样本的总体有近似正态分布, 则可以执行基于小样本的估计方法.

![2020-07-24-16-50-06](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-50-06.png)

::: details-open 🌰 例子：

![2020-07-24-16-50-34](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-50-34.png)
![2020-07-24-16-50-42](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-50-42.png)

:::

![2020-07-24-16-53-06](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-53-06.png)

### 两个总体均值差的估计

### 选择样本容量

### 其他区间估计方法

#### 自助法

#### 贝叶斯法

## 假设检验
