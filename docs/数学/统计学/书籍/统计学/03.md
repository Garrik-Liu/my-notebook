# 统计学 (03)

## 抽样分布

### 什么是抽样分布

样本中 $n$ 个测量值可以看作是 $n$ 个随机变量的具体取值. 样本的均值, 方差, 和其他统计量都可以看作是有关随机变量的函数. 通过这些函数可以推断总体参数;

统计量的概率分布称为统计量的『 **抽样分布** 』

- 它的均值是统计量的**期望值**;
- 它的标准差称为统计量的**标准误**;

对于求一个统计量的抽样分布:

- 可以用上一节讲的数学技巧求统计量的抽样分布, 也可以用计算机模拟抽样分布,
- 即使不能得到统计量抽样分布的精准数学形式, 也不能用模拟方法近似. 我们还可以求出它的均值和方差, 然后用经验法则得到抽样分布的一个近似描述;

### 蒙特卡罗模拟

如果用数学方法求统计量的抽样分布很麻烦, 我们可以用随机数发生器，通过重复产生统计量 $W$ 的观测值，找到概率分布函数 $f(W)$ 的近似. 这种方法称为『 **蒙特卡罗模拟** 』

::: details-open 🌰 例子：

![2020-06-01-11-33-38](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-33-38.png)

:::

### 均值 & 方差的抽样分布

『 **中心极限定理** 』

![2020-06-01-11-56-57](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-56-57.png)

中心极限定理和定义 6.15 的意义是, 只总体的均值和方差有限，且样本的观测个数 $n$ 足够大，那么我们就可以用正态分布近似样本均值的抽样分布.

事实上，可以证明正态分布随机变量的任意线性函数的抽样分布都是正态分布.

![2020-07-23-10-51-46](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-10-51-46.png)

::: details-open 🌰 例子：

![2020-06-01-11-58-31](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-58-31.png)
![2020-06-01-11-58-44](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-58-44.png)

:::

### 二项分布的正态逼近

![2020-06-01-12-00-42](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-00-42.png)

::: details-open 🌰 例子：

![2020-06-01-12-01-05](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-01-05.png)

:::

![2020-06-01-12-01-24](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-01-24.png)

### 与正态分布有关的抽样分析

下面 👇 给出基于正态总体观测值的随机样本的几个著名统计量的分布. 可以用这些统计量估计某些总体参数值.

![2020-07-23-11-01-34](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-11-01-34.png)

::: details-open 🌰 例子：

![2020-06-01-12-03-36](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-03-36.png)
![2020-06-01-12-04-05](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-04-05.png)
![2020-06-01-12-04-12](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-04-12.png)

:::

## 点估计 & 区间估计

推断总体参数有两种方法:

- 估计参数值;
  - 🌰 估计一个工业机器人完成一项任务的平均时间 $μ$
- 对假设的参数值进行判断;
  - 🌰 判断平均时间 $μ$ 是否超过某个值 ( 例如, 3 分钟 )

在这一章先研究如何去估计参数值.

### 点估计 & 区间估计

假设我们需要估计某个总体参数，记作 $θ$.

『 **点估计** 』是说明如何利用样本观测值计算一个数（ 一个点 ）作为 $θ$ 的估计值的规则或公式. 记作 $\hat{θ}$

- 🌰 例如，设 $y_1, y_2, ... , y_n$ 是随机变量 $Y$ 的 $n$ 个观测值的随机样本. 样本均值 $\bar{y}$ 就是总体均值 $E(Y) = μ$ 的一个点估计, 即 $\hat{μ} = \bar{y}$

因为点估计由样本计算得到，所以它有抽样分布.

- 均值为 $μ$, 标准差为 $\sigma / \sqrt{n}$

![2020-07-23-11-25-57](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-11-25-57.png)

『 **区间估计** 』是一种由样本数据计算用于估计总体参数的区间的公式.

- 🌰 例如，如果我们估计机器人完成一项任务的平均时间 $μ$ 在 2.7 - 3.1 分钟之间，那么区间 2.7 - 3.1 就是 $μ$ 的一个区间估计.

---

如果估计量 $\hat{θ}$ 的抽样分布的均值等于被估计参数 $θ$ 则这个估计量称作『 **无偏的** 』否则，估计量称作『 **有偏的** 』.

![2020-07-23-11-29-27](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-11-29-27.png)

我们还希望估计量的抽样分布具有『 **最小方差** 』即我们希望抽样分布的离散程度尽可能小，使估计值趋于落在 $θ$ 附近.

- 所有无偏估计中方差最小的无偏估计称作『 **最小方差无偏估计**, MVUE 』

有时对同一个估计量，不能同时达到无偏性和最小方差. 在这种情况下，选用使『 **均方误差** 』最小的估计量.

- 均方误差, 是指 $\hat{θ}$ 与 $θ$ 间偏差平方的平均, 为 $E[(\hat{θ} - θ)^2]$

$$E[(\hat{θ} - θ)^2] = V(\hat{θ}) + b^2(\hat{θ})$$

![2020-07-23-13-19-01](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-19-01.png)

::: details-open 🌰 例子：

![2020-07-23-13-25-26](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-25-26.png)
![2020-07-23-13-25-35](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-25-35.png)

:::

### 求点估计：经典估计方法

求参数的点估计有许多不同的方法.

#### 矩法

![2020-07-23-13-31-07](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-31-07.png)
![2020-07-23-13-32-02](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-32-02.png)

![2020-07-23-13-32-48](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-32-48.png)

::: details-open 🌰 例子：

![2020-07-23-13-34-40](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-34-40.png)

:::

::: details-open 🌰 例子：

![2020-07-24-16-07-53](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-07-53.png)
![2020-07-24-16-08-02](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-08-02.png)

:::

#### 极大似然法

::: details-open 🌰 例子：

![2020-07-24-16-15-07](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-15-07.png)

:::

### 求区间估计: 枢轴法

通过样本观测值我们可以计算出来一个随机区间 ( 随机是因为用于计算区间端点的样本观测值是随机变量 ) 被估计的参数有很大的可能性落入这个区间中. 这个区间称为『 **置信区间** 』

包含被估参数的概率称为『 **置信系数** 』

- 一个置信区间的置信系数为 0.95, 则称其为是 95% 的置信区间. 意思是有 95% 的可能性被估计参数落入这个区间中.

一种求参数 $θ$ 的置信区间的方法是求出一个『 **数轴统计量** 』这个统计量是样本值和单个参数 $θ$ 的函数.

- 因为当样本容量 $n$ 很大时，很多统计量近似正态分布（ 中心极限定理 ），所以可以利用标准正态随机变量 $Z$ 作为枢轴统计量来构造期望值的置信区间.

![2020-07-24-16-41-16](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-41-16.png)

因此, 由『 **置信下限**, Lower Control Limit, LCL 』$\hat{θ} - z_{α/2}\sigma_{\hat{θ}}$ 到『 **置信上限**, Upper Control Limit, UCL 』$\hat{θ} + z_{α/2}\sigma_{\hat{θ}}$ 形成的区间包含参数 $θ$ 的概率 ( 置信系数 ) 为 $1 - α$

![2020-07-24-16-21-49](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-21-49.png)

![2020-07-24-16-29-01](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-29-01.png)
![2020-07-24-16-29-22](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-29-22.png)

::: details-open 🌰 例子：

![2020-07-24-16-26-43](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-26-43.png)
![2020-07-24-16-28-12](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-28-12.png)
![2020-07-24-16-28-29](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-28-29.png)

:::

### 总体均值的估计

![2020-07-24-16-47-09](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-47-09.png)

::: details-open 🌰 例子：

![2020-07-24-16-47-30](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-47-30.png)
![2020-07-24-16-47-57](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-47-57.png)

:::

---

![2020-07-24-16-48-47](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-48-47.png)

如果可以假定选取样本的总体有近似正态分布, 则可以执行基于小样本的估计方法.

![2020-07-24-16-50-06](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-50-06.png)

::: details-open 🌰 例子：

![2020-07-24-16-50-34](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-50-34.png)
![2020-07-24-16-50-42](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-50-42.png)

:::

![2020-07-24-16-53-06](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-53-06.png)

### 两个总体均值差的估计

### 选择样本容量

### 其他区间估计方法

#### 自助法

#### 贝叶斯法

## 假设检验
