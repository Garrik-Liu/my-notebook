# 统计学 (03)

## 抽样分布

### 什么是抽样分布

样本中每个观测值可以看作是一个随机变量的具体取值. 因为每次抽取的样本都是随机的, 所以样本产生的各种『 统计量 』的值也是随机的, 可以被看作是某个随机变量的具体取值. 从而每个统计量也有自己的, 关于随机变量的概率分布函数. 通过这些函数我们可以推断总体『 参数 』

统计量的概率分布称为统计量的『 **抽样分布** 』

- 它的均值是统计量的**期望值**;
- 它的标准差称为统计量的**标准误**;

对于求一个统计量的抽样分布:

- 可以用上一节讲的数学技巧求统计量的抽样分布, 也可以用计算机模拟抽样分布,
- 即使不能得到统计量抽样分布的精准数学形式, 也不能用模拟方法近似. 我们还可以求出它的均值和方差, 然后用经验法则得到抽样分布的一个近似描述;

### 蒙特卡罗模拟

如果用数学方法求统计量的抽样分布很麻烦, 我们可以用随机数发生器，通过重复产生统计量 $W$ 的观测值，找到概率分布函数 $f(W)$ 的近似. 这种方法称为『 **蒙特卡罗模拟** 』

::: details-open 🌰 例子：

![2020-06-01-11-33-38](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-33-38.png)

:::

### 均值 & 方差的抽样分布

『 **中心极限定理** 』

![2020-06-01-11-56-57](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-56-57.png)

中心极限定理和定义 6.15 的意义是, 只总体的均值和方差有限，且样本的观测个数 $n$ 足够大，那么我们就可以用正态分布近似样本均值的抽样分布.

事实上，可以证明正态分布随机变量的任意线性函数的抽样分布都是正态分布.

![2020-07-23-10-51-46](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-10-51-46.png)

::: details-open 🌰 例子：

![2020-06-01-11-58-31](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-58-31.png)
![2020-06-01-11-58-44](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-11-58-44.png)

:::

### 二项分布的正态逼近

![2020-06-01-12-00-42](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-00-42.png)

::: details-open 🌰 例子：

![2020-06-01-12-01-05](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-01-05.png)

:::

![2020-06-01-12-01-24](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-01-24.png)

### 与正态分布有关的抽样分析

下面 👇 给出基于正态总体观测值的随机样本的几个著名统计量的分布. 可以用这些统计量估计某些总体参数值.

![2020-07-23-11-01-34](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-11-01-34.png)

::: details-open 🌰 例子：

![2020-06-01-12-03-36](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-03-36.png)
![2020-06-01-12-04-05](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-04-05.png)
![2020-06-01-12-04-12](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-06-01-12-04-12.png)

:::

## 参数估计

推断总体参数有两种方法:

- 估计参数值;
  - 🌰 估计一个工业机器人完成一项任务的平均时间 $μ$
- 对假设的参数值进行判断;
  - 🌰 判断平均时间 $μ$ 是否超过某个值 ( 例如, 3 分钟 )

在这一章先研究如何去估计参数值.

### 点估计 & 区间估计

假设我们需要估计某个总体参数，记作 $θ$.

『 **点估计** 』是说明如何利用样本观测值计算一个数（ 一个点 ）作为 $θ$ 的估计值的规则或公式. 记作 $\hat{θ}$

- 🌰 例如，设 $y_1, y_2, ... , y_n$ 是随机变量 $Y$ 的 $n$ 个观测值的随机样本. 样本均值 $\bar{y}$ 就是总体均值 $E(Y) = μ$ 的一个点估计, 即 $\hat{μ} = \bar{y}$

因为点估计由样本计算得到，所以它有抽样分布.

- 均值为 $μ$, 标准差为 $\sigma / \sqrt{n}$

![2020-07-23-11-25-57](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-11-25-57.png)

『 **区间估计** 』是一种由样本数据计算用于估计总体参数的区间的公式.

- 🌰 例如，如果我们估计机器人完成一项任务的平均时间 $μ$ 在 2.7 - 3.1 分钟之间，那么区间 2.7 - 3.1 就是 $μ$ 的一个区间估计.

---

如果估计量 $\hat{θ}$ 的抽样分布的均值等于被估计参数 $θ$ 则这个估计量称作『 **无偏的** 』否则，估计量称作『 **有偏的** 』.

![2020-07-23-11-29-27](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-11-29-27.png)

我们还希望估计量的抽样分布具有『 **最小方差** 』即我们希望抽样分布的离散程度尽可能小，使估计值趋于落在 $θ$ 附近.

- 所有无偏估计中方差最小的无偏估计称作『 **最小方差无偏估计**, MVUE 』

有时对同一个估计量，不能同时达到无偏性和最小方差. 在这种情况下，选用使『 **均方误差** 』最小的估计量.

- 均方误差, 是指 $\hat{θ}$ 与 $θ$ 间偏差平方的平均, 为 $E[(\hat{θ} - θ)^2]$

$$E[(\hat{θ} - θ)^2] = V(\hat{θ}) + b^2(\hat{θ})$$

![2020-07-23-13-19-01](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-19-01.png)

::: details-open 🌰 例子：

![2020-07-23-13-25-26](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-25-26.png)
![2020-07-23-13-25-35](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-25-35.png)

:::

### 求点估计：经典估计方法

求参数的点估计有许多不同的方法.

#### 矩法

![2020-07-23-13-31-07](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-31-07.png)
![2020-07-23-13-32-02](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-32-02.png)

![2020-07-23-13-32-48](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-32-48.png)

::: details-open 🌰 例子：

![2020-07-23-13-34-40](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-23-13-34-40.png)

:::

::: details-open 🌰 例子：

![2020-07-24-16-07-53](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-07-53.png)
![2020-07-24-16-08-02](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-08-02.png)

:::

#### 极大似然法

::: details-open 🌰 例子：

![2020-07-24-16-15-07](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-15-07.png)

:::

### 求区间估计: 枢轴法

通过样本观测值我们可以计算出来一个随机区间 ( 随机是因为用于计算区间端点的样本观测值是随机变量 ) 被估计的参数有很大的可能性落入这个区间中. 这个区间称为『 **置信区间** 』

包含被估参数的概率称为『 **置信系数** 』

- 一个置信区间的置信系数为 0.95, 则称其为是 95% 的置信区间. 意思是有 95% 的可能性被估计参数落入这个区间中.

一种求参数 $θ$ 的置信区间的方法是求出一个『 **枢轴统计量** 』这个统计量是样本值和单个参数 $θ$ 的函数.

- 因为当样本容量 $n$ 很大时，很多统计量近似正态分布（ 中心极限定理 ），所以可以利用标准正态随机变量 $Z$ 作为枢轴统计量来构造期望值的置信区间.

![2020-07-24-16-41-16](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-41-16.png)

因此, 由『 **置信下限**, Lower Control Limit, LCL 』$\hat{θ} - z_{α/2}\sigma_{\hat{θ}}$ 到『 **置信上限**, Upper Control Limit, UCL 』$\hat{θ} + z_{α/2}\sigma_{\hat{θ}}$ 形成的区间包含参数 $θ$ 的概率 ( 置信系数 ) 为 $1 - α$

![2020-07-24-16-21-49](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-21-49.png)

![2020-07-24-16-29-01](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-29-01.png)
![2020-07-24-16-29-22](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-29-22.png)

::: details-open 🌰 例子：

![2020-07-24-16-26-43](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-26-43.png)
![2020-07-24-16-28-12](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-28-12.png)
![2020-07-24-16-28-29](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-28-29.png)

:::

### 总体均值的估计

![2020-07-24-16-47-09](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-47-09.png)

::: details-open 🌰 例子：

![2020-07-24-16-47-30](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-47-30.png)
![2020-07-24-16-47-57](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-47-57.png)

:::

---

![2020-07-24-16-48-47](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-48-47.png)

如果可以假定选取样本的总体有近似正态分布, 则可以执行基于小样本的估计方法.

![2020-07-24-16-50-06](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-50-06.png)

::: details-open 🌰 例子：

![2020-07-24-16-50-34](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-50-34.png)
![2020-07-24-16-50-42](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-50-42.png)

:::

![2020-07-24-16-53-06](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-24-16-53-06.png)

### 两个总体均值差的估计

下面讲解如何利用两个独立收集来的样本信息估计两个总体的『 **均值差** 』$(μ_1 - μ_2)$

🌰 均值差可以用来比较:

- 机械工程和土木工程专业毕业生的平均其实工资;
- 两个品牌的电子元件平均故障时间;

#### 独立样本

![2020-07-26-18-06-38](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-06-38.png)

::: details-open 🌰 例子：

![2020-07-26-18-09-19](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-09-19.png)
![2020-07-26-18-09-58](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-09-58.png)

:::

![2020-07-26-18-11-16](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-11-16.png)

![2020-07-26-18-11-37](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-11-37.png)

#### 配对样本

还可以配对地选取样本.

![2020-07-26-18-22-12](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-22-12.png)
![2020-07-26-18-21-57](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-21-57.png)

![2020-07-26-18-22-54](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-22-54.png)

::: details-open 🌰 例子：

![2020-07-26-18-23-08](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-23-08.png)
![2020-07-26-18-23-33](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-23-33.png)

:::

### 选择样本容量

一般来讲, 样本容量越大, 你所获得的信息就越多, 置信区间的宽度就越小. 减小置信区间宽度的最简单方法就是增加样本容量 $n$.

![2020-07-26-18-29-51](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-29-51.png)

::: details-open 🌰 例子：

![2020-07-26-18-29-19](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-18-29-19.png)

:::

## 假设检验

### 假设检验 & 置信区间

通过假设检验, 我们可以与一个假设的参数值进行判断. 而置信区间是可以用于对参数的决策的.

🌰 例如:

- 美国环保署的调查人员想判断化工厂排放某种污染物的平均水平 $μ$ 是否符合环保署的标准. 假设允许的浓度上限是 $3\%$, 那么调查人员通过抽样数据便可以判断化工厂是否合规, 也就是判断是否 $μ > 3$. 如果 $μ$ 的 $99\%$ 置信区间只包含大于 $3$ 的数据, 那么美国环保署就可以认为化工厂的排放超标了;

### 假设检验的要素 & 性质

上例中 👆, 美国环保署想支持的理论, 称为『 **备择假设** 』或者『 **研究假设** 』, 即 $μ > 3$, 记作 $H_a$

否认备择假设的理论, 称为『 **原假设** 』, 即 $μ = 3$, 记为 $H_0$. 美国环保署希望通过样本数据的分析, 指出『 原假设 』是不真实的, 以来支持『 备择假设 』的真实性.

是否拒绝原假设的决策依赖与一个由样本数据算得的统计量, 称为『 **检验统计量** 』

- 🌰 例如, 美国环保署认定, 若样本均值 $\bar{y}$ 比 $3$ 大得多, 那么环保署就倾向于拒绝原假设, 接受备择假设. 如果 $\bar{y}$ 小于 $3$, 比如为 $2.8$ 那么就没有充分的证据去拒绝原假设了.

需要为在检验统计量的值域中设定一个值, 如果检验统计量超过它, 就意味着拒绝原假设, 接受备择假设. 大于这个值的部分称为『 **拒绝域** 』

![2020-07-26-21-26-50](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-21-26-50.png)

---

假设检验只能得到两种结果之一: 拒绝原假设 & 接受原假设.

美国环保署如果只是简单的根据假设检验的结果, 去决定是否控告化工厂排放超标. 那么很可能会犯两种类型的错误.

![2020-07-26-21-37-22](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-21-37-22.png)

![2020-07-26-21-37-00](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-21-37-00.png)

计算出假设检验导出的推断是否正确的概率是非常重要的.

::: details-open 🌰 例子：

![2020-07-26-21-42-22](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-21-42-22.png)
![2020-07-26-21-43-58](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-21-43-58.png)

:::

### 求检验统计量: 经典方法

对总体的一个或多个参数进行统计检验:

1. 找到一个合适的检验统计量;
2. 确定拒绝域;

通常采用由费希尔（R. A. Fisher）提出的方法来寻找合理的检验统计量进行假设检验, 称为『 **经典方法** 』

假设, 我们想检验关于概率函数 $p(y)$ 或密度函数 $f(y)$ 的唯一参数的假设, 令 $L$ 表示样本的似然函数. 那么为了检验原假设设 $H_0 : θ = θ_0$, 费希尔的『 **似然比检验统计量** 』是:

![2020-07-26-22-18-26](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-18-26.png)

其中 $\hat{θ}$ 表示 $θ$ 的极大似然估计. 费希尔分析指出，若 $θ$ 与 $θ_0$ 不同，则当 $θ = \hat{θ}$ 时似然 $L$ 大于 $θ = θ_0$ 的 $L$. 因此检验的拒绝域由较小的 $λ$ 值构成，如小于某一 $λ_R$ 的值.

似然比检验统计量 $λ$ 可简化为标准正态随机变量 $Z$:

![2020-07-26-22-22-45](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-22-45.png)

![2020-07-26-22-23-56](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-23-56.png)

![2020-07-26-22-24-16](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-24-16.png)

::: details-open 🌰 例子：

![2020-07-26-22-24-37](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-24-37.png)

:::

::: details-open 🌰 例子：

![2020-07-26-22-25-44](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-25-44.png)
![2020-07-26-22-25-54](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-25-54.png)

:::

![2020-07-26-22-26-05](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-26-05.png)

### 检验总体均值

![2020-07-26-22-29-05](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-29-05.png)

::: details-open 🌰 例子：

![2020-07-26-22-29-18](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-29-18.png)
![2020-07-26-22-29-29](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-29-29.png)
![2020-07-26-22-29-50](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-29-50.png)

:::

![2020-07-26-22-30-23](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-30-23.png)

::: details-open 🌰 例子：

![2020-07-26-22-30-36](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-30-36.png)
![2020-07-26-22-30-45](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-30-45.png)

:::

### 检验两个总体均值差

#### 独立样本

![2020-07-26-22-38-50](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-38-50.png)

::: details-open 🌰 例子：

![2020-07-26-22-39-04](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-39-04.png)
![2020-07-26-22-39-11](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-39-11.png)

:::

![2020-07-26-22-39-21](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-39-21.png)

::: details-open 🌰 例子：

![2020-07-26-22-39-38](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-39-38.png)
![2020-07-26-22-40-07](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-40-07.png)
![2020-07-26-22-40-22](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-40-22.png)

:::

![2020-07-26-22-40-42](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-40-42.png)
![2020-07-26-22-40-49](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-40-49.png)

#### 配对样本

![2020-07-26-22-41-02](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-41-02.png)
![2020-07-26-22-41-13](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-41-13.png)

::: details-open 🌰 例子：

![2020-07-26-22-41-27](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-41-27.png)
![2020-07-26-22-41-44](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-41-44.png)
![2020-07-26-22-41-51](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-41-51.png)

:::

### 检验的观测显著性水平

根据前几节讲述的统计检验方法，在检验之前要事先确定 $α$ 值和相应的拒绝域，并且结论应说成拒绝或不拒绝原假设. 给出统计检验结论的第二种方法是报告检验统计量与原假设的 "不一致程度"，然后由检验人员自己决定是否拒绝原假设.

这种不一致性的度量称为检验的『 **观测显著性水平** 』

![2020-07-26-22-34-47](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-34-47.png)

![2020-07-26-22-35-57](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-35-57.png)

::: details-open 🌰 例子：

![2020-07-26-22-36-11](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-36-11.png)
![2020-07-26-22-36-54](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-36-54.png)

:::

![2020-07-26-22-37-32](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-37-32.png)
![2020-07-26-22-37-40](https://garrik-default-imgs.oss-accelerate.aliyuncs.com/imgs/2020-07-26-22-37-40.png)

## 分类数据分析
